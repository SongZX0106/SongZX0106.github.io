<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Vue3 + vite + Ts + pinia + 实战 + 源码 +electron | SZX的开发笔记</title><meta name="keywords" content="Vue"><meta name="author" content="SZX"><meta name="copyright" content="SZX"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Vue3 + vite + Ts + pinia + 实战 + 源码 +electron  仓库地址：https:&#x2F;&#x2F;gitee.com&#x2F;szxio&#x2F;vue3-vite-ts-pinia 视频地址：小满Vue3（课程导读）_哔哩哔哩_bilibili 课件地址：Vue3_小满zs的博客-CSDN博客  初始化Vue3项目方式一1npm init vite@latest   生成的目录结构 1234">
<meta property="og:type" content="article">
<meta property="og:title" content="Vue3 + vite + Ts + pinia + 实战 + 源码 +electron">
<meta property="og:url" content="https://songzx0106.github.io/Vue/2023100801/index.html">
<meta property="og:site_name" content="SZX的开发笔记">
<meta property="og:description" content="Vue3 + vite + Ts + pinia + 实战 + 源码 +electron  仓库地址：https:&#x2F;&#x2F;gitee.com&#x2F;szxio&#x2F;vue3-vite-ts-pinia 视频地址：小满Vue3（课程导读）_哔哩哔哩_bilibili 课件地址：Vue3_小满zs的博客-CSDN博客  初始化Vue3项目方式一1npm init vite@latest   生成的目录结构 1234">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://songzx0106.github.io/images/ys07.jpg">
<meta property="article:published_time" content="2023-10-28T08:27:15.000Z">
<meta property="article:modified_time" content="2023-10-30T01:16:03.693Z">
<meta property="article:author" content="SZX">
<meta property="article:tag" content="Vue">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://songzx0106.github.io/images/ys07.jpg"><link rel="shortcut icon" href="/images/favicon.png"><link rel="canonical" href="https://songzx0106.github.io/Vue/2023100801/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/6.0.0/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":5000,"languages":{"author":"作者: SZX","link":"链接: ","source":"来源: SZX的开发笔记","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/js/jquery.min.js',
    justifiedGallery: {
      js: 'https://fastly.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://fastly.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://fastly.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/js/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-10-30 09:16:03'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><link rel="stylesheet" href="//at.alicdn.com/t/font_2467717_jlvw8717b8.css"><meta name="generator" content="Hexo 5.4.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" data-lazy-src="/images/favicon.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">150</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">25</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">36</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/images/ys07.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">SZX的开发笔记</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Vue3 + vite + Ts + pinia + 实战 + 源码 +electron</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-10-28T08:27:15.000Z" title="发表于 2023-10-28 16:27:15">2023-10-28</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-10-30T01:16:03.693Z" title="更新于 2023-10-30 09:16:03">2023-10-30</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/vite/">vite</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">23.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>124分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Vue3 + vite + Ts + pinia + 实战 + 源码 +electron"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>Vue3 + vite + Ts + pinia + 实战 + 源码 +electron</p>
<blockquote>
<p>仓库地址：<a target="_blank" rel="noopener" href="https://gitee.com/szxio/vue3-vite-ts-pinia">https://gitee.com/szxio/vue3-vite-ts-pinia</a></p>
<p>视频地址：<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1dS4y1y7vd?p=1">小满Vue3（课程导读）_哔哩哔哩_bilibili</a></p>
<p>课件地址：<a target="_blank" rel="noopener" href="https://xiaoman.blog.csdn.net/category_11618172_2.html">Vue3_小满zs的博客-CSDN博客</a></p>
</blockquote>
<h2 id="初始化Vue3项目"><a href="#初始化Vue3项目" class="headerlink" title="初始化Vue3项目"></a>初始化Vue3项目</h2><h3 id="方式一"><a href="#方式一" class="headerlink" title="方式一"></a>方式一</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init vite@latest</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230903162122600.png" alt="image-20230903162122600"></p>
<p>生成的目录结构</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">vite-demo</span><br><span class="line">├── .vscode</span><br><span class="line">│   └── extensions.json</span><br><span class="line">├── public</span><br><span class="line">│   └── vite.svg</span><br><span class="line">├── src</span><br><span class="line">│   ├── assets</span><br><span class="line">│   │   └── vue.svg</span><br><span class="line">│   ├── components</span><br><span class="line">│   │   └── HelloWorld.vue</span><br><span class="line">│   ├── App.vue</span><br><span class="line">│   ├── main.ts</span><br><span class="line">│   ├── style.css</span><br><span class="line">│   └── vite-env.d.ts</span><br><span class="line">├── README.md</span><br><span class="line">├── index.html</span><br><span class="line">├── package.json</span><br><span class="line">├── tsconfig.json</span><br><span class="line">├── tsconfig.node.json</span><br><span class="line">└── vite.config.ts</span><br></pre></td></tr></table></figure>

<p>启动</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run dev</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230903162616723.png" alt="image-20230903162616723"></p>
<h3 id="方式二"><a href="#方式二" class="headerlink" title="方式二"></a>方式二</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init vue@latest</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230903162819151.png" alt="image-20230903162819151"></p>
<p>生成的目录结构</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">vue-demo</span><br><span class="line">├── .vscode</span><br><span class="line">│   └── extensions.json</span><br><span class="line">├── public</span><br><span class="line">│   └── favicon.ico</span><br><span class="line">├── src</span><br><span class="line">│   ├── assets</span><br><span class="line">│   │   ├── base.css</span><br><span class="line">│   │   ├── logo.svg</span><br><span class="line">│   │   └── main.css</span><br><span class="line">│   ├── components</span><br><span class="line">│   │   ├── <span class="built_in">_</span><span class="built_in">_</span>tests<span class="built_in">_</span><span class="built_in">_</span></span><br><span class="line">│   │   ├── icons</span><br><span class="line">│   │   ├── HelloWorld.vue</span><br><span class="line">│   │   ├── TheWelcome.vue</span><br><span class="line">│   │   └── WelcomeItem.vue</span><br><span class="line">│   ├── router</span><br><span class="line">│   │   └── index.ts</span><br><span class="line">│   ├── stores</span><br><span class="line">│   │   └── counter.ts</span><br><span class="line">│   ├── views</span><br><span class="line">│   │   ├── AboutView.vue</span><br><span class="line">│   │   └── HomeView.vue</span><br><span class="line">│   ├── App.vue</span><br><span class="line">│   └── main.ts</span><br><span class="line">├── .eslintrc.cjs</span><br><span class="line">├── .prettierrc.json</span><br><span class="line">├── README.md</span><br><span class="line">├── env.d.ts</span><br><span class="line">├── index.html</span><br><span class="line">├── package.json</span><br><span class="line">├── tsconfig.app.json</span><br><span class="line">├── tsconfig.json</span><br><span class="line">├── tsconfig.node.json</span><br><span class="line">├── tsconfig.vitest.json</span><br><span class="line">├── vite.config.ts</span><br><span class="line">└── vitest.config.ts</span><br></pre></td></tr></table></figure>

<p>用这种方式生成的项目会全一点</p>
<p>启动</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run dev</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230903163023078.png" alt="image-20230903163023078"></p>
<h2 id="自动生成路由"><a href="#自动生成路由" class="headerlink" title="自动生成路由"></a>自动生成路由</h2><p>添加 <code>gen-router.js</code> 文件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> readline = <span class="built_in">require</span>(<span class="string">&#x27;readline&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> os = <span class="built_in">require</span>(<span class="string">&#x27;os&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> vueDir = <span class="string">&#x27;./src/views/&#x27;</span>;</span><br><span class="line"></span><br><span class="line">fs.readdir(vueDir, <span class="function"><span class="keyword">function</span> (<span class="params">err, files</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(err);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> routers = <span class="string">``</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 对文件进行排序</span></span><br><span class="line">    <span class="keyword">let</span> sortFiles = files.sort(<span class="function">(<span class="params">a,b</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a.split(<span class="string">&quot;_&quot;</span>)[<span class="number">0</span>] - b.split(<span class="string">&quot;_&quot;</span>)[<span class="number">0</span>]</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> filename <span class="keyword">of</span> sortFiles) &#123;</span><br><span class="line">        <span class="keyword">if</span> (filename.indexOf(<span class="string">&#x27;.&#x27;</span>) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> [name, ext] = filename.split(<span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (ext != <span class="string">&#x27;vue&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> routerName = <span class="literal">null</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> contentFull = fs.readFileSync( <span class="string">`<span class="subst">$&#123;vueDir&#125;</span><span class="subst">$&#123;filename&#125;</span>`</span>, <span class="string">&#x27;utf-8&#x27;</span> );</span><br><span class="line">        <span class="keyword">var</span> match = <span class="regexp">/\&lt;\!\-\-\s*(.*)\s*\-\-\&gt;/g</span>.exec(contentFull.split(os.EOL)[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">if</span> (match) &#123;</span><br><span class="line">            routerName = match[<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        routers += <span class="string">`  &#123;path: &#x27;/<span class="subst">$&#123;name === <span class="string">&#x27;root&#x27;</span> ? <span class="string">&#x27;&#x27;</span> : <span class="built_in">encodeURIComponent</span>(name)&#125;</span>&#x27;,name:&#x27;<span class="subst">$&#123;name&#125;</span>&#x27;, component: ()=&gt; import(/* webpackChunkName: &quot;<span class="subst">$&#123;name&#125;</span>&quot; */ &quot;@/views/<span class="subst">$&#123;filename&#125;</span>&quot;) <span class="subst">$&#123; routerName ? <span class="string">&#x27;,name: &quot;&#x27;</span> + routerName + <span class="string">&#x27;&quot;&#x27;</span> : <span class="string">&#x27;&#x27;</span>&#125;</span> &#125;,\n`</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> result = <span class="string">`</span></span><br><span class="line"><span class="string">import &#123; createRouter, createWebHistory &#125; from &#x27;vue-router&#x27;</span></span><br><span class="line"><span class="string">import Layout from &#x27;@/layout/index.vue&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">const router = createRouter(&#123;</span></span><br><span class="line"><span class="string">  history: createWebHistory(import.meta.env.BASE_URL),</span></span><br><span class="line"><span class="string">  routes: [</span></span><br><span class="line"><span class="string">    &#123;</span></span><br><span class="line"><span class="string">      path: &#x27;/&#x27;,</span></span><br><span class="line"><span class="string">      name: &#x27;index&#x27;,</span></span><br><span class="line"><span class="string">      component: Layout,</span></span><br><span class="line"><span class="string">      redirect: &#x27;/index&#x27;,</span></span><br><span class="line"><span class="string">      children:[</span></span><br><span class="line"><span class="string">        <span class="subst">$&#123;routers&#125;</span></span></span><br><span class="line"><span class="string">      ]</span></span><br><span class="line"><span class="string">    &#125;,</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">  ]</span></span><br><span class="line"><span class="string">&#125;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">export default router</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// console.log(result);</span></span><br><span class="line">    fs.writeFile(<span class="string">&#x27;./src/router/index.ts&#x27;</span>,result, <span class="string">&#x27;utf-8&#x27;</span>,</span><br><span class="line">        (err) =&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line">        &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>修改 <code>package.json</code> 中的启动命令</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">  &quot;dev&quot;: &quot;node gen-router.js &amp;&amp;  vite&quot;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>这样每次新建完一个文件后需要重启一下服务，然后会自动生成路由文件，配置菜单动态显示即可</p>
<h2 id="Ref全家桶"><a href="#Ref全家桶" class="headerlink" title="Ref全家桶"></a>Ref全家桶</h2><h3 id="ref"><a href="#ref" class="headerlink" title="ref"></a>ref</h3><p>接受一个内部值并返回一个可变响应式的 ref 对象。ref 对象仅有一个 <code>.value</code> property，指向该内部值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &#123;&#123; product &#125;&#125;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">  &lt;hr&gt;</span><br><span class="line"></span><br><span class="line">  &lt;button @click&#x3D;&quot;change&quot;&gt;点击&lt;&#x2F;button&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line"></span><br><span class="line">import &#123;ref&#125; from &quot;vue&quot;;</span><br><span class="line"></span><br><span class="line">const product &#x3D; ref(&#123;</span><br><span class="line">  id:&quot;001&quot;,</span><br><span class="line">  name:&quot;小米手机&quot;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">const change &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">  product.value.name &#x3D; &quot;华为手机&quot;</span><br><span class="line">  console.log(product)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>调试小技巧</p>
<p>我们打印 ref 对象时需要点开两层才能看到信息，如下</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230903201400943.png" alt="image-20230903201400943"></p>
<p>可以打开 启用自定义格式化程序</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230903201422321.png" alt="image-20230903201422321"></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230903201441480.png" alt="image-20230903201441480"></p>
<p>之后打印就会直接展示具体的信息</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230903201520363.png" alt="image-20230903201520363"></p>
<h3 id="isRef"><a href="#isRef" class="headerlink" title="isRef"></a>isRef</h3><p>判断一个对象是否是响应式对象</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref, isRef &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> product = ref(&#123;</span><br><span class="line">  id: <span class="string">&quot;001&quot;</span>,</span><br><span class="line">  name: <span class="string">&quot;小米手机&quot;</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> change = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  product.value.name = <span class="string">&quot;华为手机&quot;</span></span><br><span class="line">  <span class="comment">// isRef判断一个对象是否是响应式对象</span></span><br><span class="line">  <span class="built_in">console</span>.log(isRef(product)) <span class="comment">// true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="shallowRef"><a href="#shallowRef" class="headerlink" title="shallowRef"></a>shallowRef</h3><p>创建一个跟踪自身 <code>.value</code> 变化的 ref，但不会使其值也变成响应式的</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref, isRef, shallowRef &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> shaRef = shallowRef(&#123;</span><br><span class="line">  price: <span class="number">100</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> change = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// product.value.name = &quot;华为手机&quot;</span></span><br><span class="line">  <span class="comment">// isRef判断一个对象是否是响应式对象</span></span><br><span class="line">  <span class="built_in">console</span>.log(isRef(product)) <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">  shaRef.value.price = <span class="number">200</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(shaRef.value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面的例子中页面不会发生变化</p>
<h3 id="triggerRef"><a href="#triggerRef" class="headerlink" title="triggerRef"></a>triggerRef</h3><p>强制更新页面</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref, isRef, shallowRef, triggerRef &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> product = ref(&#123;</span><br><span class="line">  id: <span class="string">&quot;001&quot;</span>,</span><br><span class="line">  name: <span class="string">&quot;小米手机&quot;</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> shaRef = shallowRef(&#123;</span><br><span class="line">  price: <span class="number">100</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> change = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// product.value.name = &quot;华为手机&quot;</span></span><br><span class="line">  <span class="comment">// isRef判断一个对象是否是响应式对象</span></span><br><span class="line">  <span class="built_in">console</span>.log(isRef(product)) <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">  shaRef.value.price = <span class="number">200</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(shaRef.value);</span><br><span class="line"></span><br><span class="line">  triggerRef(shaRef)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>需要传入一个要更新的对象</p>
<h3 id="customRef"><a href="#customRef" class="headerlink" title="customRef"></a>customRef</h3><p>自定义一个ref响应式数据</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; customRef &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myRef</span>&lt;<span class="title">T</span>&gt;(<span class="params">value: T</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> customRef(<span class="function">(<span class="params">track, trigger</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="function"><span class="title">get</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        track()</span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="function"><span class="title">set</span>(<span class="params">newVal</span>)</span> &#123;</span><br><span class="line">        value = newVal</span><br><span class="line">        trigger()</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> song1 = myRef(<span class="string">&quot;123&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> change = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  song1.value = <span class="string">&quot;456&quot;</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Reactive全家桶"><a href="#Reactive全家桶" class="headerlink" title="Reactive全家桶"></a>Reactive全家桶</h2><h3 id="Reactive"><a href="#Reactive" class="headerlink" title="Reactive"></a>Reactive</h3><p>用来绑定复杂的数据类型 例如 对象 数组</p>
<p>源码中限定只能传入类型是Object的数据</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230903211342898.png" alt="image-20230903211342898"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &#123;&#123; form &#125;&#125;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;button @click&#x3D;&quot;change&quot;&gt;改变&lt;&#x2F;button&gt;</span><br><span class="line"></span><br><span class="line">    &lt;hr&gt;</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">        &lt;li v-for&#x3D;&quot;item in list.value&quot;&gt;&#123;&#123; item &#125;&#125;&lt;&#x2F;li&gt;</span><br><span class="line">    &lt;&#x2F;ul&gt;</span><br><span class="line">    &lt;button @click&#x3D;&quot;getList&quot;&gt;获取&lt;&#x2F;button&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang&#x3D;&quot;ts&quot; name&#x3D;&quot;Reactive&quot;&gt;</span><br><span class="line">import &#123; reactive, &#125; from &#39;vue&#39;;</span><br><span class="line"></span><br><span class="line">let form &#x3D; reactive(&#123;</span><br><span class="line">    name: &quot;张三&quot;,</span><br><span class="line">    age: 18</span><br><span class="line">&#125;)</span><br><span class="line">function change() &#123;</span><br><span class="line">    form.age++</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let list &#x3D; reactive(&#123;</span><br><span class="line">    value: [&quot;lisi&quot;, &quot;wangwu&quot;]</span><br><span class="line">&#125;)</span><br><span class="line">function getList() &#123;</span><br><span class="line">    setTimeout(() &#x3D;&gt; &#123;</span><br><span class="line">        let res &#x3D; [&quot;Anly&quot;, &quot;Jack&quot;]</span><br><span class="line">        &#x2F;&#x2F; 直接给reactive赋值会破坏原有的响应式</span><br><span class="line">        list.value &#x3D; res</span><br><span class="line">        console.log(list);</span><br><span class="line">    &#125;, 1000);</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="Readonly"><a href="#Readonly" class="headerlink" title="Readonly"></a>Readonly</h3><p>将一个对象设置为只读</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; reactive, readonly &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> form = reactive(&#123;</span><br><span class="line">    name: <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">    age: <span class="number">18</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">let</span> readOnlyForm = readonly(form)</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">change</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    readOnlyForm.age++</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230903212107449.png" alt="image-20230903212107449"></p>
<h3 id="shallowReactive"><a href="#shallowReactive" class="headerlink" title="shallowReactive"></a>shallowReactive</h3><p>浅层的响应式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; shallowReactive &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> shaReactive = shallowReactive(&#123;</span><br><span class="line">    a: &#123;</span><br><span class="line">        b: <span class="number">123</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">chageSha</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    shaReactive.a.b = <span class="number">456</span> <span class="comment">// 页面不会发生改变</span></span><br><span class="line">    <span class="built_in">console</span>.log(shaReactive); <span class="comment">// 打印的数据发生改变</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="to系列全家桶"><a href="#to系列全家桶" class="headerlink" title="to系列全家桶"></a>to系列全家桶</h2><h3 id="toRef"><a href="#toRef" class="headerlink" title="toRef"></a>toRef</h3><p>将对象中的某个属性变成响应式的</p>
<p>如果原始数据是非响应式的，则经过 toRef 之后也不会更新视图，但是数据会发生变化</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;&#123;&#123; student &#125;&#125;&lt;&#x2F;div&gt;</span><br><span class="line">    &lt;div&gt;likeRef:&#123;&#123; likeRef &#125;&#125;&lt;&#x2F;div&gt;</span><br><span class="line">    &lt;button @click&#x3D;&quot;change&quot;&gt;修改&lt;&#x2F;button&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line">&lt;script setup lang&#x3D;&#39;ts&#39;&gt;</span><br><span class="line">import &#123; toRef &#125; from &quot;vue&quot;</span><br><span class="line"></span><br><span class="line">const student &#x3D; &#123;</span><br><span class="line">    name: &quot;Jack&quot;,</span><br><span class="line">    age: 18,</span><br><span class="line">    like: &quot;画画&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let likeRef &#x3D; toRef(student, &quot;like&quot;)</span><br><span class="line"></span><br><span class="line">function change() &#123;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; 如果源数据是非响应式的，则经过toRef后也不会触发页面更新</span><br><span class="line">    likeRef.value &#x3D; &quot;足球&quot;</span><br><span class="line">    console.log(student);</span><br><span class="line">    console.log(likeRef);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>如果源数据就是响应式的，则会触发页面更新</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;&#123;&#123; student &#125;&#125;&lt;&#x2F;div&gt;</span><br><span class="line">    &lt;div&gt;likeRef:&#123;&#123; likeRef &#125;&#125;&lt;&#x2F;div&gt;</span><br><span class="line">    &lt;button @click&#x3D;&quot;change&quot;&gt;修改&lt;&#x2F;button&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line">&lt;script setup lang&#x3D;&#39;ts&#39;&gt;</span><br><span class="line">import &#123; toRef, reactive &#125; from &quot;vue&quot;</span><br><span class="line"></span><br><span class="line">const student &#x3D; reactive(&#123;</span><br><span class="line">    name: &quot;Jack&quot;,</span><br><span class="line">    age: 18,</span><br><span class="line">    like: &quot;画画&quot;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">let likeRef &#x3D; toRef(student, &quot;like&quot;)</span><br><span class="line"></span><br><span class="line">function change() &#123;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; 如果源数据是非响应式的，则经过toRef后也不会触发页面更新</span><br><span class="line">    likeRef.value &#x3D; &quot;足球&quot;</span><br><span class="line">    console.log(student);</span><br><span class="line">    console.log(likeRef);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="toRefs"><a href="#toRefs" class="headerlink" title="toRefs"></a>toRefs</h3><p>将对象的所有数据都变成响应式数据</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; toRef, toRefs, toRaw, ref, reactive &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> student = reactive(&#123;</span><br><span class="line">    name: <span class="string">&quot;Jack&quot;</span>,</span><br><span class="line">    age: <span class="number">18</span>,</span><br><span class="line">    like: <span class="string">&quot;画画&quot;</span>,</span><br><span class="line">    code: [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 自实现toRefs</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myToRefs</span>&lt;<span class="title">T</span> <span class="title">extends</span> <span class="title">Object</span>&gt;(<span class="params">object: T</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> map: any = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> object) &#123;</span><br><span class="line">        map[key] = toRef(object, key)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> map</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">refs</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(myToRefs(student)); <span class="comment">// 打印结果如下图</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用场景：对象解构</span></span><br><span class="line"><span class="keyword">let</span> &#123; name, age, code &#125; = toRefs(student)</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    name.value = <span class="string">&quot;Tim&quot;</span></span><br><span class="line">    age.value = <span class="number">16</span></span><br><span class="line">    code.value.push(<span class="number">3</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>myToRefs 打印结果</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230903223545771.png" alt="image-20230903223545771"></p>
<h3 id="toRaw"><a href="#toRaw" class="headerlink" title="toRaw"></a>toRaw</h3><p>返回对象的原始信息</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(toRaw(student));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>打印</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230903223501841.png" alt="image-20230903223501841"></p>
<h2 id="Vue3响应式源码实现"><a href="#Vue3响应式源码实现" class="headerlink" title="Vue3响应式源码实现"></a>Vue3响应式源码实现</h2><h3 id="初始化项目结构"><a href="#初始化项目结构" class="headerlink" title="初始化项目结构"></a>初始化项目结构</h3><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vue-proxy</span><br><span class="line">├── effect.js</span><br><span class="line">├── effect.ts</span><br><span class="line">├── index.html</span><br><span class="line">├── index.js</span><br><span class="line">├── package.json</span><br><span class="line">├── reactive.js</span><br><span class="line">├── reactive.ts</span><br><span class="line">└── webpack.config.js</span><br></pre></td></tr></table></figure>

<h3 id="reactive-ts"><a href="#reactive-ts" class="headerlink" title="reactive.ts"></a>reactive.ts</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; track, trigger &#125; <span class="keyword">from</span> <span class="string">&quot;./effect&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断是否是对象</span></span><br><span class="line"><span class="keyword">const</span> isObject = <span class="function">(<span class="params">target</span>) =&gt;</span> target !== <span class="literal">null</span> &amp;&amp; <span class="keyword">typeof</span> target === <span class="string">&quot;object&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 泛型约束只能传入Object类型</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> reactive = <span class="xml"><span class="tag">&lt;<span class="name">T</span> <span class="attr">extends</span> <span class="attr">object</span>&gt;</span>(target: T) =&gt; &#123;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">    return new Proxy(target, &#123;</span></span><br><span class="line"><span class="xml">        get(target, key, receiver) &#123;</span></span><br><span class="line"><span class="xml">            console.log(target);</span></span><br><span class="line"><span class="xml">            console.log(key);</span></span><br><span class="line"><span class="xml">            console.log(receiver);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">            let res = Reflect.get(target, key, receiver)</span></span><br><span class="line"></span><br><span class="line"><span class="xml">            track(target, key)</span></span><br><span class="line"></span><br><span class="line"><span class="xml">            if (isObject(res)) &#123;</span></span><br><span class="line"><span class="xml">                return reactive(res)</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">            return res</span></span><br><span class="line"><span class="xml">        &#125;,</span></span><br><span class="line"><span class="xml">        set(target, key, value, receiver) &#123;</span></span><br><span class="line"><span class="xml">            let res = Reflect.set(target, key, value, receiver)</span></span><br><span class="line"><span class="xml">            console.log(target, key, value);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">            trigger(target, key)</span></span><br><span class="line"><span class="xml">            return res</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">    &#125;)</span></span><br><span class="line"></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="effect-ts"><a href="#effect-ts" class="headerlink" title="effect.ts"></a>effect.ts</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 更新视图的方法</span></span><br><span class="line"><span class="keyword">let</span> activeEffect;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> effect = <span class="function">(<span class="params">fn: <span class="built_in">Function</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> _effect = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        activeEffect = _effect;</span><br><span class="line">        fn()</span><br><span class="line">    &#125;</span><br><span class="line">    _effect()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 收集依赖</span></span><br><span class="line"><span class="keyword">const</span> targetMap = <span class="keyword">new</span> <span class="built_in">WeakMap</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> track = <span class="function">(<span class="params">target, key</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> depsMap = targetMap.get(target)</span><br><span class="line">    <span class="keyword">if</span> (!depsMap) &#123;</span><br><span class="line">        depsMap = <span class="keyword">new</span> <span class="built_in">Map</span>()</span><br><span class="line">        targetMap.set(target, depsMap)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> deps = depsMap.get(key)</span><br><span class="line">    <span class="keyword">if</span> (!deps) &#123;</span><br><span class="line">        deps = <span class="keyword">new</span> <span class="built_in">Set</span>()</span><br><span class="line">        depsMap.set(key, deps)</span><br><span class="line">    &#125;</span><br><span class="line">    deps.add(activeEffect)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 触发更新</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> trigger = <span class="function">(<span class="params">target, key</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> depsMap = targetMap.get(target)</span><br><span class="line">    <span class="keyword">const</span> deps = depsMap.get(key)</span><br><span class="line">    deps.forEach(<span class="function"><span class="params">effect</span> =&gt;</span> effect())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><p>执行 <code>tsc</code> 转成 js 代码，没有 <code>tsc </code> 的全局安装 <code>typescript</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install typescript -g</span><br></pre></td></tr></table></figure>

<p>新建 <code>index.js</code>，分别引入 <code>effect.js</code> 和 <code>reactive.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; effect &#125; <span class="keyword">from</span> <span class="string">&quot;./effect.js&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; reactive &#125; <span class="keyword">from</span> <span class="string">&quot;./reactive.js&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> data = reactive(&#123;</span><br><span class="line">    name: <span class="string">&quot;lisit&quot;</span>,</span><br><span class="line">    age: <span class="number">18</span>,</span><br><span class="line">    foor: &#123;</span><br><span class="line">        bar: <span class="string">&quot;汽车&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">effect(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">document</span>.getElementById(<span class="string">&quot;app&quot;</span>).innerText = <span class="string">`数据绑定：<span class="subst">$&#123;data.name&#125;</span> -- <span class="subst">$&#123;data.age&#125;</span> -- <span class="subst">$&#123;data.foor.bar&#125;</span>`</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&quot;btn&quot;</span>).addEventListener(<span class="string">&quot;click&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    data.age++</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>新建<code>index.html</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;btn&quot;</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后再根目录执行</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init -y</span><br></pre></td></tr></table></figure>

<p>安装依赖</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install webpack webpack-cli webpack-dev-server html-webpack-plugin -D</span><br></pre></td></tr></table></figure>

<p>然后新建 <code>webpack.config.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> HtmlWebpakcPlugin = <span class="built_in">require</span>(<span class="string">&quot;html-webpack-plugin&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: <span class="string">&quot;./index.js&quot;</span>,</span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.resolve(__dirname, <span class="string">&quot;dist&quot;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpakcPlugin(&#123;</span><br><span class="line">            template: path.resolve(__dirname, <span class="string">&quot;./index.html&quot;</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">    mode: <span class="string">&quot;development&quot;</span>,</span><br><span class="line">    <span class="comment">// 开发服务器</span></span><br><span class="line">    devServer: &#123;</span><br><span class="line">        host: <span class="string">&quot;localhost&quot;</span>, <span class="comment">// 启动服务器域名</span></span><br><span class="line">        port: <span class="string">&quot;3000&quot;</span>, <span class="comment">// 启动服务器端口号</span></span><br><span class="line">        open: <span class="literal">true</span>, <span class="comment">// 是否自动打开浏览器</span></span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行命令启动项目</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx webpack serve</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230904232457817.png" alt="image-20230904232457817"></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230904232522425.png" alt="image-20230904232522425"></p>
<h2 id="computed的简单使用"><a href="#computed的简单使用" class="headerlink" title="computed的简单使用"></a>computed的简单使用</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;table border width&#x3D;&quot;600&quot; cellspacing&#x3D;&quot;0&quot; cellpadding&#x3D;&quot;0&quot;&gt;</span><br><span class="line">      &lt;thead&gt;</span><br><span class="line">        &lt;th&gt;名称&lt;&#x2F;th&gt;</span><br><span class="line">        &lt;th&gt;价格&lt;&#x2F;th&gt;</span><br><span class="line">        &lt;th&gt;数量&lt;&#x2F;th&gt;</span><br><span class="line">        &lt;th&gt;总价&lt;&#x2F;th&gt;</span><br><span class="line">        &lt;th&gt;操作&lt;&#x2F;th&gt;</span><br><span class="line">      &lt;&#x2F;thead&gt;</span><br><span class="line"></span><br><span class="line">      &lt;tbody&gt;</span><br><span class="line">        &lt;tr v-for&#x3D;&quot;(item,index) in choosList&quot; style&#x3D;&quot;text-align: center&quot;&gt;</span><br><span class="line">          &lt;td&gt;&#123;&#123; item.name &#125;&#125;&lt;&#x2F;td&gt;</span><br><span class="line">          &lt;td&gt;&#123;&#123; item.price &#125;&#125;&lt;&#x2F;td&gt;</span><br><span class="line">          &lt;td&gt;&#123;&#123; item.count &#125;&#125;&lt;&#x2F;td&gt;</span><br><span class="line">          &lt;td&gt;</span><br><span class="line">            &lt;el-button type&#x3D;&quot;primary&quot; @click&#x3D;&quot;item.count--&quot;&gt;-&lt;&#x2F;el-button&gt;</span><br><span class="line">            &#123;&#123; item.price * item.count &#125;&#125;</span><br><span class="line">            &lt;el-button type&#x3D;&quot;primary&quot; @click&#x3D;&quot;item.count++&quot;&gt;+&lt;&#x2F;el-button&gt;</span><br><span class="line">          &lt;&#x2F;td&gt;</span><br><span class="line">          &lt;td&gt;&lt;el-button type&#x3D;&quot;danger&quot; @click&#x3D;&quot;remove&quot;&gt;删除&lt;&#x2F;el-button&gt;&lt;&#x2F;td&gt;</span><br><span class="line">        &lt;&#x2F;tr&gt;</span><br><span class="line">      &lt;&#x2F;tbody&gt;</span><br><span class="line">      &lt;tfoot align&#x3D;&quot;right&quot;&gt;</span><br><span class="line">      &lt;tr&gt;</span><br><span class="line">        &lt;td colspan&#x3D;&quot;5&quot;&gt;总价：&#123;&#123;total&#125;&#125;&lt;&#x2F;td&gt;</span><br><span class="line">      &lt;&#x2F;tr&gt;</span><br><span class="line">      &lt;&#x2F;tfoot&gt;</span><br><span class="line">    &lt;&#x2F;table&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123;reactive,computed&#125; from &quot;vue&quot;;</span><br><span class="line"></span><br><span class="line">let choosList &#x3D; reactive([</span><br><span class="line">  &#123;</span><br><span class="line">    name:&quot;裤子&quot;,</span><br><span class="line">    price:100,</span><br><span class="line">    count:1,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    name:&quot;衣服&quot;,</span><br><span class="line">    price:200,</span><br><span class="line">    count:1,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    name:&quot;鞋子&quot;,</span><br><span class="line">    price:300,</span><br><span class="line">    count:1,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    name:&quot;帽子&quot;,</span><br><span class="line">    price:400,</span><br><span class="line">    count:1,</span><br><span class="line">  &#125;</span><br><span class="line">])</span><br><span class="line">let total &#x3D; computed(()&#x3D;&gt;&#123;</span><br><span class="line">  let total &#x3D; 0;</span><br><span class="line">  choosList.forEach(item&#x3D;&gt;&#123;</span><br><span class="line">    total +&#x3D; item.price * item.count;</span><br><span class="line">  &#125;)</span><br><span class="line">  return total;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">function remove(index)&#123;</span><br><span class="line">  choosList.splice(index,1);</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230910152223957.png" alt="image-20230910152223957"></p>
<h2 id="computed源码实现"><a href="#computed源码实现" class="headerlink" title="computed源码实现"></a>computed源码实现</h2><p><code>effect.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 更新视图方法</span></span><br><span class="line"><span class="keyword">let</span> activeEffect</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> effect = <span class="function">(<span class="params">fn:<span class="built_in">Function</span>,options</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;effect触发&quot;</span>)</span><br><span class="line">    <span class="keyword">const</span> _effect = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        activeEffect = _effect</span><br><span class="line">        <span class="keyword">return</span> fn()</span><br><span class="line">    &#125;</span><br><span class="line">    _effect.options = options</span><br><span class="line">    _effect()</span><br><span class="line">    <span class="keyword">return</span> _effect</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 依赖收集</span></span><br><span class="line"><span class="keyword">const</span> targetMap = <span class="keyword">new</span> <span class="built_in">WeakMap</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> track = <span class="function">(<span class="params">target, key</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> depsMap = targetMap.get(key)</span><br><span class="line">    <span class="keyword">if</span> (!depsMap) &#123;</span><br><span class="line">        depsMap = <span class="keyword">new</span> <span class="built_in">Map</span>()</span><br><span class="line">        targetMap.set(target, depsMap)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> deps = depsMap.get(key)</span><br><span class="line">    <span class="keyword">if</span> (!deps) &#123;</span><br><span class="line">        deps = <span class="keyword">new</span> <span class="built_in">Set</span>()</span><br><span class="line">        depsMap.set(key, deps)</span><br><span class="line">    &#125;</span><br><span class="line">    deps.add(activeEffect)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 触发更新</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> trigger = <span class="function">(<span class="params">target, key</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> depsMap = targetMap.get(target)</span><br><span class="line">    <span class="keyword">const</span> deps = depsMap.get(key)</span><br><span class="line">    deps.forEach(<span class="function"><span class="params">effect</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (effect.options.scheduler)&#123;</span><br><span class="line">            effect.options.scheduler()</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            effect()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>reactive.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;track, trigger&#125; <span class="keyword">from</span> <span class="string">&quot;./effect&quot;</span></span><br><span class="line"><span class="comment">// 判断是否是对象类型</span></span><br><span class="line"><span class="keyword">const</span> isObject = <span class="function">(<span class="params">target</span>) =&gt;</span> <span class="keyword">typeof</span> target === <span class="string">&#x27;object&#x27;</span> &amp;&amp; target !== <span class="literal">null</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> reactive = <span class="function">(<span class="params">target</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, &#123;</span><br><span class="line">        <span class="function"><span class="title">get</span>(<span class="params">target, key, receiver</span>)</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&quot;reactive.get-&quot;</span>,key)</span><br><span class="line">            <span class="keyword">const</span> res = <span class="built_in">Reflect</span>.get(target, key, receiver)</span><br><span class="line">            <span class="comment">// 收集依赖</span></span><br><span class="line">            track(target, key)</span><br><span class="line">            <span class="comment">// 递归</span></span><br><span class="line">            <span class="keyword">return</span> isObject(res) ? reactive(res) : res</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="function"><span class="title">set</span>(<span class="params">target, key, value, receiver</span>)</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&quot;reactive.set-&quot;</span>,key)</span><br><span class="line">            <span class="keyword">const</span> res = <span class="built_in">Reflect</span>.set(target, key, value, receiver)</span><br><span class="line">            <span class="comment">// 触发依赖</span></span><br><span class="line">            trigger(target, key)</span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>computed.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;effect&#125; <span class="keyword">from</span>  <span class="string">&quot;./effect&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> myComputed = <span class="function">(<span class="params">getter:<span class="built_in">Function</span></span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> _value = effect(getter,&#123;</span><br><span class="line">        scheduler:<span class="function">()=&gt;</span>&#123;</span><br><span class="line">            _dirty = <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 判断是否需要重新计算结果</span></span><br><span class="line">    <span class="keyword">let</span> _dirty = <span class="literal">true</span></span><br><span class="line">    <span class="comment">// 缓存结果</span></span><br><span class="line">    <span class="keyword">let</span> catchValue</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">ComputedRefImpl</span></span>&#123;</span><br><span class="line">        <span class="keyword">get</span> <span class="title">value</span>()&#123;</span><br><span class="line">            <span class="keyword">if</span>(_dirty)&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">&quot;依赖发生变化时执行&quot;</span>)</span><br><span class="line">                catchValue = _value()</span><br><span class="line">                _dirty = <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> catchValue</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ComputedRefImpl()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="watch监听器"><a href="#watch监听器" class="headerlink" title="watch监听器"></a>watch监听器</h2><h3 id="监听单属性值"><a href="#监听单属性值" class="headerlink" title="监听单属性值"></a>监听单属性值</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name = ref(<span class="string">&quot;李四&quot;</span>)</span><br><span class="line"></span><br><span class="line">watch(name,<span class="function">(<span class="params">newValue,oldValue</span>)=&gt;</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(newValue,oldValue)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="同时监听多个属性"><a href="#同时监听多个属性" class="headerlink" title="同时监听多个属性"></a>同时监听多个属性</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name = ref(<span class="string">&quot;李四&quot;</span>)</span><br><span class="line"><span class="keyword">let</span> age = ref(<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">watch([name,age],<span class="function">(<span class="params">newValue,oldValue</span>)=&gt;</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(newValue,oldValue)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230910154510725.png" alt="image-20230910154510725"></p>
<h3 id="深度监听"><a href="#深度监听" class="headerlink" title="深度监听"></a>深度监听</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = ref(&#123;</span><br><span class="line">  foo:&#123;</span><br><span class="line">    bar:&#123;</span><br><span class="line">      name:<span class="string">&quot;张三&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">watch(obj,<span class="function">(<span class="params">newValue,oldValue</span>)=&gt;</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(obj.value.foo.bar.name)</span><br><span class="line">&#125;,&#123;</span><br><span class="line">  deep:<span class="literal">true</span>, <span class="comment">//  深度监听</span></span><br><span class="line">  immediate:<span class="literal">true</span>, <span class="comment">// 立即执行</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="监听对象中的某一个属性"><a href="#监听对象中的某一个属性" class="headerlink" title="监听对象中的某一个属性"></a>监听对象中的某一个属性</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = ref(&#123;</span><br><span class="line">  foo:&#123;</span><br><span class="line">    bar:&#123;</span><br><span class="line">      name:<span class="string">&quot;张三&quot;</span>,</span><br><span class="line">      age:<span class="number">18</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听某个属性是要传入一个函数来返回要监听的属性值</span></span><br><span class="line">watch(<span class="function">()=&gt;</span>obj.value.foo.bar.age,<span class="function">(<span class="params">newValue,oldValue</span>)=&gt;</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(obj.value.foo.bar.age)</span><br><span class="line">&#125;,&#123;</span><br><span class="line">  immediate:<span class="literal">true</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="watchEffect"><a href="#watchEffect" class="headerlink" title="watchEffect"></a>watchEffect</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>watchEffect不需要传入任何参数，它是一个函数，当依赖变化时，这个函数就会执行，它内部会根据响应式数据的依赖关系，自动执行监听函数</p>
<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;el-input id&#x3D;&quot;msg1&quot; v-model&#x3D;&quot;msg1&quot; placeholder&#x3D;&quot;placeholder&quot;&gt;&lt;&#x2F;el-input&gt;</span><br><span class="line">  &lt;el-input v-model&#x3D;&quot;msg2&quot; placeholder&#x3D;&quot;placeholder&quot;&gt;&lt;&#x2F;el-input&gt;</span><br><span class="line">  &lt;el-button type&#x3D;&quot;primary&quot; @click&#x3D;&quot;stopWatch&quot;&gt;停止监听&lt;&#x2F;el-button&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123;ref, watchEffect,nextTick&#125; from &#39;vue&#39;</span><br><span class="line"></span><br><span class="line">let msg1 &#x3D; ref(&quot;msg1&quot;)</span><br><span class="line">let msg2 &#x3D; ref(&quot;msg2&quot;)</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; watchEffect不需要传入任何参数，它是一个函数，当依赖变化时，这个函数就会执行</span><br><span class="line">&#x2F;&#x2F; 它内部会根据响应式数据的依赖关系，自动执行监听函数</span><br><span class="line">const stop &#x3D; watchEffect(()&#x3D;&gt;&#123;</span><br><span class="line">  console.log(msg1.value)</span><br><span class="line">  console.log(msg2.value)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">function stopWatch()&#123;</span><br><span class="line">  &#x2F;&#x2F; 停止监听</span><br><span class="line">  stop()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="BEM架构和Layout布局"><a href="#BEM架构和Layout布局" class="headerlink" title="BEM架构和Layout布局"></a>BEM架构和Layout布局</h2><p>Layout目录结构</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">layout</span><br><span class="line">├── Content</span><br><span class="line">│   └── index.vue</span><br><span class="line">├── Header</span><br><span class="line">│   └── index.vue</span><br><span class="line">├── Menu</span><br><span class="line">│   └── index.vue</span><br><span class="line">├── css</span><br><span class="line">│   └── bem.scss</span><br><span class="line">└── index.vue</span><br></pre></td></tr></table></figure>

<p>新建 <code>bem.scss</code></p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$namespace</span>: <span class="string">&quot;zx&quot;</span> !default;</span><br><span class="line"><span class="variable">$block-sel</span>:<span class="string">&quot;-&quot;</span> !default;</span><br><span class="line"><span class="variable">$element-sel</span>:<span class="string">&quot;__&quot;</span> !default;</span><br><span class="line"><span class="variable">$modifier-sel</span>:<span class="string">&quot;--&quot;</span> !default;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@mixin</span> bfc&#123;</span><br><span class="line">  <span class="attribute">height</span>:<span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@mixin</span> b(<span class="variable">$block</span>)&#123;</span><br><span class="line">  <span class="comment">// 拼接的结果为:zx-xxx</span></span><br><span class="line">  <span class="variable">$B</span>:<span class="variable">$namespace</span> + <span class="variable">$block-sel</span> + <span class="variable">$block</span>;</span><br><span class="line">  .#&#123;<span class="variable">$B</span>&#125;&#123;</span><br><span class="line">    <span class="keyword">@content</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@mixin</span> e(<span class="variable">$element</span>)&#123;</span><br><span class="line">  <span class="comment">// 拼接的结果为:zx-xxx__xxx</span></span><br><span class="line">  <span class="variable">$selector</span>:&amp;;</span><br><span class="line">  <span class="keyword">@at-root</span> &#123;</span><br><span class="line">    <span class="variable">$E</span>:<span class="variable">$selector</span> + <span class="variable">$element-sel</span> + <span class="variable">$element</span>;</span><br><span class="line">    #&#123;<span class="variable">$E</span>&#125;&#123;</span><br><span class="line">      <span class="keyword">@content</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@mixin</span> m(<span class="variable">$modifier</span>)&#123;</span><br><span class="line">  <span class="comment">// 拼接的结果为:zx-xxx--xxx</span></span><br><span class="line">  <span class="variable">$selector</span>:&amp;;</span><br><span class="line">  <span class="keyword">@at-root</span> &#123;</span><br><span class="line">    <span class="variable">$M</span>:<span class="variable">$selector</span> + <span class="variable">$modifier-sel</span> + <span class="variable">$modifier</span>;</span><br><span class="line">    #&#123;<span class="variable">$M</span>&#125;&#123;</span><br><span class="line">      <span class="keyword">@content</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>配置全局生效</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; fileURLToPath, URL &#125; <span class="keyword">from</span> <span class="string">&#x27;node:url&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&#x27;vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> vue <span class="keyword">from</span> <span class="string">&#x27;@vitejs/plugin-vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> vueJsx <span class="keyword">from</span> <span class="string">&#x27;@vitejs/plugin-vue-jsx&#x27;</span></span><br><span class="line"><span class="keyword">import</span> AutoImport <span class="keyword">from</span> <span class="string">&#x27;unplugin-auto-import/vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Components <span class="keyword">from</span> <span class="string">&#x27;unplugin-vue-components/vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; ElementPlusResolver &#125; <span class="keyword">from</span> <span class="string">&#x27;unplugin-vue-components/resolvers&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// https://vitejs.dev/config/</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> defineConfig(&#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    vue(),</span><br><span class="line">    vueJsx(),</span><br><span class="line">    AutoImport(&#123;</span><br><span class="line">      resolvers: [ElementPlusResolver()],</span><br><span class="line">    &#125;),</span><br><span class="line">    Components(&#123;</span><br><span class="line">      resolvers: [ElementPlusResolver()],</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">  resolve: &#123;</span><br><span class="line">    alias: &#123;</span><br><span class="line">      <span class="string">&#x27;@&#x27;</span>: fileURLToPath(<span class="keyword">new</span> URL(<span class="string">&#x27;./src&#x27;</span>, <span class="keyword">import</span>.meta.url))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  css: &#123;</span><br><span class="line">    preprocessorOptions: &#123;</span><br><span class="line">      <span class="comment">// 配置全局CSS</span></span><br><span class="line">      scss: &#123;</span><br><span class="line">        additionalData: <span class="string">&quot;@import &#x27;./src/layout_v2/css/bem.scss&#x27;;&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><code>index.vue</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;zx-box&quot;&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;zx-box__menu&quot;&gt;</span><br><span class="line">      &lt;Menu&#x2F;&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;zx-box__main&quot;&gt;</span><br><span class="line">      &lt;Header&#x2F;&gt;</span><br><span class="line">      &lt;Content&#x2F;&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line"></span><br><span class="line">import Menu from &quot;@&#x2F;layout_v2&#x2F;Menu&#x2F;index.vue&quot;;</span><br><span class="line">import Header from &quot;@&#x2F;layout_v2&#x2F;Header&#x2F;index.vue&quot;;</span><br><span class="line">import Content from &quot;@&#x2F;layout_v2&#x2F;Content&#x2F;index.vue&quot;;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang&#x3D;&quot;scss&quot;&gt;</span><br><span class="line">@include b(&#39;box&#39;)&#123;</span><br><span class="line">  height: 100%;</span><br><span class="line">  display: flex;</span><br><span class="line"></span><br><span class="line">  @include e(&quot;menu&quot;)&#123;</span><br><span class="line">    width: 250px;</span><br><span class="line">    height: 100%;</span><br><span class="line">    border-right: 1px solid #ebebeb;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @include e(&quot;main&quot;)&#123;</span><br><span class="line">    flex: 1;</span><br><span class="line">    display: flex;</span><br><span class="line">    flex-direction: column;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<p><code>Menu/index</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    Menu</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p><code>Header/index.vue</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;div class&#x3D;&quot;zx-header&quot;&gt;</span><br><span class="line">  Header</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang&#x3D;&quot;scss&quot;&gt;</span><br><span class="line">@include b(&#39;header&#39;)&#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 60px;</span><br><span class="line">  line-height: 60px;</span><br><span class="line">  border-bottom: 1px solid #ccc;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<p><code>Content/index.vue</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;zx-content&quot;&gt;</span><br><span class="line">    &lt;div v-for&#x3D;&quot;item in 50&quot; class&#x3D;&quot;zx-content__item&quot;&gt;</span><br><span class="line">      &#123;&#123;item&#125;&#125;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang&#x3D;&quot;scss&quot;&gt;</span><br><span class="line">@include b(content)&#123;</span><br><span class="line">  height: 100%;</span><br><span class="line">  overflow: auto;</span><br><span class="line">  @include e(item)&#123;</span><br><span class="line">    height: 60px;</span><br><span class="line">    line-height: 60px;</span><br><span class="line">    text-align: center;</span><br><span class="line">    border-radius: 5px;</span><br><span class="line">    border: 1px solid pink;</span><br><span class="line">    margin: 10px;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<p>布局效果</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230913205111297.png" alt="image-20230913205111297"></p>
<h2 id="父子组件传值"><a href="#父子组件传值" class="headerlink" title="父子组件传值"></a>父子组件传值</h2><h3 id="简单使用"><a href="#简单使用" class="headerlink" title="简单使用"></a>简单使用</h3><p>定义父组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;parent-box&quot;&gt;</span><br><span class="line">    父组件</span><br><span class="line">    &lt;div&gt;子组件传过来的值：&#123;&#123;count&#125;&#125;&lt;&#x2F;div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;button @click&#x3D;&quot;getSubInfo&quot;&gt;获取子组件的所有属性和方法&lt;&#x2F;button&gt;</span><br><span class="line"></span><br><span class="line">    &lt;SubComponent ref&#x3D;&quot;subCom&quot; :value&#x3D;&quot;title&quot; @changeCount&#x3D;&quot;changeCount&quot;&#x2F;&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line">import SubComponent from &quot;@&#x2F;components&#x2F;SubComponent.vue&quot;;</span><br><span class="line">import &#123;ref&#125; from &quot;vue&quot;;</span><br><span class="line"></span><br><span class="line">let title &#x3D; &quot;给儿子传值&quot;;</span><br><span class="line">let count &#x3D; ref&lt;number&gt;()</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 定义组件类型</span><br><span class="line">let subCom &#x3D; ref&lt;InstanceType&lt;typeof SubComponent&gt;&gt;()</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 子组件触发的父组件方法</span><br><span class="line">const changeCount &#x3D; (newVal) &#x3D;&gt; &#123;</span><br><span class="line">  count.value &#x3D; newVal;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const getSubInfo &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">  &#x2F;&#x2F; 调用子组件的实例方法</span><br><span class="line">  subCom.value.open()</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; 获取子组件的属性</span><br><span class="line">  console.log(subCom.value.order)</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.parent-box&#123;</span><br><span class="line">  width: 300px;</span><br><span class="line">  height: 300px;</span><br><span class="line">  border: 1px solid #ccc;</span><br><span class="line">  padding: 30px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<p>子组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;children-box&quot;&gt;</span><br><span class="line">   父组件传递的值： &#123;&#123; value &#125;&#125;</span><br><span class="line">    &lt;button @click&#x3D;&quot;changeParentCount&quot;&gt;改变父组件的值&lt;&#x2F;button&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line">import &#123;defineProps, defineEmits, defineExpose, ref&#125; from &#39;vue&#39;;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 父组件传过来的值,带个问号表示可选</span><br><span class="line">const props &#x3D; defineProps&lt;&#123;</span><br><span class="line">  value: string</span><br><span class="line">&#125;&gt;()</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; JS中获取父组件传过来的值</span><br><span class="line">console.log(props.value)</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 点击按钮，触发父组件的自定义事件</span><br><span class="line">const changeParentCount &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">  emit(&quot;changeCount&quot;, 10)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 触发父组件的自定义事件</span><br><span class="line">const emit &#x3D; defineEmits([&quot;changeCount&quot;])</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 定义对外暴露的属性</span><br><span class="line">let order &#x3D; ref(10)</span><br><span class="line">const open &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">  console.log(&quot;open&quot;)</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; 使用defineExpose暴露出去</span><br><span class="line">defineExpose(&#123;</span><br><span class="line">  order,</span><br><span class="line">  open</span><br><span class="line">&#125;)</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.children-box&#123;</span><br><span class="line">  border: 1px solid #ccc;</span><br><span class="line">  padding: 30px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230913222206507.png" alt="image-20230913222206507"></p>
<h3 id="实现瀑布流布局"><a href="#实现瀑布流布局" class="headerlink" title="实现瀑布流布局"></a>实现瀑布流布局</h3><p>父组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;WaterfallFlow :list&#x3D;&quot;list&quot;&#x2F;&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line"></span><br><span class="line">import WaterfallFlow from &quot;@&#x2F;components&#x2F;WaterfallFlow.vue&quot;;</span><br><span class="line">import &#123;reactive&#125; from &quot;vue&quot;;</span><br><span class="line">type listType &#x3D; &#123;</span><br><span class="line">  height:number,</span><br><span class="line">  color:string</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; 随机生成100个高度和颜色的对象</span><br><span class="line">let list &#x3D; reactive&lt;listType[]&gt;([</span><br><span class="line">  ...Array.from(&#123;length:100&#125;,()&#x3D;&gt;(&#123;</span><br><span class="line">    height:Math.floor(Math.random()*250)+50,</span><br><span class="line">    color:&#96;rgb($&#123;Math.floor(Math.random()*255)&#125;,$&#123;Math.floor(Math.random()*255)&#125;,$&#123;Math.floor(Math.random()*255)&#125;)&#96;</span><br><span class="line">  &#125;))</span><br><span class="line"> ])</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>子组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;wraps&quot;&gt;</span><br><span class="line">    &lt;div v-for&#x3D;&quot;item in list&quot; class&#x3D;&quot;item&quot; :style&#x3D;&quot;&#123;</span><br><span class="line">      left: item.left + &#39;px&#39;,</span><br><span class="line">      top: item.top + &#39;px&#39;,</span><br><span class="line">      height: item.height + &#39;px&#39;,</span><br><span class="line">      backgroundColor: item.color,</span><br><span class="line">    &#125;&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line">import &#123;defineProps, onMounted&#125; from &quot;vue&quot;</span><br><span class="line"></span><br><span class="line">const props &#x3D; defineProps&lt;&#123;</span><br><span class="line">  list: any[]</span><br><span class="line">&#125;&gt;()</span><br><span class="line"></span><br><span class="line">const initLayout &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">  &#x2F;&#x2F; 上下左右间隙距离</span><br><span class="line">  let margin &#x3D; 10</span><br><span class="line">  &#x2F;&#x2F; 每个元素的宽度</span><br><span class="line">  let elWidth &#x3D; 120 + margin</span><br><span class="line">  &#x2F;&#x2F; 每行展示的列数</span><br><span class="line">  let colNumber &#x3D; Math.floor(document.querySelector(&quot;.app-content&quot;).clientWidth &#x2F; elWidth)</span><br><span class="line">  &#x2F;&#x2F; 存放元素高度的list</span><br><span class="line">  let heightList &#x3D; []</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; 遍历所有元素</span><br><span class="line">  for (let i &#x3D; 0; i &lt; props.list.length; i++) &#123;</span><br><span class="line">    let el &#x3D; props.list[i]</span><br><span class="line">    &#x2F;&#x2F; i小于colNumber表示第一行元素</span><br><span class="line">    if(i &lt; colNumber)&#123;</span><br><span class="line">      el.top &#x3D; 0</span><br><span class="line">      el.left &#x3D; elWidth * i</span><br><span class="line">      heightList.push(el.height)</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">      &#x2F;&#x2F; 找出最小的高度</span><br><span class="line">      let minHeight &#x3D; Math.min(...heightList)</span><br><span class="line">      &#x2F;&#x2F; 找出最小高度的索引</span><br><span class="line">      let minHeightIndex &#x3D; heightList.indexOf(minHeight)</span><br><span class="line">      &#x2F;&#x2F; 设置元素的位置</span><br><span class="line">      el.left &#x3D; elWidth * minHeightIndex</span><br><span class="line">      el.top &#x3D; minHeight + margin</span><br><span class="line">      &#x2F;&#x2F; 更新高度集合</span><br><span class="line">      heightList[minHeightIndex] &#x3D; minHeight + el.height + margin</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 监听app-content元素的宽度变化</span><br><span class="line">window.onresize &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">  initLayout()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">onMounted(() &#x3D;&gt; &#123;</span><br><span class="line">  initLayout()</span><br><span class="line">&#125;)</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang&#x3D;&quot;scss&quot;&gt;</span><br><span class="line">.wraps&#123;</span><br><span class="line">  height: 100%;</span><br><span class="line">  position: relative;</span><br><span class="line">  .item&#123;</span><br><span class="line">    position: absolute;</span><br><span class="line">    width: 120px;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<p>效果展示</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230913224830334.png" alt="image-20230913224830334"></p>
<h2 id="组件递归"><a href="#组件递归" class="headerlink" title="组件递归"></a>组件递归</h2><p>实现一个如下的东西</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230915214800791.png" alt="image-20230915214800791"></p>
<p>父组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;TreeVue :treeData&#x3D;&#39;treeData&#39;&#x2F;&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line"></span><br><span class="line">import &#123;reactive&#125; from  &quot;vue&quot;</span><br><span class="line">import TreeVue from &quot;@&#x2F;components&#x2F;TreeVue.vue&quot;;</span><br><span class="line"></span><br><span class="line">let treeData &#x3D; reactive([</span><br><span class="line">  &#123;</span><br><span class="line">    label:&quot;1&quot;,</span><br><span class="line">    checked:false,</span><br><span class="line">    children:[</span><br><span class="line">      &#123;</span><br><span class="line">        label:&quot;1-1&quot;,</span><br><span class="line">        checked:false,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        label: &quot;1-2&quot;,</span><br><span class="line">        checked:true,</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    label:&quot;2&quot;,</span><br><span class="line">    checked:false,</span><br><span class="line">    children: [</span><br><span class="line">      &#123;</span><br><span class="line">        label: &quot;2-1&quot;,</span><br><span class="line">        checked:false,</span><br><span class="line">        children:[</span><br><span class="line">          &#123;</span><br><span class="line">            label: &quot;2-1-1&quot;,</span><br><span class="line">            checked:false,</span><br><span class="line">            children:[</span><br><span class="line">              &#123;</span><br><span class="line">                label: &quot;2-1-1-1&quot;,</span><br><span class="line">                checked:false,</span><br><span class="line">              &#125;</span><br><span class="line">            ]</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    label:&quot;3&quot;,</span><br><span class="line">    checked:false,</span><br><span class="line">  &#125;</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p><code>TreeVue.vue</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div v-for&#x3D;&quot;item in treeData&quot; style&#x3D;&quot;margin-left: 15px&quot; @click.stop&#x3D;&quot;getCurrNode(item,$event)&quot;&gt;</span><br><span class="line">    &lt;input type&#x3D;&quot;checkbox&quot; v-model&#x3D;&quot;item.checked&quot;&#x2F;&gt;</span><br><span class="line">    &lt;span&gt;&#123;&#123;item.label&#125;&#125;&lt;&#x2F;span&gt;</span><br><span class="line">    &lt;TreeVue v-if&#x3D;&quot;item.children&quot; :tree-data&#x3D;&quot;item.children&quot;&#x2F;&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123;defineProps&#125; from &quot;vue&quot;</span><br><span class="line">defineProps([&quot;treeData&quot;])</span><br><span class="line"></span><br><span class="line">const getCurrNode &#x3D; (currNode,event) &#x3D;&gt; &#123;</span><br><span class="line">  console.log(currNode)</span><br><span class="line">  console.log(event)</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>控制台打印的东西</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230915214931139.png" alt="image-20230915214931139"></p>
<h2 id="动态组件"><a href="#动态组件" class="headerlink" title="动态组件"></a>动态组件</h2><p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230915222313132.png" alt="image-20230915222313132"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div style&#x3D;&quot;display: flex;gap: 15px&quot;&gt;</span><br><span class="line">    &lt;div v-for&#x3D;&quot;(item,index) in tabData&quot; :key&#x3D;&quot;index&quot;</span><br><span class="line">         class&#x3D;&quot;tab-item&quot;</span><br><span class="line">         :class&#x3D;&quot;&#123;</span><br><span class="line">         active:active &#x3D;&#x3D;&#x3D; index</span><br><span class="line">       &#125;&quot;</span><br><span class="line">         @click&#x3D;&quot;switchCom(item,index)&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &#123;&#123;item.tab&#125;&#125;</span><br><span class="line">      &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">  &lt;component :is&#x3D;&quot;currCom&quot;&gt;&lt;&#x2F;component&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123;reactive, ref, shallowRef,markRaw&#125; from &quot;vue&quot;</span><br><span class="line">import ComA from &quot;@&#x2F;components&#x2F;13&#x2F;ComA.vue&quot;</span><br><span class="line">import ComB from &quot;@&#x2F;components&#x2F;13&#x2F;ComB.vue&quot;</span><br><span class="line">import ComC from &quot;@&#x2F;components&#x2F;13&#x2F;ComC.vue&quot;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 使用shallowRef避免深层相应</span><br><span class="line">let currCom &#x3D; shallowRef(ComA)</span><br><span class="line">let active &#x3D; ref(0)</span><br><span class="line"></span><br><span class="line">let tabData &#x3D; reactive([</span><br><span class="line">  &#123;</span><br><span class="line">    tab:&quot;组件A&quot;,</span><br><span class="line">    &#x2F;&#x2F; 使用markRaw使组件不会被vue进行响应式处理，提高性能</span><br><span class="line">    com:markRaw(ComA)</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    tab:&quot;组件B&quot;,</span><br><span class="line">    com:markRaw(ComB)</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    tab:&quot;组件C&quot;,</span><br><span class="line">    com:markRaw(ComC)</span><br><span class="line">  &#125;</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">const switchCom &#x3D; (item,index) &#x3D;&gt; &#123;</span><br><span class="line">  currCom.value &#x3D; item.com</span><br><span class="line">  active.value &#x3D; index</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.tab-item&#123;</span><br><span class="line">  padding: 5px 15px;</span><br><span class="line">  border: 1px solid black;</span><br><span class="line">&#125;</span><br><span class="line">.active&#123;</span><br><span class="line">  background-color: deepskyblue;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<h2 id="插槽"><a href="#插槽" class="headerlink" title="插槽"></a>插槽</h2><p>定义子组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;box&quot;&gt;</span><br><span class="line">        &lt;div class&#x3D;&quot;header&quot;&gt;</span><br><span class="line">          &lt;slot name&#x3D;&quot;header&quot;&gt;&lt;&#x2F;slot&gt;</span><br><span class="line">        &lt;&#x2F;div&gt;</span><br><span class="line">        &lt;div class&#x3D;&quot;main&quot;&gt;</span><br><span class="line">          &lt;!--默认插槽--&gt;</span><br><span class="line">          &lt;slot :link&#x3D;&quot;link&quot; :age&#x3D;&quot;age&quot;&gt;&lt;&#x2F;slot&gt;</span><br><span class="line">        &lt;&#x2F;div&gt;</span><br><span class="line">        &lt;div class&#x3D;&quot;footer&quot;&gt;</span><br><span class="line">          &lt;slot name&#x3D;&quot;footer&quot;&gt;&lt;&#x2F;slot&gt;</span><br><span class="line">        &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line">&lt;script setup lang&#x3D;&#39;ts&#39;&gt;</span><br><span class="line">import &#123;ref&#125; from &quot;vue&quot;;</span><br><span class="line"></span><br><span class="line">const link &#x3D; ref(&quot;Tome&quot;)</span><br><span class="line">const age &#x3D; ref(18)</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang&#x3D;&quot;scss&quot;&gt;</span><br><span class="line">&#x2F;&#x2F; 父元素高度100%</span><br><span class="line">.box&#123;</span><br><span class="line">  height: 100%;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">&#125;</span><br><span class="line">.header &#123;</span><br><span class="line">  height: 100px;</span><br><span class="line">  background: pink;</span><br><span class="line">  width: 100%;</span><br><span class="line">&#125;</span><br><span class="line">.main&#123;</span><br><span class="line">  flex: 1;</span><br><span class="line">  background-color: #c6e2ff;</span><br><span class="line">&#125;</span><br><span class="line">.footer&#123;</span><br><span class="line">  height: 100px;</span><br><span class="line">  background: blueviolet;</span><br><span class="line">  width: 100%;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<p>定义父组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;Dialog&gt;</span><br><span class="line">    &lt;template #header&gt;</span><br><span class="line">      具名插槽-header</span><br><span class="line">    &lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">    &lt;template #default&#x3D;&quot;&#123;link,age&#125;&quot;&gt;</span><br><span class="line">      这是默认插槽</span><br><span class="line">      &#123;&#123;link&#125;&#125; -- &#123;&#123;age&#125;&#125;</span><br><span class="line">    &lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">    &lt;template #footer&gt;</span><br><span class="line">      具名插槽-footer</span><br><span class="line">    &lt;&#x2F;template&gt;</span><br><span class="line">  &lt;&#x2F;Dialog&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang&#x3D;&#39;ts&#39;&gt;</span><br><span class="line">import Dialog from &quot;@&#x2F;components&#x2F;14&#x2F;Dialog.vue&quot;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>效果</p>
<img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230917182606728.png" alt="image-20230917182606728" style="zoom:50%;" />

<h2 id="异步组件"><a href="#异步组件" class="headerlink" title="异步组件"></a>异步组件</h2><h3 id="添加骨架屏组件"><a href="#添加骨架屏组件" class="headerlink" title="添加骨架屏组件"></a>添加骨架屏组件</h3><p><code>Skeleton.vue</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;el-skeleton style&#x3D;&quot;--el-skeleton-circle-size: 100px&quot;&gt;</span><br><span class="line">    &lt;template #template&gt;</span><br><span class="line">      &lt;el-skeleton-item variant&#x3D;&quot;circle&quot; &#x2F;&gt;</span><br><span class="line">    &lt;&#x2F;template&gt;</span><br><span class="line">  &lt;&#x2F;el-skeleton&gt;</span><br><span class="line">  &lt;br &#x2F;&gt;</span><br><span class="line">  &lt;el-skeleton &#x2F;&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br></pre></td></tr></table></figure>

<p>效果是这个样子</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230917214033824.png" alt="image-20230917214033824"></p>
<h3 id="添加新闻组件"><a href="#添加新闻组件" class="headerlink" title="添加新闻组件"></a>添加新闻组件</h3><p>添加新闻数据，在 public 文件夹中添加 <code>newinfo.json</code></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">&quot;title&quot;</span>: <span class="string">&quot;秋粮陆续成熟 多措并举保粮食丰收&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;眼下，从南到北，各地秋粮陆续成熟。人们全力以赴抓好秋粮生产，多措并举保粮食丰收。\n\n金秋时节，安徽水稻主产区无为市85万亩水稻进入收割期，当地组织机械作业服务队，帮助农民机耕机收，颗粒归仓。今年，安徽计划投入各类农机具240万台套，力争玉米、大豆、中晚稻机收水平达八成以上。&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;url&quot;</span>: <span class="string">&quot;https://baijiahao.baidu.com/s?id=1777244368223895628&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;image&quot;</span>: <span class="string">&quot;https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/img.png&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>引入 axios，请求这个文件</p>
<p><code>src/api/index.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getNewDataFun</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> axios(<span class="string">&quot;../public/newinfo.json&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>编写组件 <code>NewCar.vue</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div v-for&#x3D;&quot;item in newData&quot; class&#x3D;&quot;new-box&quot;&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;image&quot;&gt;</span><br><span class="line">      &lt;img :src&#x3D;&quot;item.image&quot; alt&#x3D;&quot;&quot;&#x2F;&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;content&quot;&gt;</span><br><span class="line">      &lt;div class&#x3D;&quot;title&quot;&gt;&#123;&#123;item.title&#125;&#125;&lt;&#x2F;div&gt;</span><br><span class="line">      &lt;div class&#x3D;&quot;desc&quot;&gt;&#123;&#123;item.description&#125;&#125;&lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line">import &#123;onMounted, reactive, ref&#125; from &quot;vue&quot;;</span><br><span class="line">import &#123;getNewDataFun&#125; from &quot;@&#x2F;api&#x2F;index&quot;;</span><br><span class="line"></span><br><span class="line">type dataType &#x3D; &#123;</span><br><span class="line">  title:string,</span><br><span class="line">  description:string,</span><br><span class="line">  url:string,</span><br><span class="line">  image:string,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const newData &#x3D; ref&lt;dataType[]&gt;([])</span><br><span class="line"></span><br><span class="line">await getNewDataFun().then(res&#x3D;&gt;&#123;</span><br><span class="line">  setTimeout(()&#x3D;&gt;&#123;</span><br><span class="line">    newData.value &#x3D; res.data</span><br><span class="line">  &#125;,2000)</span><br><span class="line">&#125;)</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang&#x3D;&quot;scss&quot;&gt;</span><br><span class="line">.new-box&#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  gap: 15px;</span><br><span class="line">  .image&#123;</span><br><span class="line">    width: 200px;</span><br><span class="line">    border-radius: 5px;</span><br><span class="line">    overflow: hidden;</span><br><span class="line">    img&#123;</span><br><span class="line">      width: 100%;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  .content&#123;</span><br><span class="line">    width: 80%;</span><br><span class="line">    display: flex;</span><br><span class="line">    flex-direction: column;</span><br><span class="line">    gap: 10px;</span><br><span class="line">    .title&#123;</span><br><span class="line">      font-weight: 700;</span><br><span class="line">      font-size: 16px;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<p>效果展示</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230917214242665.png" alt="image-20230917214242665"></p>
<h3 id="使用异步组件"><a href="#使用异步组件" class="headerlink" title="使用异步组件"></a>使用异步组件</h3><p><code>Suspense</code> 是vue内置的一个组件，有两个插槽</p>
<ul>
<li>default：默认插槽，展示等待结果返回后的组件</li>
<li>fallback：等待过程中展示的组件</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div style&#x3D;&quot;padding: 20px&quot;&gt;</span><br><span class="line">    &lt;Suspense&gt;</span><br><span class="line">      &lt;template #default&gt;</span><br><span class="line">        &lt;NewCar&#x2F;&gt;</span><br><span class="line">      &lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">      &lt;template #fallback&gt;</span><br><span class="line">        &lt;Skeleton&#x2F;&gt;</span><br><span class="line">      &lt;&#x2F;template&gt;</span><br><span class="line">    &lt;&#x2F;Suspense&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line">import &#123;defineAsyncComponent&#125; from &quot;vue&quot;</span><br><span class="line"></span><br><span class="line">import Skeleton from &quot;@&#x2F;components&#x2F;15&#x2F;Skeleton.vue&quot;</span><br><span class="line"></span><br><span class="line">const NewCar &#x3D; defineAsyncComponent(()&#x3D;&gt;import(&quot;@&#x2F;components&#x2F;15&#x2F;NewCar.vue&quot;))</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>异步组件必须使用 defineAsyncComponent 函数来导入，接收一个回调函数</p>
</blockquote>
<h2 id="TelePore传送组件"><a href="#TelePore传送组件" class="headerlink" title="TelePore传送组件"></a>TelePore传送组件</h2><h3 id="自定义一个弹框组件"><a href="#自定义一个弹框组件" class="headerlink" title="自定义一个弹框组件"></a>自定义一个弹框组件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;zx-dialog&quot;&gt;</span><br><span class="line">    &lt;slot&gt;&lt;&#x2F;slot&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;zx-dialog__footer&quot;&gt;</span><br><span class="line">      &lt;slot name&#x3D;&quot;footer&quot;&gt;&lt;&#x2F;slot&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang&#x3D;&quot;scss&quot;&gt;</span><br><span class="line">@include b(&quot;dialog&quot;)&#123;</span><br><span class="line">  width: 200px;</span><br><span class="line">  height: 200px;</span><br><span class="line">  position: absolute;</span><br><span class="line">  left: 50%;</span><br><span class="line">  top: 50%;</span><br><span class="line">  margin-left: -100px;</span><br><span class="line">  margin-top: -100px;</span><br><span class="line">  border: 1px solid #ccc;</span><br><span class="line">  background-color: #c6e2ff;</span><br><span class="line">  @include e(&quot;footer&quot;)&#123;</span><br><span class="line">    position: absolute;</span><br><span class="line">    bottom: 0;</span><br><span class="line">    left: 0;</span><br><span class="line">    right: 0;</span><br><span class="line">    height: 50px;</span><br><span class="line">    line-height: 50px;</span><br><span class="line">    text-align: right;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="使用TelePore"><a href="#使用TelePore" class="headerlink" title="使用TelePore"></a>使用TelePore</h3><p>父组件使用这个组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;box&quot;&gt;</span><br><span class="line">    &lt;el-button type&#x3D;&quot;primary&quot; @click&#x3D;&quot;switchDialog &#x3D; !switchDialog&quot;&gt;打开Dialog&lt;&#x2F;el-button&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!--使用teleport将组件渲染到body标签下面，避免受到父组件的position: absolute;定位影响--&gt;</span><br><span class="line">    &lt;teleport to&#x3D;&quot;body&quot; v-if&#x3D;&quot;switchDialog&quot;&gt;</span><br><span class="line">      &lt;MyDialog&gt;</span><br><span class="line">        &lt;template #default&gt;</span><br><span class="line">          弹框内容</span><br><span class="line">        &lt;&#x2F;template&gt;</span><br><span class="line">        &lt;template #footer&gt;</span><br><span class="line">          &lt;el-button @click&#x3D;&quot;switchDialog &#x3D; !switchDialog&quot;&gt;关闭&lt;&#x2F;el-button&gt;</span><br><span class="line">        &lt;&#x2F;template&gt;</span><br><span class="line">      &lt;&#x2F;MyDialog&gt;</span><br><span class="line">    &lt;&#x2F;teleport&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123;ref&#125; from &quot;vue&quot;</span><br><span class="line">import MyDialog from &quot;@&#x2F;components&#x2F;MyDialog.vue&quot;;</span><br><span class="line"></span><br><span class="line">let switchDialog &#x3D; ref(false);</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.box&#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 50%;</span><br><span class="line">  background-color: gold;</span><br><span class="line">  position: absolute;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<p>效果</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230918075355087.png" alt="image-20230918075355087"></p>
<h2 id="KeepAlive"><a href="#KeepAlive" class="headerlink" title="KeepAlive"></a>KeepAlive</h2><p>可以缓存组件内容</p>
<h3 id="默认使用"><a href="#默认使用" class="headerlink" title="默认使用"></a>默认使用</h3><p>切换组件显示后，组件内容不会丢失</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;el-button type&#x3D;&quot;primary&quot; @click&#x3D;&quot;switchFlag&quot;&gt;切换组件&lt;&#x2F;el-button&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;keep-alive&gt;</span><br><span class="line">      &lt;AliveA v-if&#x3D;&quot;flag&quot;&#x2F;&gt;</span><br><span class="line">      &lt;AliveB v-else&#x2F;&gt;</span><br><span class="line">    &lt;&#x2F;keep-alive&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123;ref&#125; from &quot;vue&quot;;</span><br><span class="line">import AliveA from &quot;@&#x2F;components&#x2F;AliveA.vue&quot;;</span><br><span class="line">import AliveB from &quot;@&#x2F;components&#x2F;AliveB.vue&quot;;</span><br><span class="line"></span><br><span class="line">let flag &#x3D; ref(true)</span><br><span class="line"></span><br><span class="line">const switchFlag &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">  flag.value &#x3D; !flag.value</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="includes"><a href="#includes" class="headerlink" title="includes"></a>includes</h3><p>只缓存AliveA组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;keep-alive :include&#x3D;&quot;[&#39;AliveA&#39;]&quot;&gt;</span><br><span class="line">  &lt;AliveA v-if&#x3D;&quot;flag&quot;&#x2F;&gt;</span><br><span class="line">  &lt;AliveB v-else&#x2F;&gt;</span><br><span class="line">&lt;&#x2F;keep-alive&gt;</span><br></pre></td></tr></table></figure>

<h3 id="exclude"><a href="#exclude" class="headerlink" title="exclude"></a>exclude</h3><p>不缓存AliveA组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;keep-alive :exclude&#x3D;&quot;[&#39;AliveA&#39;]&quot;&gt;</span><br><span class="line">  &lt;AliveA v-if&#x3D;&quot;flag&quot;&#x2F;&gt;</span><br><span class="line">  &lt;AliveB v-else&#x2F;&gt;</span><br><span class="line">&lt;&#x2F;keep-alive&gt;</span><br></pre></td></tr></table></figure>

<h3 id="max"><a href="#max" class="headerlink" title="max"></a>max</h3><p>最多缓存的组件个数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;keep-alive :max&#x3D;&quot;10&quot;&gt;</span><br><span class="line">  &lt;AliveA v-if&#x3D;&quot;flag&quot;&#x2F;&gt;</span><br><span class="line">  &lt;AliveB v-else&#x2F;&gt;</span><br><span class="line">&lt;&#x2F;keep-alive&gt;</span><br></pre></td></tr></table></figure>

<h3 id="keep-alive的钩子函数"><a href="#keep-alive的钩子函数" class="headerlink" title="keep-alive的钩子函数"></a>keep-alive的钩子函数</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;script lang=<span class="string">&quot;ts&quot;</span> setup&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; ref,onMounted,onActivated,onDeactivated,onUnmounted, &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 组件显示时只会触发一次</span></span><br><span class="line">onMounted(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;mounted&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 组件显示时触发</span></span><br><span class="line">onActivated(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;activated&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 组件隐藏时触发</span></span><br><span class="line">onDeactivated(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;deactivated&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 被keepalive包裹时，组件销毁不会触发unmounted</span></span><br><span class="line">onUnmounted(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;unmounted&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="transition"><a href="#transition" class="headerlink" title="transition"></a>transition</h2><h3 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h3><p>在进入/离开的过渡中，会有 6 个 class 切换。</p>
<p>v-enter-from：定义进入过渡的开始状态。在元素被插入之前生效，在元素被插入之后的下一帧移除。</p>
<p>v-enter-active：定义进入过渡生效时的状态。在整个进入过渡的阶段中应用，在元素被插入之前生效，在过渡/动画完成之后移除。这个类可以被用来定义进入过渡的过程时间，延迟和曲线函数。</p>
<p>v-enter-to：定义进入过渡的结束状态。在元素被插入之后下一帧生效 (与此同时 v-enter-from 被移除)，在过渡/动画完成之后移除。</p>
<p>v-leave-from：定义离开过渡的开始状态。在离开过渡被触发时立刻生效，下一帧被移除。</p>
<p>v-leave-active：定义离开过渡生效时的状态。在整个离开过渡的阶段中应用，在离开过渡被触发时立刻生效，在过渡/动画完成之后移除。这个类可以被用来定义离开过渡的过程时间，延迟和曲线函数。</p>
<p>v-leave-to：离开过渡的结束状态。在离开过渡被触发之后下一帧生效 (与此同时 v-leave-from 被移除)，在过渡/动画完成之后移除。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;div&gt;</span><br><span class="line">  &lt;el-button type&#x3D;&quot;primary&quot; @click&#x3D;&quot;flag &#x3D; !flag&quot;&gt;切换&lt;&#x2F;el-button&gt;</span><br><span class="line"></span><br><span class="line">  &lt;transition name&#x3D;&quot;fade&quot;&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;box&quot; v-if&#x3D;&quot;flag&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line">  &lt;&#x2F;transition&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123;ref&#125; from &quot;vue&quot;;</span><br><span class="line"></span><br><span class="line">let flag &#x3D; ref(true)</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang&#x3D;&quot;scss&quot;&gt;</span><br><span class="line">.box&#123;</span><br><span class="line">  width: 200px;</span><br><span class="line">  height: 200px;</span><br><span class="line">  background-color: red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;开始过度</span><br><span class="line">  .fade-enter-from&#123;</span><br><span class="line">    background:red;</span><br><span class="line">    width:0px;</span><br><span class="line">    height:0px;</span><br><span class="line">    transform:rotate(360deg)</span><br><span class="line">  &#125;</span><br><span class="line">&#x2F;&#x2F;开始过度了</span><br><span class="line">  .fade-enter-active&#123;</span><br><span class="line">    transition: all 1s ease;</span><br><span class="line">  &#125;</span><br><span class="line">&#x2F;&#x2F;过度完成</span><br><span class="line">  .fade-enter-to&#123;</span><br><span class="line">    background:yellow;</span><br><span class="line">    width:200px;</span><br><span class="line">    height:200px;</span><br><span class="line">  &#125;</span><br><span class="line">&#x2F;&#x2F;离开的过度</span><br><span class="line">  .fade-leave-from&#123;</span><br><span class="line">    width:200px;</span><br><span class="line">    height:200px;</span><br><span class="line">    transform:rotate(360deg)</span><br><span class="line">  &#125;</span><br><span class="line">&#x2F;&#x2F;离开中过度</span><br><span class="line">  .fade-leave-active&#123;</span><br><span class="line">    transition: all 1s linear;</span><br><span class="line">  &#125;</span><br><span class="line">&#x2F;&#x2F;离开完成</span><br><span class="line">  .fade-leave-to&#123;</span><br><span class="line">    width:0px;</span><br><span class="line">    height:0px;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="结合animate"><a href="#结合animate" class="headerlink" title="结合animate"></a>结合animate</h3><p>安装</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install animate.css -D</span><br></pre></td></tr></table></figure>

<p>官网中有很多动画示例 <a target="_blank" rel="noopener" href="https://animate.style/">Animate.css | A cross-browser library of CSS animations.</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;root-box&quot;&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;app-menu&quot;&gt;</span><br><span class="line">      &lt;Menu &#x2F;&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;app-content&quot;&gt;</span><br><span class="line">      &lt;!-- 路由出口 --&gt;</span><br><span class="line">      &lt;!-- 路由匹配到的组件将渲染在这里 --&gt;</span><br><span class="line">      &lt;router-view v-slot&#x3D;&quot;&#123; Component,route  &#125;&quot;&gt;</span><br><span class="line">        &lt;transition enter-active-class&#x3D;&quot;animate__animated animate__fadeInUp&quot;&gt;</span><br><span class="line">          &lt;!-- 这里加一个div是防止页面没有根组件时，动画失效 --&gt;</span><br><span class="line">          &lt;div :key&#x3D;&quot;route.name&quot; style&#x3D;&quot;height: 100%&quot;&gt;</span><br><span class="line">            &lt;component :is&#x3D;&quot;Component&quot; &#x2F;&gt;</span><br><span class="line">          &lt;&#x2F;div&gt;</span><br><span class="line">        &lt;&#x2F;transition&gt;</span><br><span class="line">      &lt;&#x2F;router-view&gt;</span><br><span class="line"></span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import Menu from &#39;.&#x2F;Menu.vue&#39;</span><br><span class="line">import &#39;animate.css&#39;;</span><br><span class="line">&#x2F;&#x2F; 设置所有动画的时间在0.3秒内完成</span><br><span class="line">document.documentElement.style.setProperty(&#39;--animate-duration&#39;, &#39;0.3s&#39;);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang&#x3D;&quot;less&quot;&gt;</span><br><span class="line">.root-box &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 100vh;</span><br><span class="line">  .app-menu &#123;</span><br><span class="line">    width: 200px;</span><br><span class="line">    height: 100vh;</span><br><span class="line">    background-color: #a18cd1;</span><br><span class="line">    text-overflow: ellipsis;</span><br><span class="line">    white-space: nowrap;</span><br><span class="line">    overflow: auto;</span><br><span class="line">  &#125;</span><br><span class="line">  .app-content &#123;</span><br><span class="line">    flex: 1;</span><br><span class="line">    height: 100vh;</span><br><span class="line">    background-color: white;</span><br><span class="line">    overflow: auto;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="transtion生命周期"><a href="#transtion生命周期" class="headerlink" title="transtion生命周期"></a>transtion生命周期</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;transition @before-enter&#x3D;&quot;beforeEnter&quot; @enter&#x3D;&quot;enter&quot; @leave&#x3D;&quot;leave&quot;&gt;</span><br><span class="line">  &lt;div v-if&#x3D;&quot;gsapFlag&quot; class&#x3D;&quot;gsap-box&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;transition&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@before-enter=<span class="string">&quot;beforeEnter&quot;</span> <span class="comment">//对应enter-from</span></span><br><span class="line">@enter=<span class="string">&quot;enter&quot;</span><span class="comment">//对应enter-active</span></span><br><span class="line">@after-enter=<span class="string">&quot;afterEnter&quot;</span><span class="comment">//对应enter-to</span></span><br><span class="line">@enter-cancelled=<span class="string">&quot;enterCancelled&quot;</span><span class="comment">//显示过度打断</span></span><br><span class="line">@before-leave=<span class="string">&quot;beforeLeave&quot;</span><span class="comment">//对应leave-from</span></span><br><span class="line">@leave=<span class="string">&quot;leave&quot;</span><span class="comment">//对应enter-active</span></span><br><span class="line">@after-leave=<span class="string">&quot;afterLeave&quot;</span><span class="comment">//对应leave-to</span></span><br><span class="line">@leave-cancelled=<span class="string">&quot;leaveCancelled&quot;</span><span class="comment">//离开过度打断</span></span><br></pre></td></tr></table></figure>

<h3 id="结合gsap"><a href="#结合gsap" class="headerlink" title="结合gsap"></a>结合gsap</h3><p>安装，官网：<a target="_blank" rel="noopener" href="https://greensock.com/">https://greensock.com/</a></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install gsap</span><br></pre></td></tr></table></figure>

<p>使用</p>
<p>html</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;el-button type&#x3D;&quot;primary&quot; @click&#x3D;&quot;gsapFlag &#x3D; !gsapFlag&quot;&gt;切换&lt;&#x2F;el-button&gt;</span><br><span class="line">&lt;transition @before-enter&#x3D;&quot;beforeEnter&quot; @enter&#x3D;&quot;enter&quot; @leave&#x3D;&quot;leave&quot;&gt;</span><br><span class="line">  &lt;div v-if&#x3D;&quot;gsapFlag&quot; class&#x3D;&quot;gsap-box&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;transition&gt;</span><br></pre></td></tr></table></figure>

<p>js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line"><span class="keyword">import</span> gsap <span class="keyword">from</span> <span class="string">&quot;gsap&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;ref&#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> gsapFlag = ref(<span class="literal">true</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> beforeEnter = <span class="function">(<span class="params">el</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;显示之前&quot;</span>)</span><br><span class="line">  gsap.set(el,&#123;</span><br><span class="line">    width:<span class="number">0</span>,</span><br><span class="line">    height:<span class="number">0</span>,</span><br><span class="line">    background:<span class="string">&quot;green&quot;</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> enter = <span class="function">(<span class="params">el,done</span>) =&gt;</span> &#123;</span><br><span class="line">  gsap.to(el,&#123;</span><br><span class="line">    width:<span class="string">&quot;200px&quot;</span>,</span><br><span class="line">    height:<span class="string">&quot;200px&quot;</span>,</span><br><span class="line">    background:<span class="string">&quot;red&quot;</span>,</span><br><span class="line">    rotate:<span class="string">&quot;360dge&quot;</span>,</span><br><span class="line">    duration:<span class="number">1</span>, <span class="comment">// 动画时长，单位是秒</span></span><br><span class="line">    onComplete:done, <span class="comment">// 动画完成后的回调函数</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> leave = <span class="function">(<span class="params">el,done</span>) =&gt;</span> &#123;</span><br><span class="line">  gsap.to(el,&#123;</span><br><span class="line">    width:<span class="number">0</span>,</span><br><span class="line">    height:<span class="number">0</span>,</span><br><span class="line">    background:<span class="string">&quot;green&quot;</span>,</span><br><span class="line">    rotate:<span class="string">&quot;-360dge&quot;</span>,</span><br><span class="line">    duration:<span class="number">1</span>, <span class="comment">// 动画时长，单位是秒</span></span><br><span class="line">    onComplete:done</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>效果</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/%E5%8A%A8%E7%94%BB.gif"></p>
<h3 id="appear属性"><a href="#appear属性" class="headerlink" title="appear属性"></a>appear属性</h3><p>在 transtion 组件中添加 appear 可以在进入页面时就触发对应的样式代码</p>
<ul>
<li>appear-class：初始样式</li>
<li>appear-to-class：结束样式</li>
<li>appear-active-class：动画曲线</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;transition appear appear-class&#x3D;&quot;&quot; appear-to-class&#x3D;&quot;&quot; appear-active-class&#x3D;&quot;animate__animated animate__rubberBand&quot; name&#x3D;&quot;fade&quot;&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;box&quot; v-if&#x3D;&quot;flag&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;transition&gt;</span><br></pre></td></tr></table></figure>

<p>结合animate__animated实现一个进入页面就执行的一个动画效果</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/%E5%8A%A8%E7%94%BB1.gif"></p>
<h3 id="transition-group"><a href="#transition-group" class="headerlink" title="transition-group"></a>transition-group</h3><p>在遍历数组的时候可以给每一个元素添加过度动画，生命周期和transition一致，我们结合animate来实现一个列表的动画效果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">  &lt;el-button type&#x3D;&quot;primary&quot; @click&#x3D;&quot;add&quot;&gt;add&lt;&#x2F;el-button&gt;</span><br><span class="line">  &lt;el-button type&#x3D;&quot;danger&quot; @click&#x3D;&quot;pop&quot;&gt;pop&lt;&#x2F;el-button&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line">&lt;div class&#x3D;&quot;warp&quot;&gt;</span><br><span class="line">  &lt;transition-group</span><br><span class="line">      enter-active-class&#x3D;&quot;animate__animated animate__bounceInLeft&quot;</span><br><span class="line">      leave-active-class&#x3D;&quot;animate__animated animate__fadeOutRight&quot;</span><br><span class="line">  &gt;</span><br><span class="line">    &lt;div v-for&#x3D;&quot;item in groupList&quot; :key&#x3D;&quot;item&quot; class&#x3D;&quot;item&quot;&gt;</span><br><span class="line">      &#123;&#123;item&#125;&#125;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">  &lt;&#x2F;transition-group&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;ref,reactive&#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;animate.css&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> groupList = reactive([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> add = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  groupList.push(groupList.length + <span class="number">1</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> pop = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  groupList.pop()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>动画效果</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/%E5%8A%A8%E7%94%BB2.gif"></p>
<h3 id="实现一个炫酷的动画效果"><a href="#实现一个炫酷的动画效果" class="headerlink" title="实现一个炫酷的动画效果"></a>实现一个炫酷的动画效果</h3><p>安装lodash库 <a target="_blank" rel="noopener" href="https://www.lodashjs.com/">Lodash 简介 | Lodash中文文档 | Lodash中文网 (lodashjs.com)</a></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i --save lodash</span><br></pre></td></tr></table></figure>

<p>实现代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;div style&#x3D;&quot;margin-top: 20px&quot;&gt;平面动画过度效果&lt;&#x2F;div&gt;</span><br><span class="line">&lt;el-button type&#x3D;&quot;primary&quot; @click&#x3D;&quot;shuffle&quot;&gt;动画&lt;&#x2F;el-button&gt;</span><br><span class="line">&lt;div class&#x3D;&quot;num-wrap&quot;&gt;</span><br><span class="line">  &lt;transition-group move-class&#x3D;&quot;move-class&quot;&gt;</span><br><span class="line">    &lt;div v-for&#x3D;&quot;item in numList&quot; :key&#x3D;&quot;item.id&quot; class&#x3D;&quot;num-item&quot;&gt;</span><br><span class="line">      &#123;&#123;item.value&#125;&#125;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">  &lt;&#x2F;transition-group&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;ref,reactive&#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> _ <span class="keyword">from</span> <span class="string">&quot;lodash&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> numList = ref(<span class="built_in">Array</span>.apply(<span class="literal">null</span>, &#123;<span class="attr">length</span>: <span class="number">81</span>&#125;).map(<span class="function">(<span class="params">_,index</span>)=&gt;</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    id:index,</span><br><span class="line">    value:(index % <span class="number">9</span>) + <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;))</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> shuffle = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// shuffle 用来创建一个被打乱值的集合</span></span><br><span class="line">  numList.value = _.shuffle(numList.value)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$numWidth:60px;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.move-class</span>&#123;</span><br><span class="line">  <span class="attribute">transition</span>: all <span class="number">1s</span> ease;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.num-wrap</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-wrap</span>: wrap;</span><br><span class="line">  <span class="attribute">width</span>: calc(#&#123;$numWidth&#125; * <span class="number">9</span> + <span class="number">5px</span> * <span class="number">8</span>);</span><br><span class="line">  gap: 5px;</span><br><span class="line">  <span class="selector-class">.num-item</span>&#123;</span><br><span class="line">    width: $numWidth;</span><br><span class="line">    height: $numWidth;</span><br><span class="line">    line-height: $numWidth;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>实现效果</p>
<img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/pingyi.gif" style="zoom:67%;" />

<h3 id="使用gsap实现数字滚动"><a href="#使用gsap实现数字滚动" class="headerlink" title="使用gsap实现数字滚动"></a>使用gsap实现数字滚动</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;div style&#x3D;&quot;margin-top: 20px;height: 2px&quot;&gt;使用gsap实现数字滚动&lt;&#x2F;div&gt;</span><br><span class="line">&lt;el-input v-model&#x3D;&quot;rolling.num&quot; placeholder&#x3D;&quot;placeholder&quot; style&#x3D;&quot;width: 200px&quot;&gt;&lt;&#x2F;el-input&gt;</span><br><span class="line">&lt;h1&gt;</span><br><span class="line">  &#123;&#123;rolling.numRul.toFixed(0)&#125;&#125;</span><br><span class="line">&lt;&#x2F;h1&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gsap <span class="keyword">from</span> <span class="string">&quot;gsap&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;ref,reactive,watch&#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> rolling = reactive(&#123;</span><br><span class="line">  num:<span class="number">10</span>,</span><br><span class="line">  numRul:<span class="number">10</span></span><br><span class="line">&#125;)</span><br><span class="line">watch(<span class="function">()=&gt;</span>rolling.num,<span class="function">(<span class="params">newVal</span>)=&gt;</span>&#123;</span><br><span class="line">  gsap.to(rolling,&#123;</span><br><span class="line">    numRul:newVal,</span><br><span class="line">    duration:<span class="number">1</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/guodu.gif"></p>
<h2 id="依赖注入provide和inject"><a href="#依赖注入provide和inject" class="headerlink" title="依赖注入provide和inject"></a>依赖注入provide和inject</h2><p>爷爷组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h1&gt;爷爷组件&lt;&#x2F;h1&gt;</span><br><span class="line">  &lt;el-button type&#x3D;&quot;primary&quot; @click&#x3D;&quot;setColor(&#39;red&#39;)&quot;&gt;红色&lt;&#x2F;el-button&gt;</span><br><span class="line">  &lt;el-button type&#x3D;&quot;primary&quot; @click&#x3D;&quot;setColor(&#39;blue&#39;)&quot;&gt;蓝色&lt;&#x2F;el-button&gt;</span><br><span class="line">  &lt;el-button type&#x3D;&quot;primary&quot; @click&#x3D;&quot;setColor(&#39;pink&#39;)&quot;&gt;粉色&lt;&#x2F;el-button&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;box&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line"></span><br><span class="line">  &lt;hr&gt;</span><br><span class="line">  &lt;ProvideA&#x2F;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;hr&gt;</span><br><span class="line">  &lt;ProvideB&#x2F;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line">import &#123;provide, inject, ref&#125; from &quot;vue&quot;</span><br><span class="line">import ProvideA from &quot;@&#x2F;components&#x2F;ProvideA.vue&quot;;</span><br><span class="line">import ProvideB from &quot;@&#x2F;components&#x2F;ProvideB.vue&quot;;</span><br><span class="line"></span><br><span class="line">let color &#x3D; ref(&quot;red&quot;)</span><br><span class="line"></span><br><span class="line">provide(&quot;color&quot;,color)</span><br><span class="line"></span><br><span class="line">const setColor &#x3D; (c) &#x3D;&gt; &#123;</span><br><span class="line">  color.value &#x3D; c</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.box&#123;</span><br><span class="line">  width: 100px;</span><br><span class="line">  height: 100px;</span><br><span class="line">  background-color: v-bind(color);</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<p><code>ProvideA</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h1&gt;爸爸组件&lt;&#x2F;h1&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;box&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line">import &#123;inject&#125; from &quot;vue&quot;</span><br><span class="line">import type &#123;Ref&#125; from &quot;vue&quot;</span><br><span class="line">let color:Ref&lt;string&gt; &#x3D; inject(&quot;color&quot;)</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.box&#123;</span><br><span class="line">  width: 100px;</span><br><span class="line">  height: 100px;</span><br><span class="line">  background-color: v-bind(color);</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<p><code>ProvideB</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h1&gt;孙子组件&lt;&#x2F;h1&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;box&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line">    &lt;button @click&#x3D;&quot;setColor&quot;&gt;设置粉色&lt;&#x2F;button&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line">import &#123;inject&#125; from &quot;vue&quot;</span><br><span class="line">import type &#123;Ref&#125; from &quot;vue&quot;</span><br><span class="line">let color:Ref&lt;string&gt; &#x3D; inject(&quot;color&quot;)</span><br><span class="line"></span><br><span class="line">const setColor &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">  color.value &#x3D; &quot;pink&quot;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.box&#123;</span><br><span class="line">  width: 100px;</span><br><span class="line">  height: 100px;</span><br><span class="line">  background-color: v-bind(color);</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<p>实现效果</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5.gif"></p>
<h2 id="兄弟传参"><a href="#兄弟传参" class="headerlink" title="兄弟传参"></a>兄弟传参</h2><h3 id="Mitt"><a href="#Mitt" class="headerlink" title="Mitt"></a>Mitt</h3><p>安装</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install mitt</span><br></pre></td></tr></table></figure>

<h4 id="局部使用"><a href="#局部使用" class="headerlink" title="局部使用"></a>局部使用</h4><p>添加一个JS文件导出</p>
<p><code>utils/mitt.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> mitt <span class="keyword">from</span> <span class="string">&quot;mitt&quot;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> mitt()</span><br></pre></td></tr></table></figure>

<p>使用，分别定义 A B两个组件</p>
<p><code>BusA</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;box&quot;&gt;</span><br><span class="line">    我是A组件</span><br><span class="line">    &lt;el-button type&#x3D;&quot;primary&quot; @click&#x3D;&quot;changeFlag&quot;&gt;改变&lt;&#x2F;el-button&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import mitt from &quot;..&#x2F;utils&#x2F;mitt&quot;</span><br><span class="line">import &#123;ref&#125; from &quot;vue&quot;;</span><br><span class="line"></span><br><span class="line">let flag &#x3D; ref(false)</span><br><span class="line">const changeFlag &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">  flag.value &#x3D; !flag.value</span><br><span class="line">  mitt.emit(&quot;changeFlag&quot;,flag.value)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p><code>BusB</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;box&quot;&gt;</span><br><span class="line">    我是B组件</span><br><span class="line">    &#123;&#123;flag&#125;&#125;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import mitt from &quot;..&#x2F;utils&#x2F;mitt&quot;;</span><br><span class="line">import &#123;ref,onBeforeUnmount&#125; from &quot;vue&quot;;</span><br><span class="line">let flag &#x3D; ref(false)</span><br><span class="line"></span><br><span class="line">mitt.on(&#39;changeFlag&#39;, data&#x3D;&gt;&#123;</span><br><span class="line">  flag.value &#x3D; data</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">onBeforeUnmount(()&#x3D;&gt;&#123;</span><br><span class="line">  mitt.off(&quot;changeFlag&quot;)</span><br><span class="line">&#125;)</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>在父组件引入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;BusA&#x2F;&gt;</span><br><span class="line">  &lt;BusB&#x2F;&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import BusA from &quot;@&#x2F;components&#x2F;BusA.vue&quot;;</span><br><span class="line">import BusB from &quot;@&#x2F;components&#x2F;BusB.vue&quot;;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>效果</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/bus.gif"></p>
<h4 id="全局使用"><a href="#全局使用" class="headerlink" title="全局使用"></a>全局使用</h4><p>main文件添加</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import &#x27;./assets/main.css&#x27;</span><br><span class="line">import &#123; createApp &#125; from &#x27;vue&#x27;</span><br><span class="line">import &#123; createPinia &#125; from &#x27;pinia&#x27;</span><br><span class="line">import ElementPlus from &#x27;element-plus&#x27;</span><br><span class="line">import App from &#x27;./App.vue&#x27;</span><br><span class="line">import router from &#x27;./router&#x27;</span><br><span class="line">import &#x27;element-plus/dist/index.css&#x27;</span><br><span class="line">import zhCn from &#x27;element-plus/dist/locale/zh-cn.min.js&#x27;</span><br><span class="line">import &#x27;dayjs/locale/zh-cn&#x27;</span><br><span class="line"></span><br><span class="line"><span class="addition">+ import mitt from &quot;mitt&quot;</span></span><br><span class="line"><span class="addition">+ const Mitt = mitt()</span></span><br><span class="line"></span><br><span class="line">const app = createApp(App)</span><br><span class="line">app.use(createPinia())</span><br><span class="line">app.use(router)</span><br><span class="line">app.use(ElementPlus, &#123; locale: zhCn &#125;)</span><br><span class="line">app.mount(&#x27;#app&#x27;)</span><br><span class="line"></span><br><span class="line"><span class="addition">+ declare module &#x27;vue&#x27;&#123;</span></span><br><span class="line"><span class="addition">+   export interface ComponentCustomProperties &#123;</span></span><br><span class="line"><span class="addition">+       $Bus: typeof Mitt</span></span><br><span class="line"><span class="addition">+   &#125;</span></span><br><span class="line"><span class="addition">+ &#125;</span></span><br><span class="line"><span class="addition">+ app.config.globalProperties.$bus = Mitt</span></span><br></pre></td></tr></table></figure>

<p>文件内部通过从 vue 中导出 getCurrentInstance 方法获取当前实例获取定义的全局变量使用</p>
<p><code>BusA</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;box&quot;&gt;</span><br><span class="line">    我是A组件</span><br><span class="line">    &lt;el-button type&#x3D;&quot;primary&quot; @click&#x3D;&quot;changeFlag&quot;&gt;改变&lt;&#x2F;el-button&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123;ref,getCurrentInstance&#125; from &quot;vue&quot;;</span><br><span class="line"></span><br><span class="line">let flag &#x3D; ref(false)</span><br><span class="line">let instance &#x3D; getCurrentInstance()</span><br><span class="line"></span><br><span class="line">const changeFlag &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">  flag.value &#x3D; !flag.value</span><br><span class="line">  instance?.proxy?.$bus.emit(&quot;changeFlag&quot;,flag.value)</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p><code>BusB</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;box&quot;&gt;</span><br><span class="line">    我是B组件</span><br><span class="line">    &#123;&#123;flag&#125;&#125;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123;ref, onBeforeUnmount, getCurrentInstance&#125; from &quot;vue&quot;;</span><br><span class="line">let flag &#x3D; ref(false)</span><br><span class="line">let instance &#x3D; getCurrentInstance()</span><br><span class="line"></span><br><span class="line">instance?.proxy?.$bus.on(&#39;changeFlag&#39;, data&#x3D;&gt;&#123;</span><br><span class="line">  flag.value &#x3D; data</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">onBeforeUnmount(()&#x3D;&gt;&#123;</span><br><span class="line">  instance?.proxy?.$bus.off(&quot;changeFlag&quot;)</span><br><span class="line">&#125;)</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="手写Bus"><a href="#手写Bus" class="headerlink" title="手写Bus"></a>手写Bus</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyBus</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.list = &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="title">emit</span>(<span class="params">event, ...args</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> funs = <span class="built_in">this</span>.list[event]</span><br><span class="line">        funs.forEach(<span class="function">(<span class="params">fun</span>) =&gt;</span>&#123;</span><br><span class="line">            fun.apply(<span class="built_in">this</span>,args)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="title">on</span>(<span class="params">event, callback</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> funs = <span class="built_in">this</span>.list[event]</span><br><span class="line">        <span class="keyword">if</span>(funs)&#123;</span><br><span class="line">            funs.push(callback)</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            funs = [callback]</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">this</span>.list[event] = funs</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="title">off</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">delete</span> <span class="built_in">this</span>.list[event]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> MyBus()</span><br></pre></td></tr></table></figure>

<h2 id="jsx插件"><a href="#jsx插件" class="headerlink" title="jsx插件"></a>jsx插件</h2><p>安装</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm <span class="keyword">in</span> stall @vitejs/plugin-vue-jsx -D</span><br></pre></td></tr></table></figure>

<p>在 vite.config.js 中使用</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; fileURLToPath, URL &#125; <span class="keyword">from</span> <span class="string">&#x27;node:url&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&#x27;vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> vue <span class="keyword">from</span> <span class="string">&#x27;@vitejs/plugin-vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> vueJsx <span class="keyword">from</span> <span class="string">&#x27;@vitejs/plugin-vue-jsx&#x27;</span></span><br><span class="line"><span class="keyword">import</span> AutoImport <span class="keyword">from</span> <span class="string">&#x27;unplugin-auto-import/vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Components <span class="keyword">from</span> <span class="string">&#x27;unplugin-vue-components/vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; ElementPlusResolver &#125; <span class="keyword">from</span> <span class="string">&#x27;unplugin-vue-components/resolvers&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// https://vitejs.dev/config/</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> defineConfig(&#123;</span><br><span class="line">  <span class="built_in">module</span>:<span class="string">&quot;es2022&quot;</span>,</span><br><span class="line">  plugins: [</span><br><span class="line">    vue(),</span><br><span class="line">    vueJsx(),</span><br><span class="line">    AutoImport(&#123;</span><br><span class="line">      resolvers: [ElementPlusResolver()],</span><br><span class="line">    &#125;),</span><br><span class="line">    Components(&#123;</span><br><span class="line">      resolvers: [ElementPlusResolver()],</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">  resolve: &#123;</span><br><span class="line">    alias: &#123;</span><br><span class="line">      <span class="string">&#x27;@&#x27;</span>: fileURLToPath(<span class="keyword">new</span> URL(<span class="string">&#x27;./src&#x27;</span>, <span class="keyword">import</span>.meta.url))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  css: &#123;</span><br><span class="line">    preprocessorOptions: &#123;</span><br><span class="line">      scss: &#123;</span><br><span class="line">        additionalData: <span class="string">&quot;@import &#x27;./src/layout_v2/css/bem.scss&#x27;;&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>新建 <code>JsxCom.tsx</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">import &#123;defineComponent, reactive, ref&#125; from &quot;vue&quot;</span><br><span class="line">import &#123;ElButton&#125; from &quot;element-plus&quot;</span><br><span class="line"></span><br><span class="line">interface propType  &#123;</span><br><span class="line">    msg?:string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default defineComponent(&#123;</span><br><span class="line">    props:&#123;</span><br><span class="line">        msg:String,</span><br><span class="line">    &#125;,</span><br><span class="line">    emits:[],</span><br><span class="line">    setup(prop:propType,&#123;emit,attrs,slots,expose&#125;)&#123;</span><br><span class="line">        let flag &#x3D; ref(false)</span><br><span class="line"></span><br><span class="line">        const chagneFlag &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">            flag.value &#x3D; true</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        let list &#x3D; reactive([1,2,3,4,5])</span><br><span class="line"></span><br><span class="line">        return ()&#x3D;&gt; &lt;&gt;</span><br><span class="line">            &#123;&#x2F;*遍历循环*&#x2F;&#125;</span><br><span class="line">            &#123;list.map(item &#x3D;&gt; &lt;h1&gt;&#123;item&#125;&lt;&#x2F;h1&gt;)&#125;</span><br><span class="line">            &lt;hr&#x2F;&gt;</span><br><span class="line">            &#123;&#x2F;*按钮事件，使用onclick&#x3D;&#123;()&#x3D;&gt;chagneFlag()&#125;*&#x2F;&#125;</span><br><span class="line">            &lt;ElButton type&#x3D;&quot;primary&quot; onclick&#x3D;&#123;()&#x3D;&gt;chagneFlag()&#125;&gt;改变这个值&lt;&#x2F;ElButton&gt;</span><br><span class="line">            &#123;flag.value &amp;&amp; &lt;h1&gt;改变后的值&lt;&#x2F;h1&gt;&#125;</span><br><span class="line">            &lt;hr&#x2F;&gt;</span><br><span class="line">            &lt;div&gt;父组件传递的值：&#123;prop.msg&#125;&lt;&#x2F;div&gt;</span><br><span class="line">        &lt;&#x2F;&gt;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>在vue中可以把这个当成普通的组件使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;JsxCom msg&#x3D;&quot;Hello Jsx&quot;&#x2F;&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import JsxCom from &#39;..&#x2F;components&#x2F;JsxCom&#39;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>页面效果</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230924150109742.png" alt="image-20230924150109742"></p>
<h2 id="自动引入插件"><a href="#自动引入插件" class="headerlink" title="自动引入插件"></a>自动引入插件</h2><p>安装</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm istall unplugin-auto-import/vite</span><br></pre></td></tr></table></figure>

<p>配置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> AutoImport <span class="keyword">from</span> <span class="string">&#x27;unplugin-auto-import/vite&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> defineConfig(&#123;</span><br><span class="line">  <span class="built_in">module</span>:<span class="string">&quot;es2022&quot;</span>,</span><br><span class="line">  plugins: [</span><br><span class="line">    vue(),</span><br><span class="line">    vueJsx(),</span><br><span class="line">    AutoImport(&#123;</span><br><span class="line">      resolvers: [ElementPlusResolver()],</span><br><span class="line">      imports: [<span class="string">&#x27;vue&#x27;</span>, <span class="string">&#x27;vue-router&#x27;</span>], <span class="comment">// 自动引入vue，和vue-router相关</span></span><br><span class="line">      dts: <span class="string">&#x27;src/auto-imports.d.ts&#x27;</span> <span class="comment">// 自动生成的依赖文件</span></span><br><span class="line">    &#125;),</span><br><span class="line">    Components(&#123;</span><br><span class="line">      resolvers: [ElementPlusResolver()],</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">  </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>保存后查看 <code>src/auto-imports.d.ts</code> 内容</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230924150915291.png" alt="image-20230924150915291"></p>
<p>里面自动的帮我们了引入</p>
<p>然后再组件中不需要手动的导入 vue，就可以使用vue中的各种声明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;el-button type&#x3D;&quot;primary&quot; @click&#x3D;&quot;flag &#x3D; !flag&quot;&gt;buttonCont&lt;&#x2F;el-button&gt;</span><br><span class="line"></span><br><span class="line">  &lt;div&gt;</span><br><span class="line">      &#123;&#123;flag&#125;&#125;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">let flag &#x3D; ref(false)</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="v-model在组件中的使用"><a href="#v-model在组件中的使用" class="headerlink" title="v-model在组件中的使用"></a>v-model在组件中的使用</h2><h3 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h3><p>vue3中在组件上绑定v-model时，默认的prop变成了modelValue</p>
<p>子组件 <code>Vmodel</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;el-input v-model&#x3D;&quot;input&quot; placeholder&#x3D;&quot;placeholder&quot; @input&#x3D;&quot;changeValue&quot; style&#x3D;&quot;width: 200px&quot;&gt;&lt;&#x2F;el-input&gt;</span><br><span class="line">    &lt;el-button&gt;关闭&lt;&#x2F;el-button&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line">import &#123;defineProps,defineEmits&#125; from &quot;vue&quot;</span><br><span class="line"></span><br><span class="line">const props &#x3D; defineProps&lt;&#123;</span><br><span class="line">  modelValue:string,</span><br><span class="line">&#125;&gt;()</span><br><span class="line">&#x2F;&#x2F; 更新model绑定的值固定写法: update:modelValue</span><br><span class="line">const emit &#x3D; defineEmits([&#39;update:modelValue&#39;])</span><br><span class="line"></span><br><span class="line">let input &#x3D; ref(&quot;&quot;)</span><br><span class="line"></span><br><span class="line">onMounted(()&#x3D;&gt;&#123;</span><br><span class="line">  input.value &#x3D; props.modelValue</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">const changeValue &#x3D; (e) &#x3D;&gt; &#123;</span><br><span class="line">  &#x2F;&#x2F; 修改父组件的值</span><br><span class="line">  emit(&#39;update:modelValue&#39;,e)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>父组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  父组件的值：&#123;&#123;value&#125;&#125;</span><br><span class="line">  &lt;div class&#x3D;&quot;box&quot;&gt;</span><br><span class="line">    &lt;Vmodel v-model&#x3D;&quot;value&quot; &#x2F;&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line">import Vmodel from &quot;@&#x2F;components&#x2F;Vmodel.vue&quot;;</span><br><span class="line"></span><br><span class="line">let value &#x3D; ref(&quot;你好&quot;)</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.box&#123;</span><br><span class="line">  border: 2px solid black;</span><br><span class="line">  padding: 30px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/v-model.gif"></p>
<h3 id="绑定多个v-model"><a href="#绑定多个v-model" class="headerlink" title="绑定多个v-model"></a>绑定多个v-model</h3><p>父组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  父组件的值：&#123;&#123;value&#125;&#125;</span><br><span class="line">  &lt;el-button @click&#x3D;&quot;isShow &#x3D; !isShow&quot;&gt;切换显示&lt;&#x2F;el-button&gt;</span><br><span class="line">  </span><br><span class="line">  &lt;div class&#x3D;&quot;box&quot;&gt;</span><br><span class="line">    &lt;Vmodel v-model&#x3D;&quot;value&quot; v-model:isShow&#x3D;&quot;isShow&quot;&#x2F;&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line">import Vmodel from &quot;@&#x2F;components&#x2F;Vmodel.vue&quot;;</span><br><span class="line"></span><br><span class="line">let value &#x3D; ref(&quot;你好&quot;)</span><br><span class="line">let isShow &#x3D; ref(true)</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.box&#123;</span><br><span class="line">  border: 2px solid black;</span><br><span class="line">  padding: 30px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<p>子组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div v-if&#x3D;&quot;isShow&quot;&gt;</span><br><span class="line">    &lt;el-input v-model&#x3D;&quot;input&quot; placeholder&#x3D;&quot;placeholder&quot; @input&#x3D;&quot;changeValue&quot; style&#x3D;&quot;width: 200px&quot;&gt;&lt;&#x2F;el-input&gt;</span><br><span class="line">    &lt;el-button @click&#x3D;&quot;close&quot;&gt;关闭&lt;&#x2F;el-button&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line">import &#123;defineProps,defineEmits&#125; from &quot;vue&quot;</span><br><span class="line"></span><br><span class="line">const props &#x3D; defineProps&lt;&#123;</span><br><span class="line">  modelValue:string,</span><br><span class="line">  isShow:boolean</span><br><span class="line">&#125;&gt;()</span><br><span class="line">&#x2F;&#x2F; 更新model绑定的值固定写法: update:modelValue</span><br><span class="line">const emit &#x3D; defineEmits([&#39;update:modelValue&#39;,&#39;update:isShow&#39;])</span><br><span class="line"></span><br><span class="line">let input &#x3D; ref(&quot;&quot;)</span><br><span class="line"></span><br><span class="line">onMounted(()&#x3D;&gt;&#123;</span><br><span class="line">  input.value &#x3D; props.modelValue</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">const changeValue &#x3D; (e) &#x3D;&gt; &#123;</span><br><span class="line">  &#x2F;&#x2F; 修改父组件的值</span><br><span class="line">  emit(&#39;update:modelValue&#39;,e)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const close &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">  emit(&quot;update:isShow&quot;,false)</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="自定义指令"><a href="#自定义指令" class="headerlink" title="自定义指令"></a>自定义指令</h2><h3 id="自定义指令的声明周期"><a href="#自定义指令的声明周期" class="headerlink" title="自定义指令的声明周期"></a>自定义指令的声明周期</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;box&quot; v-resize&#x3D;&quot;onResize&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line">import &#123; Directive &#125; from &#39;vue&#39;</span><br><span class="line"></span><br><span class="line">const onResize &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">  console.log(&quot;宽高变化&quot;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 声明一个局部自定义指令，必须以v开头</span><br><span class="line">const vResize:Directive &#x3D; &#123;</span><br><span class="line">  created()&#123;</span><br><span class="line">    console.log(&quot;created&quot;)</span><br><span class="line">  &#125;,</span><br><span class="line">  beforeMount()&#123;</span><br><span class="line">    console.log(&quot;beforeMount&quot;)</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted(...arg)&#123;</span><br><span class="line">    console.log(&quot;mounted&quot;)</span><br><span class="line">    console.log(arg)</span><br><span class="line">  &#125;,</span><br><span class="line">  beforeUpdate()&#123;</span><br><span class="line">    console.log(&quot;beforeUpdate&quot;)</span><br><span class="line">  &#125;,</span><br><span class="line">  updated()&#123;</span><br><span class="line">    console.log(&quot;updated&quot;)</span><br><span class="line">  &#125;,</span><br><span class="line">  beforeUnmount()&#123;</span><br><span class="line">    console.log(&quot;beforeUnmount&quot;)</span><br><span class="line">  &#125;,</span><br><span class="line">  unmounted()&#123;</span><br><span class="line">    console.log(&quot;unmounted&quot;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.box&#123;</span><br><span class="line">  height: 100%;</span><br><span class="line">  background-color: #f5f5f5;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<p>在任意一个钩子函数头能拿到自定义指令绑定的参数，我们通过打印 arg 看看参数有什么</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230924171641529.png" alt="image-20230924171641529"></p>
<p>我们利用这两个参数实现监听元素宽高变化的指令，当元素宽高发生变化时调用绑定的函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">mounted</span>(<span class="params">el,bindings</span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;mounted&quot;</span>)</span><br><span class="line">  <span class="comment">// 监听元素宽高变化</span></span><br><span class="line">  <span class="keyword">const</span> resizeObserver = <span class="keyword">new</span> ResizeObserver(<span class="function"><span class="params">entries</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> width = entries[<span class="number">0</span>].contentRect.width;</span><br><span class="line">    <span class="keyword">let</span> height = entries[<span class="number">0</span>].contentRect.height;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`元素宽度：<span class="subst">$&#123;width&#125;</span>,元素高度：<span class="subst">$&#123;height&#125;</span>`</span>)</span><br><span class="line">    bindings.value()</span><br><span class="line">  &#125;);</span><br><span class="line">  resizeObserver.observe(el);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>修改 mounted 钩子的内容，通过observe 观察 el，然后调用 bindings.value</p>
<img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/direction.gif" style="zoom:50%;" />

<h3 id="自定义指令的简写方式"><a href="#自定义指令的简写方式" class="headerlink" title="自定义指令的简写方式"></a>自定义指令的简写方式</h3><p>我们也可以通过函数的方式来自定义指令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;el-button v-has-show&#x3D;&quot;&#39;order:add&#39;&quot; type&#x3D;&quot;primary&quot;&gt;新增&lt;&#x2F;el-button&gt;</span><br><span class="line">  &lt;el-button v-has-show&#x3D;&quot;&#39;order:update&#39;&quot; type&#x3D;&quot;warning&quot;&gt;修改&lt;&#x2F;el-button&gt;</span><br><span class="line">  &lt;el-button v-has-show&#x3D;&quot;&#39;order:delete&#39;&quot; type&#x3D;&quot;danger&quot;&gt;删除&lt;&#x2F;el-button&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line">import &#123; Directive &#125; from &#39;vue&#39;</span><br><span class="line">&#x2F;&#x2F;permission</span><br><span class="line">localStorage.setItem(&#39;userId&#39;,&#39;songzx&#39;)</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;mock后台返回的数据</span><br><span class="line">const permission &#x3D; [</span><br><span class="line">  &#x2F;&#x2F; &#39;songzx:order:add&#39;,</span><br><span class="line">  &#39;songzx:order:update&#39;,</span><br><span class="line">  &#39;songzx:order:delete&#39;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">const userId &#x3D; localStorage.getItem(&#39;userId&#39;) as string</span><br><span class="line"></span><br><span class="line">const vHasShow:Directive&lt;HTMLElement,string&gt; &#x3D; (el,binding)&#x3D;&gt;&#123;</span><br><span class="line">  if(!permission.includes(&#96;$&#123;userId&#125;:$&#123;binding.value&#125;&#96;))&#123;</span><br><span class="line">    &#x2F;&#x2F; 直接移除这个元素，比使用 el.style.display &#x3D; &#39;none&#39; 更安全</span><br><span class="line">    el.remove()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>上面的例子是一个按钮级别权限的demo</p>
<h3 id="鼠标拖动元素案例"><a href="#鼠标拖动元素案例" class="headerlink" title="鼠标拖动元素案例"></a>鼠标拖动元素案例</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;root&quot;&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;box&quot; v-move&gt;</span><br><span class="line">      &lt;div class&#x3D;&quot;header&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line">import &#123; Directive &#125; from &#39;vue&#39;</span><br><span class="line"></span><br><span class="line">const vMove:Directive&lt;HTMLElement&gt; &#x3D; (el)&#x3D;&gt;&#123;</span><br><span class="line">  let moveEl:HTMLElement &#x3D; el.querySelector(&quot;.header&quot;)</span><br><span class="line"></span><br><span class="line">  const mousedown &#x3D; (e:MouseEvent)&#x3D;&gt; &#123;</span><br><span class="line">    &#x2F;&#x2F; 鼠标按下时获取当前鼠标的位置和移动物体相对于浏览器的位置</span><br><span class="line">    let X &#x3D; e.x - el.offsetLeft</span><br><span class="line">    let Y &#x3D; e.y - el.offsetTop</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; 移动</span><br><span class="line">    const move &#x3D; (e:MouseEvent)&#x3D;&gt;&#123;</span><br><span class="line">      &#x2F;&#x2F; 在移动物体时，需要减去偏移量</span><br><span class="line">      el.style.left &#x3D; e.clientX - X + &quot;px&quot;</span><br><span class="line">      el.style.top &#x3D; e.clientY - Y + &quot;px&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    document.addEventListener(&quot;mousemove&quot;, move)</span><br><span class="line">    document.addEventListener(&quot;mouseup&quot;, ()&#x3D;&gt;&#123;</span><br><span class="line">      document.removeEventListener(&quot;mousemove&quot;, move)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  &#x2F;&#x2F; 鼠标按下头部时触发</span><br><span class="line">  moveEl.addEventListener(&quot;mousedown&quot;,mousedown)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang&#x3D;&quot;scss&quot;&gt;</span><br><span class="line">.root&#123;</span><br><span class="line">  position: relative;</span><br><span class="line">&#125;</span><br><span class="line">.box&#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  width: 200px;</span><br><span class="line">  height: 200px;</span><br><span class="line">  left: 100px;</span><br><span class="line">  top: 100px;</span><br><span class="line">  border: 2px solid black;</span><br><span class="line">  .header&#123;</span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 20px;</span><br><span class="line">    background-color: black;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/move.gif"></p>
<h3 id="图片懒加载案例"><a href="#图片懒加载案例" class="headerlink" title="图片懒加载案例"></a>图片懒加载案例</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;root&quot;&gt;</span><br><span class="line">    &lt;img v-for&#x3D;&quot;item in arr&quot; v-lazy&#x3D;&quot;item&quot; style&#x3D;&quot;width: 100%;&quot;&#x2F;&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line">import &#123; Directive,DirectiveBinding &#125; from &#39;vue&#39;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; import.meta.glob 引入目标路径中的所有文件，返回一个对象，默认使用module引入</span><br><span class="line">&#x2F;&#x2F; 添加了eager: true，则变成同步引入</span><br><span class="line">let imgList &#x3D; import.meta.glob(&quot;..&#x2F;assets&#x2F;images&#x2F;*.*&quot;,&#123;eager: true&#125;)</span><br><span class="line">&#x2F;&#x2F; 得到所有图片地址</span><br><span class="line">let arr &#x3D; Object.values(imgList).map(item&#x3D;&gt;item.default)</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 自定义懒加载指令</span><br><span class="line">const vLazy:Directive &#x3D; async (el:HTMLImageElement,binding:DirectiveBinding)&#x3D;&gt;&#123;</span><br><span class="line">  &#x2F;&#x2F; 先给一个默认值</span><br><span class="line">  const def &#x3D; await import(&quot;..&#x2F;assets&#x2F;logo.svg&quot;)</span><br><span class="line">  el.src &#x3D; def.default</span><br><span class="line">  &#x2F;&#x2F; 判断元素是否在可视范围内</span><br><span class="line">  const  intersection &#x3D; new IntersectionObserver((e)&#x3D;&gt;&#123;</span><br><span class="line">    &#x2F;&#x2F; 判断是否在可视范围内</span><br><span class="line">    if(e[0].intersectionRatio &gt; 0)&#123;</span><br><span class="line">      setTimeout(()&#x3D;&gt;&#123;</span><br><span class="line">        el.src &#x3D; binding.value</span><br><span class="line">      &#125;,500)</span><br><span class="line">      intersection.unobserve(el)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  intersection.observe(el)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang&#x3D;&quot;scss&quot;&gt;</span><br><span class="line">.root&#123;</span><br><span class="line">  width: 361px;</span><br><span class="line">  height: 800px;</span><br><span class="line">  overflow: auto;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<h2 id="自定义Hook"><a href="#自定义Hook" class="headerlink" title="自定义Hook"></a>自定义Hook</h2><h3 id="好用的第三方库"><a href="#好用的第三方库" class="headerlink" title="好用的第三方库"></a>好用的第三方库</h3><p><code>vueuse</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i @vueuse/core</span><br></pre></td></tr></table></figure>

<p>网址：<a target="_blank" rel="noopener" href="https://vueuse.org/">Get Started | VueUse — 开始使用 |Vueuse</a></p>
<h3 id="图片转base64"><a href="#图片转base64" class="headerlink" title="图片转base64"></a>图片转base64</h3><p>新建 <code>useImgToBase64.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;onMounted&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> optionsType = &#123;</span><br><span class="line">    el:<span class="built_in">String</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> (<span class="params">options:optionsType</span>):<span class="title">Promise</span>&lt;<span class="title">string</span>&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span>&#123;</span><br><span class="line">        onMounted(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">let</span> img:HTMLImageElement = <span class="built_in">document</span>.querySelector(options.el)</span><br><span class="line">            img.onload = <span class="function">()=&gt;</span>&#123;</span><br><span class="line">                resolve(toBase64(img))</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">const</span> toBase64 = <span class="function">(<span class="params">img:HTMLImageElement</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">let</span> canvas:HTMLCanvasElement = <span class="built_in">document</span>.createElement(<span class="string">&#x27;canvas&#x27;</span>)</span><br><span class="line">                <span class="keyword">let</span> ctx:CanvasRenderingContext2D = canvas.getContext(<span class="string">&#x27;2d&#x27;</span>)</span><br><span class="line">                canvas.width = img.width</span><br><span class="line">                canvas.height = img.height</span><br><span class="line">                ctx.drawImage(img, <span class="number">0</span>, <span class="number">0</span>, canvas.width, canvas.height)</span><br><span class="line">                <span class="keyword">return</span> canvas.toDataURL(<span class="string">&quot;image/jpeg&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;img src&#x3D;&quot;..&#x2F;assets&#x2F;images&#x2F;1.jpeg&quot;&#x2F;&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line">import useImgToBase64 from &quot;@&#x2F;utils&#x2F;useImgToBase64&quot;;</span><br><span class="line"></span><br><span class="line">useImgToBase64(&#123;el:&quot;img&quot;&#125;).then(res&#x3D;&gt;&#123;</span><br><span class="line">  console.log(res)</span><br><span class="line">&#125;)</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230924222116173.png" alt="image-20230924222116173"></p>
<h2 id="自定义Vite库并发布到NPM"><a href="#自定义Vite库并发布到NPM" class="headerlink" title="自定义Vite库并发布到NPM"></a>自定义Vite库并发布到NPM</h2><h3 id="封装useResize"><a href="#封装useResize" class="headerlink" title="封装useResize"></a>封装useResize</h3><p>用于监听绑定元素的宽高变化，当元素宽高发生变化时触发回调并获取最新的宽高</p>
<h4 id="新建项目"><a href="#新建项目" class="headerlink" title="新建项目"></a>新建项目</h4><p>结合上面学到的 Hook 和 自定义指令封装一个监听元素宽高变化的指令，并发布到 npm</p>
<p>项目结构</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">useResize            </span><br><span class="line">├── src              </span><br><span class="line">│   └── index.ts     </span><br><span class="line">├── README.md        </span><br><span class="line">├── index.d.ts       </span><br><span class="line">├── package-lock.json</span><br><span class="line">├── package.json     </span><br><span class="line">├── tsconfig.json    </span><br><span class="line">└── vite.config.ts</span><br></pre></td></tr></table></figure>

<p><code>src/index.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123;App&#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 自定义Hook</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="variable">el</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="variable">callback</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> weakMap = <span class="keyword">new</span> <span class="built_in">WeakMap</span>&lt;HTMLElement, <span class="built_in">Function</span>&gt;();</span><br><span class="line"><span class="keyword">const</span> resizeObserver = <span class="keyword">new</span> ResizeObserver(<span class="function">(<span class="params">entries</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> entry <span class="keyword">of</span> entries) &#123;</span><br><span class="line">        <span class="keyword">const</span> handle = weakMap.get(entry.target <span class="keyword">as</span> HTMLElement);</span><br><span class="line">        handle &amp;&amp; handle(entry)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">useResize</span>(<span class="params">el: HTMLElement, callback: <span class="built_in">Function</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (weakMap.get(el)) &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    weakMap.set(el, callback)</span><br><span class="line">    resizeObserver.observe(el)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 定义vite插件时，vue会在底层调用插件的install方法</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="variable">app</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">install</span>(<span class="params">app: App</span>) </span>&#123;</span><br><span class="line">    app.directive(<span class="string">&#x27;resize&#x27;</span>, &#123;</span><br><span class="line">        <span class="function"><span class="title">mounted</span>(<span class="params">el: HTMLElement, binding: &#123; value: <span class="built_in">Function</span> &#125;</span>)</span> &#123;</span><br><span class="line">            useResize(el, binding.value)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">useResize.install = install</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> useResize</span><br></pre></td></tr></table></figure>

<p><code>vite.config.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;defineConfig&#125; <span class="keyword">from</span> <span class="string">&quot;vite&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> defineConfig(&#123;</span><br><span class="line">    build:&#123;</span><br><span class="line">        lib:&#123;</span><br><span class="line">            <span class="comment">// 打包入口文件</span></span><br><span class="line">            entry:<span class="string">&quot;src/index.ts&quot;</span>,</span><br><span class="line">            <span class="comment">// name</span></span><br><span class="line">            name:<span class="string">&quot;useResize&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        rollupOptions:&#123;</span><br><span class="line">            <span class="comment">// 忽略打包的文件</span></span><br><span class="line">            external:[<span class="string">&#x27;vue&#x27;</span>],</span><br><span class="line">            output:&#123;</span><br><span class="line">                globals:&#123;</span><br><span class="line">                    useResize:<span class="string">&quot;useResize&quot;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><code>index.d.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> <span class="keyword">const</span> useResize:&#123;</span><br><span class="line">    (element:HTMLElement, <span class="attr">callback</span>:<span class="built_in">Function</span>):<span class="built_in">void</span></span><br><span class="line">    install:<span class="function">(<span class="params">app:<span class="built_in">any</span></span>) =&gt;</span> <span class="built_in">void</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> useResize</span><br></pre></td></tr></table></figure>

<p><code>package.json</code></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;v-resize-songzx&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;version&quot;</span>: <span class="string">&quot;1.0.0&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;main&quot;</span>: <span class="string">&quot;dist/v-resize-songzx.umd.js&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;module&quot;</span>: <span class="string">&quot;dist/v-resize-songzx.mjs&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;test&quot;</span>: <span class="string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;build&quot;</span>: <span class="string">&quot;vite build&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;keywords&quot;</span>: [],</span><br><span class="line">  <span class="attr">&quot;author&quot;</span>: <span class="string">&quot;songzx&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;files&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;dist&quot;</span>,</span><br><span class="line">    <span class="string">&quot;index.d.ts&quot;</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">&quot;license&quot;</span>: <span class="string">&quot;ISC&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;devDependencies&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;vue&quot;</span>: <span class="string">&quot;^3.3.4&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;dependencies&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;vite&quot;</span>: <span class="string">&quot;^4.4.9&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>pachage.json</code> 文件属性说明：</p>
<ul>
<li>name：对应打包后生成的包名，也就是上传到npm上面的包名，不能包含数字和特殊符号</li>
<li>version：包的版本号</li>
<li>main：对应打包后的 umd.js 文件，在使用 app.use 时会访问使用文件</li>
<li>module：使用import、require等方式引入时会使用 mjs 文件</li>
<li>files：指定那些文件需要上传</li>
</ul>
<h4 id="打包"><a href="#打包" class="headerlink" title="打包"></a>打包</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build</span><br></pre></td></tr></table></figure>

<h4 id="登录npm"><a href="#登录npm" class="headerlink" title="登录npm"></a>登录npm</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm login</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230924231941434.png" alt="image-20230924231941434"></p>
<h4 id="发布"><a href="#发布" class="headerlink" title="发布"></a>发布</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm publish</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230924232715692.png" alt="image-20230924232715692"></p>
<p>打开 <a target="_blank" rel="noopener" href="https://www.npmjs.com/">npm 网站</a>，搜索查看是否发布成功</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230925090849623.png" alt="image-20230925090849623"></p>
<h3 id="使用自己的库"><a href="#使用自己的库" class="headerlink" title="使用自己的库"></a>使用自己的库</h3><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i v-resize-songzx</span><br></pre></td></tr></table></figure>

<h4 id="使用方式一"><a href="#使用方式一" class="headerlink" title="使用方式一"></a>使用方式一</h4><p>全局注册 v-resze 指令</p>
<p><code>main.ts</code> 引入</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> useResize <span class="keyword">from</span> <span class="string">&quot;v-resize-songzx&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = createApp(App)</span><br><span class="line"></span><br><span class="line">app.use(useResize)</span><br><span class="line">app.mount(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;resize&quot; v-resize&#x3D;&quot;getNewWH&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line">const getNewWH &#x3D; (e) &#x3D;&gt; &#123;</span><br><span class="line">  console.log(e.contentRect.width, e.contentRect.height);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">&#x2F;*把一个元素设置成可以改变宽高的样子*&#x2F;</span><br><span class="line">.resize &#123;</span><br><span class="line">  resize: both;</span><br><span class="line">  width: 200px;</span><br><span class="line">  height: 200px;</span><br><span class="line">  border: 1px solid;</span><br><span class="line">  overflow: hidden;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="使用方式二"><a href="#使用方式二" class="headerlink" title="使用方式二"></a>使用方式二</h4><p>使用Hook的方式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;resize&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line"></span><br><span class="line">import useResize from &quot;v-resize-songzx&quot;;</span><br><span class="line"></span><br><span class="line">onMounted(() &#x3D;&gt; &#123;</span><br><span class="line">  useResize(document.querySelector(&quot;.resize&quot;), e &#x3D;&gt; &#123;</span><br><span class="line">    console.log(e.contentRect.width, e.contentRect.height);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">&#x2F;*把一个元素设置成可以改变宽高的样子*&#x2F;</span><br><span class="line">.resize &#123;</span><br><span class="line">  resize: both;</span><br><span class="line">  width: 200px;</span><br><span class="line">  height: 200px;</span><br><span class="line">  border: 1px solid;</span><br><span class="line">  overflow: hidden;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<h2 id="定义全局变量和方法"><a href="#定义全局变量和方法" class="headerlink" title="定义全局变量和方法"></a>定义全局变量和方法</h2><p>在 <code>main.ts</code> 中添加</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> dayjs <span class="keyword">from</span> <span class="string">&quot;dayjs&quot;</span></span><br><span class="line"><span class="keyword">import</span> mitt <span class="keyword">from</span> <span class="string">&quot;mitt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Mitt = mitt()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义全局变量</span></span><br><span class="line">app.config.globalProperties.$bus = Mitt</span><br><span class="line">app.config.globalProperties.$BaseUrl = <span class="string">&#x27;http://localhost&#x27;</span></span><br><span class="line">app.config.globalProperties.$formatDate = <span class="function">(<span class="params">date: <span class="built_in">Date</span></span>) =&gt;</span> dayjs(date).format(<span class="string">&#x27;YYYY-MM-DD HH:mm:ss&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义声明文件</span></span><br><span class="line"><span class="keyword">declare</span> <span class="built_in">module</span> <span class="string">&#x27;vue&#x27;</span> &#123;</span><br><span class="line">    <span class="keyword">export</span> <span class="keyword">interface</span> ComponentCustomProperties &#123;</span><br><span class="line">        $bus: <span class="keyword">typeof</span> Mitt,</span><br><span class="line">        $BaseUrl: <span class="built_in">string</span>,</span><br><span class="line">        $formatDate: <span class="built_in">Date</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在任何组件中都可以使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &#123;&#123; $BaseUrl &#125;&#125;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line">import &#123;getCurrentInstance&#125; from &#39;vue&#39;</span><br><span class="line">&#x2F;&#x2F; 获取当前实例</span><br><span class="line">const instance &#x3D; getCurrentInstance()</span><br><span class="line"></span><br><span class="line">console.log(instance.proxy.$BaseUrl) &#x2F;&#x2F;&#x3D;&gt; http:&#x2F;&#x2F;localhost</span><br><span class="line">console.log(instance.proxy.$formatDate(new Date())) &#x2F;&#x2F;&#x3D;&gt; 2023-09-25 13:51:23</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="自定义插件之全局Loading"><a href="#自定义插件之全局Loading" class="headerlink" title="自定义插件之全局Loading"></a>自定义插件之全局Loading</h2><h3 id="ElementPlus的默认全局Loading"><a href="#ElementPlus的默认全局Loading" class="headerlink" title="ElementPlus的默认全局Loading"></a>ElementPlus的默认全局Loading</h3><p>如果完整引入了 Element Plus，那么 <code>app.config.globalProperties</code> 上会有一个全局方法<code>$loading</code>，同样会返回一个 Loading 实例。</p>
<table>
<thead>
<tr>
<th align="left">名称</th>
<th align="left">说明</th>
<th align="left">类型</th>
<th align="left">默认</th>
</tr>
</thead>
<tbody><tr>
<td align="left">target</td>
<td align="left">Loading 需要覆盖的 DOM 节点。 可传入一个 DOM 对象或字符串； 若传入字符串，则会将其作为参数传入 <code>document.querySelector</code>以获取到对应 DOM 节点</td>
<td align="left"><code>string</code> / <code>HTMLElement</code></td>
<td align="left">document.body</td>
</tr>
<tr>
<td align="left">body</td>
<td align="left">同 <code>v-loading</code> 指令中的 <code>body</code> 修饰符</td>
<td align="left"><code>boolean</code></td>
<td align="left">false</td>
</tr>
<tr>
<td align="left">fullscreen</td>
<td align="left">同 <code>v-loading</code> 指令中的 <code>fullscreen</code> 修饰符</td>
<td align="left"><code>boolean</code></td>
<td align="left">true</td>
</tr>
<tr>
<td align="left">lock</td>
<td align="left">同 <code>v-loading</code> 指令中的 <code>lock</code> 修饰符</td>
<td align="left"><code>boolean</code></td>
<td align="left">false</td>
</tr>
<tr>
<td align="left">text</td>
<td align="left">显示在加载图标下方的加载文案</td>
<td align="left"><code>string</code></td>
<td align="left">—</td>
</tr>
<tr>
<td align="left">spinner</td>
<td align="left">自定义加载图标类名</td>
<td align="left"><code>string</code></td>
<td align="left">—</td>
</tr>
<tr>
<td align="left">background</td>
<td align="left">遮罩背景色</td>
<td align="left"><code>string</code></td>
<td align="left">—</td>
</tr>
<tr>
<td align="left">customClass</td>
<td align="left">Loading 的自定义类名</td>
<td align="left"><code>string</code></td>
<td align="left">—</td>
</tr>
</tbody></table>
<h4 id="指令的方式使用"><a href="#指令的方式使用" class="headerlink" title="指令的方式使用"></a>指令的方式使用</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">   &lt;div class&#x3D;&quot;box&quot; v-loading&#x3D;&quot;isLoading&quot;&gt;</span><br><span class="line">      content</span><br><span class="line">   &lt;&#x2F;div&gt;</span><br><span class="line">   &lt;el-button type&#x3D;&quot;primary&quot; @click&#x3D;&quot;showDivLoading&quot;&gt;显示loading&lt;&#x2F;el-button&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line">&#x2F;&#x2F; 显示局部loading</span><br><span class="line">let isLoading &#x3D; ref(false)</span><br><span class="line"></span><br><span class="line">const showDivLoading &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">  isLoading.value &#x3D; !isLoading.value</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.box &#123;</span><br><span class="line">  width: 200px;</span><br><span class="line">  height: 200px;</span><br><span class="line">  border: 1px solid;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="函数式调用"><a href="#函数式调用" class="headerlink" title="函数式调用"></a>函数式调用</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;el-button type&#x3D;&quot;primary&quot; @click&#x3D;&quot;showLoading&quot;&gt;showLoading&lt;&#x2F;el-button&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line">import &#123;getCurrentInstance&#125; from &#39;vue&#39;</span><br><span class="line">&#x2F;&#x2F; 获取当前实例</span><br><span class="line">const &#123;proxy&#125; &#x3D; getCurrentInstance()</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 显示全局loading</span><br><span class="line">const showLoading &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">  const loading &#x3D; proxy.$loading()</span><br><span class="line">  setTimeout(() &#x3D;&gt; &#123;</span><br><span class="line">    loading.close()</span><br><span class="line">  &#125;, 2000)</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="自定义全局Loading"><a href="#自定义全局Loading" class="headerlink" title="自定义全局Loading"></a>自定义全局Loading</h3><p>我们自己动手来实现一个和ElementPlus的Loading，同时支持函数调用和指令调用</p>
<h4 id="添加MyLoading-vue"><a href="#添加MyLoading-vue" class="headerlink" title="添加MyLoading.vue"></a>添加MyLoading.vue</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;transition enter-active-class&#x3D;&quot;animate__animated animate__fadeIn&quot;</span><br><span class="line">              leave-active-class&#x3D;&quot;animate__animated animate__fadeOut&quot;&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;root-box&quot; v-if&#x3D;&quot;show&quot;&gt;</span><br><span class="line">      &lt;div class&#x3D;&quot;wrap&quot;&gt;</span><br><span class="line">        &lt;img src&#x3D;&quot;..&#x2F;assets&#x2F;images&#x2F;loading.gif&quot;&#x2F;&gt;</span><br><span class="line">      &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">  &lt;&#x2F;transition&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">let show &#x3D; ref(false)</span><br><span class="line"></span><br><span class="line">const showLoading &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">  show.value &#x3D; true</span><br><span class="line">&#125;</span><br><span class="line">const hideLoading &#x3D; (callback) &#x3D;&gt; &#123;</span><br><span class="line">  show.value &#x3D; false</span><br><span class="line">  callback &amp;&amp; setTimeout(() &#x3D;&gt; callback(), 500)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">defineExpose(&#123;</span><br><span class="line">  show,</span><br><span class="line">  showLoading,</span><br><span class="line">  hideLoading</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang&#x3D;&quot;scss&quot;&gt;</span><br><span class="line">.animate__animated.animate__fadeIn &#123;</span><br><span class="line">  --animate-duration: 0.5s;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.animate__animated.animate__fadeOut &#123;</span><br><span class="line">  --animate-duration: 0.5s;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.root-box &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  left: 0;</span><br><span class="line">  top: 0;</span><br><span class="line">  bottom: 0;</span><br><span class="line">  right: 0;</span><br><span class="line">  margin: 0;</span><br><span class="line">  background-color: rgba(255, 255, 255, 0.9);</span><br><span class="line">  z-index: 2000;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: center;</span><br><span class="line">  align-items: center;</span><br><span class="line"></span><br><span class="line">  .wrap &#123;</span><br><span class="line">    width: 100px;</span><br><span class="line">    height: 100px;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    align-items: center;</span><br><span class="line">    overflow: hidden;</span><br><span class="line"></span><br><span class="line">    img &#123;</span><br><span class="line">      width: 100%;</span><br><span class="line">      transform: scale(2.5);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="添加MyLoading-ts"><a href="#添加MyLoading-ts" class="headerlink" title="添加MyLoading.ts"></a>添加MyLoading.ts</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123;App, VNode,&#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span></span><br><span class="line"><span class="keyword">import</span> &#123;createVNode, render, cloneVNode&#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span></span><br><span class="line"><span class="keyword">import</span> MyLoading <span class="keyword">from</span> <span class="string">&quot;@/components/MyLoading.vue&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="function"><span class="title">install</span>(<span class="params">app: App</span>)</span> &#123;</span><br><span class="line">        <span class="comment">// 使用vue底层的createVNode方法将组件渲染为虚拟节点</span></span><br><span class="line">        <span class="keyword">const</span> VNode: VNode = createVNode(MyLoading)</span><br><span class="line">        <span class="comment">// 使用render函数将组件挂载到body中</span></span><br><span class="line">        render(VNode, <span class="built_in">document</span>.body)</span><br><span class="line">        <span class="comment">// 定义全局方法设置组件的显示和隐藏</span></span><br><span class="line">        app.config.globalProperties.$showLoading = VNode.component?.exposed.showLoading</span><br><span class="line">        app.config.globalProperties.$hideLoading = VNode.component?.exposed.hideLoading</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> weakMap = <span class="keyword">new</span> <span class="built_in">WeakMap</span>()</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 自定义Loading指令</span></span><br><span class="line">        app.directive(<span class="string">&quot;zx-loading&quot;</span>, &#123;</span><br><span class="line">            <span class="function"><span class="title">mounted</span>(<span class="params">el</span>)</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (weakMap.get(el)) <span class="keyword">return</span></span><br><span class="line">                <span class="comment">//  记录当前绑定元素的position</span></span><br><span class="line">                weakMap.set(el, <span class="built_in">window</span>.getComputedStyle(el).position)</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="function"><span class="title">updated</span>(<span class="params">el: HTMLElement, binding: &#123; value: <span class="built_in">Boolean</span> &#125;</span>)</span> &#123;</span><br><span class="line">                <span class="keyword">const</span> oldPosition = weakMap.get(el);</span><br><span class="line">                <span class="comment">// 如果不是position: relative或者absolute，就设置为relative</span></span><br><span class="line">                <span class="comment">// 这里的目的是确保loading组件正确覆盖当前绑定的元素</span></span><br><span class="line">                <span class="keyword">if</span> (oldPosition !== <span class="string">&#x27;absolute&#x27;</span> &amp;&amp; oldPosition !== <span class="string">&#x27;relative&#x27;</span>) &#123;</span><br><span class="line">                    el.style.position = <span class="string">&#x27;relative&#x27;</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 克隆一份loading元素,</span></span><br><span class="line">                <span class="comment">// 作用是当页面上有多个zx-loading时，每个dom都维护一份属于自己的loading，不会冲突</span></span><br><span class="line">                <span class="keyword">const</span> newVNode = cloneVNode(VNode)</span><br><span class="line">                <span class="comment">// 挂载当前节点</span></span><br><span class="line">                render(newVNode, el)</span><br><span class="line">                <span class="comment">// 判断绑定的值</span></span><br><span class="line">                <span class="keyword">if</span> (binding.value) &#123;</span><br><span class="line">                    newVNode.component?.exposed.showLoading()</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    newVNode.component?.exposed.hideLoading(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                        <span class="comment">// 还原布局方式</span></span><br><span class="line">                        el.style.position = oldPosition</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在上面的文件中定义了两个全局函数和一个自定义指令</p>
<ul>
<li>$showLoading：全局显示一个Loading</li>
<li>$hideLoading：关闭全局的Loading</li>
<li>zx-loading：自定义指令</li>
</ul>
<h4 id="在main-ts中挂载"><a href="#在main-ts中挂载" class="headerlink" title="在main.ts中挂载"></a>在main.ts中挂载</h4><p>在 <code>main.ts</code> 中去挂载我们自定义的 Loading</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createApp&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> MyLoading <span class="keyword">from</span> <span class="string">&quot;@/utils/MyLoading&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = createApp(App)</span><br><span class="line"><span class="comment">// 引入自定义的全局Loading</span></span><br><span class="line">app.use(MyLoading)</span><br><span class="line"></span><br><span class="line">app.mount(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="使用方法一：函数式使用"><a href="#使用方法一：函数式使用" class="headerlink" title="使用方法一：函数式使用"></a>使用方法一：函数式使用</h4><p>调用全局方法弹出Loading</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;!--自定义全局loading--&gt;</span><br><span class="line">    &lt;el-button type&#x3D;&quot;primary&quot; @click&#x3D;&quot;showMyLoading&quot;&gt;显示自定义的全局loading&lt;&#x2F;el-button&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line">import &#123;getCurrentInstance&#125; from &#39;vue&#39;</span><br><span class="line">&#x2F;&#x2F; 获取当前实例</span><br><span class="line">const &#123;proxy&#125; &#x3D; getCurrentInstance()</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 全局显示自定义loading</span><br><span class="line">const showMyLoading &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">  proxy.$showLoading()</span><br><span class="line">  setTimeout(() &#x3D;&gt; &#123;</span><br><span class="line">    proxy.$hideLoading()</span><br><span class="line">  &#125;, 2000)</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230925171920861.png" alt="image-20230925171920861"></p>
<h4 id="使用方法二：指令式使用"><a href="#使用方法二：指令式使用" class="headerlink" title="使用方法二：指令式使用"></a>使用方法二：指令式使用</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;!--自定义的loading指令使用--&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;box&quot; v-zx-loading&#x3D;&quot;isLoading&quot;&gt;</span><br><span class="line">      指令的方式使用</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;el-button type&#x3D;&quot;primary&quot; @click&#x3D;&quot;showDivLoading&quot;&gt;显示loading&lt;&#x2F;el-button&gt;</span><br><span class="line"></span><br><span class="line">	&lt;!--自定义的loading指令使用--&gt;      </span><br><span class="line">    &lt;div class&#x3D;&quot;parent&quot;&gt;</span><br><span class="line">      &lt;div class&#x3D;&quot;child&quot; v-zx-loading&#x3D;&quot;childLoading&quot;&gt;</span><br><span class="line">      &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;el-button type&#x3D;&quot;primary&quot; @click&#x3D;&quot;showChildLoading&quot;&gt;显示childLoading&lt;&#x2F;el-button&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line">&#x2F;&#x2F; 显示局部loading</span><br><span class="line">let isLoading &#x3D; ref(false)</span><br><span class="line">const showDivLoading &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">  isLoading.value &#x3D; !isLoading.value</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const childLoading &#x3D; ref(false)</span><br><span class="line">const showChildLoading &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">  childLoading.value &#x3D; !childLoading.value</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang&#x3D;&quot;scss&quot;&gt;</span><br><span class="line">.box &#123;</span><br><span class="line">  width: 200px;</span><br><span class="line">  height: 200px;</span><br><span class="line">  border: 1px solid;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.parent &#123;</span><br><span class="line">  position: relative;</span><br><span class="line">  width: 300px;</span><br><span class="line">  height: 300px;</span><br><span class="line">  border: 1px solid;</span><br><span class="line">  padding: 30px;</span><br><span class="line"></span><br><span class="line">  .child &#123;</span><br><span class="line">    position: absolute;</span><br><span class="line">    right: 30px;</span><br><span class="line">    bottom: 30px;</span><br><span class="line">    width: 200px;</span><br><span class="line">    height: 200px;</span><br><span class="line">    border: 1px solid;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230925172100385.png" alt="image-20230925172100385"></p>
<h3 id="use函数源码实现"><a href="#use函数源码实现" class="headerlink" title="use函数源码实现"></a>use函数源码实现</h3><p>添加 <code>MyUse.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123;App&#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span></span><br><span class="line"><span class="keyword">import</span> &#123;app&#125; <span class="keyword">from</span> <span class="string">&quot;@/main&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个接口，声明install方法必传</span></span><br><span class="line"><span class="keyword">interface</span> Use &#123;</span><br><span class="line">    install: <span class="function">(<span class="params">app: App, ...options: <span class="built_in">any</span>[]</span>) =&gt;</span> <span class="built_in">void</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> installList = <span class="keyword">new</span> <span class="built_in">Set</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">myUse</span>&lt;<span class="title">T</span> <span class="title">extends</span> <span class="title">Use</span>&gt;(<span class="params">plugin: T, ...options: <span class="built_in">any</span>[]</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 判断这个插件是否已经注册过了，如果注册过了则报错</span></span><br><span class="line">    <span class="keyword">if</span> (installList.has(plugin)) &#123;</span><br><span class="line">        <span class="built_in">console</span>.error(<span class="string">&quot;Plugin already installed&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 调用插件身上的install方法，并传入main.ts导出的app</span></span><br><span class="line">    plugin.install(app, ...options)</span><br><span class="line">    installList.add(plugin)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用自定义的myUse方法注册我们自定义的Loading</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createApp&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 自定义全局Loading</span></span><br><span class="line"><span class="keyword">import</span> MyLoading <span class="keyword">from</span> <span class="string">&quot;@/utils/MyLoading&quot;</span>;</span><br><span class="line"><span class="comment">// 自定义app.use方法</span></span><br><span class="line"><span class="keyword">import</span> myUse <span class="keyword">from</span> <span class="string">&quot;@/utils/MyUse&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> app = createApp(App)</span><br><span class="line"><span class="comment">// 引入自定义的全局Loading</span></span><br><span class="line">myUse(MyLoading)</span><br><span class="line"></span><br><span class="line">app.mount(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="CSS选择器"><a href="#CSS选择器" class="headerlink" title="CSS选择器"></a>CSS选择器</h2><h3 id="deep"><a href="#deep" class="headerlink" title=":deep"></a>:deep</h3><p>使用 :deep() 将选择器包裹起来可以将第三方库的样式进行修改</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;el-input placeholder&#x3D;&quot;placeholder&quot; v-model&#x3D;&quot;name&quot;&#x2F;&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">let name &#x3D; ref(&quot;&quot;)</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang&#x3D;&quot;scss&quot;&gt;</span><br><span class="line">.el-input&#123;</span><br><span class="line">  :deep(.el-input__inner) &#123;</span><br><span class="line">    background-color: red;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230925223153879.png" alt="image-20230925223153879"></p>
<h3 id="slotted"><a href="#slotted" class="headerlink" title=":slotted"></a>:slotted</h3><p>使用 :slotted() 将插槽中的类名包裹起来，可以修改插槽中的元素样式</p>
<p><code>SlotTestCom.vue</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    父组件</span><br><span class="line">    &lt;slot&gt;&lt;&#x2F;slot&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">:slotted(.msg) &#123;</span><br><span class="line">  font-weight: bold;</span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;SlotTestCom&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;msg&quot;&gt;私人订制DIV&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;SlotTestCom&gt;</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230927103314117.png" alt="image-20230927103314117"></p>
<h3 id="global"><a href="#global" class="headerlink" title=":global"></a>:global</h3><p>使用 :global() 用于设置全局样式</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">:<span class="built_in">global</span>(div)&#123;</span><br><span class="line">  font-size: <span class="number">17px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#222222</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>全局设置div的样式</p>
<h3 id="css中使用v-bind"><a href="#css中使用v-bind" class="headerlink" title="css中使用v-bind"></a>css中使用v-bind</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> color = ref(<span class="string">&quot;pink&quot;</span>)</span><br><span class="line"><span class="comment">// 随机一个颜色</span></span><br><span class="line"><span class="keyword">const</span> randomColor = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  color.value = <span class="string">`rgb(<span class="subst">$&#123;<span class="built_in">Math</span>.random() * <span class="number">255</span>&#125;</span>,<span class="subst">$&#123;<span class="built_in">Math</span>.random() * <span class="number">255</span>&#125;</span>,<span class="subst">$&#123;<span class="built_in">Math</span>.random() * <span class="number">255</span>&#125;</span>)`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用 v-bind() 将JS中变量包裹起来即可使用</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.el-input</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line"></span><br><span class="line">  :<span class="built_in">deep</span>(.el-input__inner) &#123;</span><br><span class="line">    background-color: <span class="built_in">v-bind</span>(color);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Vue3集成Tailwind-CSS"><a href="#Vue3集成Tailwind-CSS" class="headerlink" title="Vue3集成Tailwind CSS"></a>Vue3集成Tailwind CSS</h2><p>官网地址<a target="_blank" rel="noopener" href="https://www.tailwindcss.cn/">Tailwind CSS 中文文档 - 无需离开您的HTML，即可快速建立现代网站。</a></p>
<h3 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -D tailwindcss@latest postcss@latest autoprefixer@latest</span><br></pre></td></tr></table></figure>

<p>生成配置文件</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx tailwindcss init -p</span><br></pre></td></tr></table></figure>

<p>修改配置文件 tailwind.config.js</p>
<p>2.6版本</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  purge: [<span class="string">&#x27;./index.html&#x27;</span>, <span class="string">&#x27;./src/**/*.&#123;vue,js,ts,jsx,tsx&#125;&#x27;</span>],</span><br><span class="line">  theme: &#123;</span><br><span class="line">    extend: &#123;&#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3.0版本</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  content: [<span class="string">&#x27;./index.html&#x27;</span>, <span class="string">&#x27;./src/**/*.&#123;vue,js,ts,jsx,tsx&#125;&#x27;</span>],</span><br><span class="line">  theme: &#123;</span><br><span class="line">    extend: &#123;&#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>新建 index.css 并在 main.ts 中引入</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@tailwind</span> base;</span><br><span class="line"><span class="keyword">@tailwind</span> components;</span><br><span class="line"><span class="keyword">@tailwind</span> utilities;</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230927132455491.png" alt="image-20230927132455491"></p>
<h3 id="基础使用"><a href="#基础使用" class="headerlink" title="基础使用"></a>基础使用</h3><p>详细类名见文档：<a target="_blank" rel="noopener" href="https://www.tailwindcss.cn/docs/font-family">https://www.tailwindcss.cn/docs/font-family</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;h-full flex justify-center items-center bg-teal-400&quot;&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;text-8xl text-rose-700font-bold text-white&quot;&gt;Hello Word&lt;&#x2F;div&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230927132522243.png" alt="image-20230927132522243"></p>
<h2 id="nextTick"><a href="#nextTick" class="headerlink" title="nextTick"></a>nextTick</h2><blockquote>
<p>vue 中更新DOM操作是异步的，但是JS程序是同步的，所以当遇到操作DOM时可能会出现延迟更新的情况，vue 也给了一个解决方案，就是可以将操作 DOM 的代码放在 nextTick 中执行，nextTick 会执行一个 Promise 函数去更新DOM，来实现同步更新DOM的操作</p>
<p>这样做的好处是可以提高程序性能，例如执行一个for循环，每次循环会改变变量的值，然后吧这个变量输出到页面上。用一个watch去监听这个变量，watch函数并不会触发多次，而是只会执行一次</p>
</blockquote>
<p>下面是一个小案例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;box&quot; ref&#x3D;&quot;box&quot;&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;item&quot; v-for&#x3D;&quot;(item,index) in msgList&quot; :key&#x3D;&quot;index&quot;&gt;</span><br><span class="line">      &#123;&#123; item.msg &#125;&#125;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">  &lt;el-input v-model&#x3D;&quot;msg&quot; style&#x3D;&quot;width: 200px&quot;&#x2F;&gt;</span><br><span class="line">  &lt;el-button type&#x3D;&quot;primary&quot; @click&#x3D;&quot;send&quot;&gt;发送&lt;&#x2F;el-button&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;script setup lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line">import &#123;nextTick, ref, reactive&#125; from &#39;vue&#39;</span><br><span class="line"></span><br><span class="line">let msgList &#x3D; reactive([</span><br><span class="line">  &#123;</span><br><span class="line">    msg: &quot;Hello world&quot;</span><br><span class="line">  &#125;</span><br><span class="line">])</span><br><span class="line">let msg &#x3D; ref(&quot;&quot;)</span><br><span class="line">let box &#x3D; ref&lt;HTMLDivElement&gt;()</span><br><span class="line"></span><br><span class="line">const send &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">  msgList.push(&#123;msg: msg.value&#125;)</span><br><span class="line">  nextTick(() &#x3D;&gt; &#123;</span><br><span class="line">    &#x2F;&#x2F; 发送完消息后自动滚动到底部</span><br><span class="line">    box.value.scrollTop &#x3D; box.value.scrollHeight</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang&#x3D;&quot;scss&quot;&gt;</span><br><span class="line">.box &#123;</span><br><span class="line">  width: 300px;</span><br><span class="line">  border: 2px solid #ddd;</span><br><span class="line">  height: 400px;</span><br><span class="line">  overflow: auto;</span><br><span class="line"></span><br><span class="line">  .item &#123;</span><br><span class="line">    height: 30px;</span><br><span class="line">    line-height: 30px;</span><br><span class="line">    padding-left: 1em;</span><br><span class="line">    background-color: #dddddd;</span><br><span class="line">    margin: 2px;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<h2 id="Vue3开发安卓和IOS"><a href="#Vue3开发安卓和IOS" class="headerlink" title="Vue3开发安卓和IOS"></a>Vue3开发安卓和IOS</h2><p>参照博客：<a target="_blank" rel="noopener" href="https://xiaoman.blog.csdn.net/article/details/131507483">https://xiaoman.blog.csdn.net/article/details/131507483</a></p>
<h3 id="安装安卓开发工具"><a href="#安装安卓开发工具" class="headerlink" title="安装安卓开发工具"></a>安装安卓开发工具</h3><p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230927161024413.png" alt="image-20230927161024413"></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230927161057832.png" alt="image-20230927161057832"></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230927161139275.png" alt="image-20230927161139275"></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230927161213097.png" alt="image-20230927161213097"></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230927161303242.png" alt="image-20230927161303242"></p>
<p>安装完成后打开</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230927161352447.png" alt="image-20230927161352447"></p>
<p>首次运行需要安装一些SDK</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230927161623550.png" alt="image-20230927161623550"></p>
<h3 id="ionic安装"><a href="#ionic安装" class="headerlink" title="ionic安装"></a>ionic安装</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g @ionic/cli</span><br></pre></td></tr></table></figure>

<h3 id="初始化项目"><a href="#初始化项目" class="headerlink" title="初始化项目"></a>初始化项目</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ionic start app tabs --<span class="built_in">type</span> vue</span><br></pre></td></tr></table></figure>

<ul>
<li>app 项目名称</li>
<li>tabs 使用的预设</li>
<li>–type vue 使用的是vue就写vue，react就写react</li>
</ul>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230927163158065.png" alt="image-20230927163158065"></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230927165645993.png" alt="image-20230927165645993"></p>
<p>启动项目</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run dev</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230927165717819.png" alt="image-20230927165717819"></p>
<h3 id="打包和构建"><a href="#打包和构建" class="headerlink" title="打包和构建"></a>打包和构建</h3><p>先执行打包命令</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build</span><br></pre></td></tr></table></figure>

<p>再执行构建命令，将程序打包成Android包</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ionic capacitor copy android</span><br></pre></td></tr></table></figure>

<p>运行成功后会自动多一个android文件夹</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230927165845466.png" alt="image-20230927165845466"></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230927165905649.png" alt="image-20230927165905649"></p>
<p>然后运行下面命令进行预览</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ionic capacitor open android</span><br></pre></td></tr></table></figure>

<p>会自动打开安卓编辑器</p>
<p>等待项目加载完成后，点击绿色的箭头即可启动</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20230927171133698.png" alt="image-20230927171133698"></p>
<h2 id="H5适配"><a href="#H5适配" class="headerlink" title="H5适配"></a>H5适配</h2><h3 id="添加meat信息"><a href="#添加meat信息" class="headerlink" title="添加meat信息"></a>添加meat信息</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="清除默认样式"><a href="#清除默认样式" class="headerlink" title="清除默认样式"></a>清除默认样式</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">html</span>,<span class="selector-tag">body</span>,<span class="selector-id">#app</span>&#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line">  &#125;</span><br><span class="line">  *&#123;</span><br><span class="line"><span class="css">      <span class="attribute">padding</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="圣杯布局"><a href="#圣杯布局" class="headerlink" title="圣杯布局"></a>圣杯布局</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;header&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span>&gt;</span></span><br><span class="line">.header&#123;</span><br><span class="line"><span class="css">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">height</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">line-height</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">div</span><span class="selector-pseudo">:nth-child</span>(<span class="number">1</span>),<span class="selector-tag">div</span><span class="selector-pseudo">:nth-child</span>(<span class="number">3</span>)&#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">background-color</span>: deepskyblue;</span></span><br><span class="line">  &#125;</span><br><span class="line"><span class="css">  <span class="selector-tag">div</span><span class="selector-pseudo">:nth-child</span>(<span class="number">2</span>)&#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">flex</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">background-color</span>: pink;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20231007222439590.png" alt="image-20231007222439590" style="zoom: 50%;" />

<p>使用postCSS将px单位转成vh和vw</p>
<blockquote>
<p>百分比是相对于父元素</p>
<p>vw和vh相对于视口</p>
</blockquote>
<h3 id="编写postCSS插件"><a href="#编写postCSS插件" class="headerlink" title="编写postCSS插件"></a>编写postCSS插件</h3><p>新建 <code>plugins/PxToVwVh.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;Plugin&#125; <span class="keyword">from</span> <span class="string">&quot;postcss&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> Options = &#123;</span><br><span class="line">    defaultWidth: <span class="number">390</span>,</span><br><span class="line">    defaultHeight: <span class="number">844</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> OptionsTypes &#123;</span><br><span class="line">    defaultWidth?:<span class="built_in">number</span>,</span><br><span class="line">    defaultHeight?:<span class="built_in">number</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">PxToVwVh</span>(<span class="params">options:OptionsTypes=Options</span>):<span class="title">Plugin</span></span>&#123;</span><br><span class="line">    <span class="keyword">let</span> opt = <span class="built_in">Object</span>.assign(&#123;&#125;, options)</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        postcssPlugin:<span class="string">&quot;px-to-vw-vh&quot;</span>,</span><br><span class="line">        <span class="comment">// 钩子函数</span></span><br><span class="line">        <span class="function"><span class="title">Declaration</span>(<span class="params">node</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(node.value.includes(<span class="string">&quot;px&quot;</span>))&#123;</span><br><span class="line">                <span class="keyword">const</span> num = <span class="built_in">parseFloat</span>(node.value)</span><br><span class="line">                <span class="keyword">if</span>(node.prop.includes(<span class="string">&quot;width&quot;</span>))&#123;</span><br><span class="line">                    node.value = <span class="string">`<span class="subst">$&#123;((num / opt.defaultWidth) * <span class="number">100</span>).toFixed(<span class="number">2</span>)&#125;</span>vw`</span></span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>(node.prop.includes(<span class="string">&quot;height&quot;</span>))&#123;</span><br><span class="line">                    node.value = <span class="string">`<span class="subst">$&#123;((num / opt.defaultHeight) * <span class="number">100</span>).toFixed(<span class="number">2</span>)&#125;</span>vh`</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在 <code>tsconfig.node.json</code> 中引入</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;extends&quot;</span>: <span class="string">&quot;@tsconfig/node18/tsconfig.json&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;include&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;vite.config.*&quot;</span>,</span><br><span class="line">    <span class="string">&quot;vitest.config.*&quot;</span>,</span><br><span class="line">    <span class="string">&quot;cypress.config.*&quot;</span>,</span><br><span class="line">    <span class="string">&quot;nightwatch.conf.*&quot;</span>,</span><br><span class="line">    <span class="string">&quot;playwright.config.*&quot;</span>,</span><br><span class="line">    <span class="string">&quot;plugins/**/*&quot;</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">&quot;compilerOptions&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;composite&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">&quot;module&quot;</span>: <span class="string">&quot;ESNext&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;moduleResolution&quot;</span>: <span class="string">&quot;Bundler&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;types&quot;</span>: [<span class="string">&quot;node&quot;</span>],</span><br><span class="line">    <span class="attr">&quot;noImplicitAny&quot;</span>: <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>include中添加 <code>plugins/**/*</code></li>
<li>noImplicitAny 允许隐式的使用any</li>
</ul>
<h3 id="使用插件"><a href="#使用插件" class="headerlink" title="使用插件"></a>使用插件</h3><p>在 <code>vite.config.ts</code> 中使用</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; fileURLToPath, URL &#125; <span class="keyword">from</span> <span class="string">&#x27;node:url&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&#x27;vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> vue <span class="keyword">from</span> <span class="string">&#x27;@vitejs/plugin-vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;PxToVwVh&#125; <span class="keyword">from</span> <span class="string">&quot;./plugins/PxToVwVh&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// https://vitejs.dev/config/</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> defineConfig(&#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    vue(),</span><br><span class="line">  ],</span><br><span class="line">  css: &#123;</span><br><span class="line">    postcss: &#123;</span><br><span class="line">      plugins: [</span><br><span class="line">        PxToVwVh()</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  resolve: &#123;</span><br><span class="line">    alias: &#123;</span><br><span class="line">      <span class="string">&#x27;@&#x27;</span>: fileURLToPath(<span class="keyword">new</span> URL(<span class="string">&#x27;./src&#x27;</span>, <span class="keyword">import</span>.meta.url))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="效果展示"><a href="#效果展示" class="headerlink" title="效果展示"></a>效果展示</h3><p>我们通过编写插件，实现了将PX单位转换成相对于视口，这样保证了在不同尺寸的屏幕上都会有一个相同的展示布局</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20231007224908253.png" alt="image-20231007224908253"></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20231007224848623.png" alt="image-20231007224848623"></p>
<h3 id="全局控制字体大小"><a href="#全局控制字体大小" class="headerlink" title="全局控制字体大小"></a>全局控制字体大小</h3><p>设置全局CSS变量</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">:root</span>&#123;</span><br><span class="line">    --<span class="attribute">font-size</span>:<span class="number">16px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后全局可以通过 var(–font-size) 使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;header&quot;&gt;</span><br><span class="line">    &lt;div&gt;返回&lt;&#x2F;div&gt;</span><br><span class="line">    &lt;div&gt;H5适配&lt;&#x2F;div&gt;</span><br><span class="line">    &lt;div&gt;取消&lt;&#x2F;div&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line"></span><br><span class="line">  &lt;button @click&#x3D;&quot;changeFontSize(15)&quot;&gt;默认&lt;&#x2F;button&gt;</span><br><span class="line">  &lt;button @click&#x3D;&quot;changeFontSize(24)&quot;&gt;大&lt;&#x2F;button&gt;</span><br><span class="line">  &lt;button @click&#x3D;&quot;changeFontSize(36)&quot;&gt;特大&lt;&#x2F;button&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line"></span><br><span class="line">import &#123;onMounted&#125; from &quot;vue&quot;;</span><br><span class="line"></span><br><span class="line">onMounted(()&#x3D;&gt;&#123;</span><br><span class="line">  document.documentElement.style.setProperty(&quot;--font-size&quot;,localStorage.getItem(&quot;fontSize&quot;) || &quot;16px&quot;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">const changeFontSize &#x3D; (size) &#x3D;&gt; &#123;</span><br><span class="line">  document.documentElement.style.setProperty(&quot;--font-size&quot;,size + &#39;px&#39;)</span><br><span class="line">  localStorage.setItem(&quot;fontSize&quot;,size + &#39;px&#39;);</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang&#x3D;&quot;scss&quot;&gt;</span><br><span class="line">.header&#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 50px;</span><br><span class="line">  line-height: 50px;</span><br><span class="line">  display: flex;</span><br><span class="line">  text-align: center;</span><br><span class="line">  font-size: var(--font-size);</span><br><span class="line">  div:nth-child(1),div:nth-child(3)&#123;</span><br><span class="line">    width: 100px;</span><br><span class="line">    background-color: deepskyblue;</span><br><span class="line">  &#125;</span><br><span class="line">  div:nth-child(2)&#123;</span><br><span class="line">    flex: 1;</span><br><span class="line">    background-color: pink;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">button&#123;</span><br><span class="line">  margin-right: 10px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<p>点击按钮可以实现字体大小切换</p>
<img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20231007230159198.png" alt="image-20231007230159198" style="zoom:50%;" />

<h2 id="unoCss原子化"><a href="#unoCss原子化" class="headerlink" title="unoCss原子化"></a>unoCss原子化</h2><p>官网：<a target="_blank" rel="noopener" href="https://unocss.dev/">https://unocss.dev/</a></p>
<h3 id="什么是css原子化？"><a href="#什么是css原子化？" class="headerlink" title="什么是css原子化？"></a>什么是css原子化？</h3><p>CSS原子化的优缺点</p>
<p>1.减少了css体积，提高了css复用</p>
<p>2.减少起名的复杂度</p>
<p>3.增加了记忆成本 将css拆分为原子之后，你势必要记住一些class才能书写，哪怕tailwindcss提供了完善的工具链，你写background，也要记住开头是bg</p>
<h3 id="安装-2"><a href="#安装-2" class="headerlink" title="安装"></a>安装</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -D unocss</span><br></pre></td></tr></table></figure>

<p>配置插件</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vite.config.ts</span></span><br><span class="line"><span class="keyword">import</span> UnoCSS <span class="keyword">from</span> <span class="string">&#x27;unocss/vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&#x27;vite&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> defineConfig(&#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    UnoCSS(),</span><br><span class="line">  ],</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>创建一个 <code>uno.config.js</code> 文件</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// uno.config.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&#x27;unocss&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> defineConfig(&#123;</span><br><span class="line">    <span class="comment">// 自定义规则</span></span><br><span class="line">    rules:[</span><br><span class="line">        [<span class="string">&quot;red&quot;</span>,&#123; <span class="attr">color</span>:<span class="string">&quot;red&quot;</span>,<span class="string">&#x27;font-size&#x27;</span>:<span class="string">&quot;25px&quot;</span> &#125;]</span><br><span class="line">    ]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在 <code>main.ts</code> 文件中添加</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.ts</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;virtual:uno.css&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="使用-1"><a href="#使用-1" class="headerlink" title="使用"></a>使用</h3><p>直接在页面中使用类名即可</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;red&quot;</span>&gt;</span></span><br><span class="line">  Hello Word</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20231008221631938.png" alt="image-20231008221631938"></p>
<h3 id="动态配置类名"><a href="#动态配置类名" class="headerlink" title="动态配置类名"></a>动态配置类名</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rules: [</span><br><span class="line">  [<span class="regexp">/^m-(\d+)$/</span>, <span class="function">(<span class="params">[, d]</span>) =&gt;</span> (&#123; <span class="attr">margin</span>: <span class="string">`<span class="subst">$&#123;<span class="built_in">Number</span>(d) * <span class="number">10</span>&#125;</span>px`</span> &#125;)],</span><br><span class="line">  [<span class="string">&#x27;flex&#x27;</span>, &#123; <span class="attr">display</span>: <span class="string">&quot;flex&quot;</span> &#125;]</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>使用</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;red m-10&quot;</span>&gt;</span></span><br><span class="line">  Hello Word</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20231008222106144.png" alt="image-20231008222106144"></p>
<h3 id="使用预设"><a href="#使用预设" class="headerlink" title="使用预设"></a>使用预设</h3><p>修改 <code>uno.config.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// uno.config.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineConfig,presetIcons,presetAttributify,presetUno &#125; <span class="keyword">from</span> <span class="string">&#x27;unocss&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> defineConfig(&#123;</span><br><span class="line">    <span class="comment">// 自定义规则</span></span><br><span class="line">    rules:[</span><br><span class="line">        [<span class="regexp">/^m-(\d+)$/</span>, <span class="function">(<span class="params">[, d]</span>) =&gt;</span> (&#123; <span class="attr">margin</span>: <span class="string">`<span class="subst">$&#123;<span class="built_in">Number</span>(d) * <span class="number">10</span>&#125;</span>px`</span> &#125;)],</span><br><span class="line">        [<span class="string">&quot;red&quot;</span>,&#123; <span class="attr">color</span>:<span class="string">&quot;red&quot;</span>,<span class="string">&#x27;font-size&#x27;</span>:<span class="string">&quot;25px&quot;</span> &#125;],</span><br><span class="line">    ],</span><br><span class="line">    <span class="comment">// 使用预设</span></span><br><span class="line">    presets:[presetIcons(),presetAttributify(),presetUno()]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>presetIcons 这个是图标</p>
</li>
<li><p>presetAttributify 这个是美化CSS</p>
</li>
<li><p>presetUno 预设（实验阶段）是一系列流行的原子化框架的 通用超集，包括了 Tailwind CSS，Windi CSS，Bootstrap，Tachyons 等。</p>
<p>例如，ml-3（Tailwind），ms-2（Bootstrap），ma4（Tachyons），mt-10px（Windi CSS）均会生效。</p>
</li>
</ul>
<h3 id="使用图标"><a href="#使用图标" class="headerlink" title="使用图标"></a>使用图标</h3><p>在官网中找到自己需要的图标：<a target="_blank" rel="noopener" href="https://icones.js.org/">https://icones.js.org/</a></p>
<p>然后选中后安装</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20231008223505900.png" alt="image-20231008223505900"></p>
<p>查看页面路径上的单词，然后安装</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -D @iconify-json/svg-spinners</span><br></pre></td></tr></table></figure>

<p>点击某个要使用的图标，复制类名即可</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20231008223618270.png" alt="image-20231008223618270"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;i-svg-spinners-bars-fade font-size-50px color-pink&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20231008224316603.png" alt="image-20231008224316603"></p>
<h2 id="Vue编译宏"><a href="#Vue编译宏" class="headerlink" title="Vue编译宏"></a>Vue编译宏</h2><blockquote>
<p>首先vue版本必须是3.3及以上版本</p>
</blockquote>
<p>子组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;el-button type&#x3D;&quot;primary&quot; @click&#x3D;&quot;add&quot;&gt;添加&lt;&#x2F;el-button&gt;</span><br><span class="line"></span><br><span class="line">  &lt;ul&gt;</span><br><span class="line">    &lt;li v-for&#x3D;&quot;item in props.nameList&quot;&gt;</span><br><span class="line">      &#123;&#123;item&#125;&#125;</span><br><span class="line">    &lt;&#x2F;li&gt;</span><br><span class="line">  &lt;&#x2F;ul&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line">import &#123;defineProps,defineOptions,defineEmits,defineSlots&#125; from &quot;vue&quot;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; defineProps,可以定义类型</span><br><span class="line">const props &#x3D; defineProps&lt;&#123;</span><br><span class="line">  nameList:string[]</span><br><span class="line">&#125;&gt;()</span><br><span class="line"></span><br><span class="line">const add &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">  emit(&quot;addName&quot;,&#39;Tome&#39;)</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; defineEmits,可以定义事件</span><br><span class="line">&#x2F;&#x2F; 第一个参数是事件名称，第二个参数是事件参数类型，问号表示可选</span><br><span class="line">const emit &#x3D; defineEmits&lt;&#123;</span><br><span class="line">  (event:&#39;addName&#39;,args?:any):void</span><br><span class="line">&#125;&gt;()</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; defineOptions常用来定义组件名字</span><br><span class="line">defineOptions(&#123;</span><br><span class="line">  name:&quot;DefineComponents&quot;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>父组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;DefineComponents :nameList&#x3D;&quot;nameList&quot; @addName&#x3D;&quot;addName&quot;&#x2F;&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line">import DefineComponents from &quot;@&#x2F;components&#x2F;DefineComponents.vue&quot;;</span><br><span class="line"></span><br><span class="line">let nameList:string[] &#x3D; reactive([&quot;张三&quot;,&quot;李四&quot;, &quot;王五&quot;])</span><br><span class="line"></span><br><span class="line">const addName &#x3D; (args) &#x3D;&gt; &#123;</span><br><span class="line">  nameList.push(args)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>函数名称</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>defineProps</td>
<td>接收父组件传递过来的参数</td>
</tr>
<tr>
<td>defineEmits</td>
<td>定义事件名称</td>
</tr>
<tr>
<td>defineOptions</td>
<td>配置组件名称和其他信息</td>
</tr>
</tbody></table>
<h2 id="Vue环境变量"><a href="#Vue环境变量" class="headerlink" title="Vue环境变量"></a>Vue环境变量</h2><p>在项目根目录新建两个文件，分别表示开发环境配置、生成环境配置</p>
<blockquote>
<p>注意：设置环境变量时必须以 VITE_ 开头，否则不生效</p>
</blockquote>
<p><code>.env.development</code></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># .env.development</span></span><br><span class="line"><span class="attr">VITE_API</span>=<span class="string">http://localhost:8080</span></span><br></pre></td></tr></table></figure>

<p><code>.env.production</code></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># .env.production</span></span><br><span class="line"><span class="attr">VITE_API</span>=<span class="string">/prod-api</span></span><br></pre></td></tr></table></figure>

<p>修改 <code>package.json</code> 中的运行命令,在启动dev是设置mode是development，表示读取开发环境配置，名称可以自定义，但是要和上面新建的配置文件后缀名保持一致</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">  &quot;dev&quot;: &quot;vite --mode development&quot;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>然后在 vue 文件中通过下面方式获取配置项</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="keyword">import</span>.meta.env)</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20231015105913888.png" alt="image-20231015105913888"></p>
<p>这里是开发环境，读取到的 VITE_API 是 <a target="_blank" rel="noopener" href="http://localhost:8080/">http://localhost:8080</a></p>
<p>然后打包项目，再看一下打印结果</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20231015110224421.png" alt="image-20231015110224421"></p>
<p>在 <code>vite.config.ts</code> 中获取环境变量时通过如下方式获取</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineConfig,loadEnv &#125; <span class="keyword">from</span> <span class="string">&#x27;vite&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> &#123;VITE_API&#125; = loadEnv(process.env.NODE_ENV,process.cwd())</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(VITE_API)</span><br></pre></td></tr></table></figure>

<p>控制台会打印出定义的环境变量</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20231015110925175.png" alt="image-20231015110925175"></p>
<h2 id="Webpack从0到1构建Vue3工程"><a href="#Webpack从0到1构建Vue3工程" class="headerlink" title="Webpack从0到1构建Vue3工程"></a>Webpack从0到1构建Vue3工程</h2><p>项目结构</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">webpack-vue            </span><br><span class="line">├── config             </span><br><span class="line">│   ├── webpack.dev.js </span><br><span class="line">│   └── webpack.prod.js</span><br><span class="line">├── src                </span><br><span class="line">│   ├── App.vue        </span><br><span class="line">│   └── Child.vue      </span><br><span class="line">├── index.html         </span><br><span class="line">├── main.js            </span><br><span class="line">├── package.json       </span><br><span class="line">└── pnpm-lock.yaml</span><br></pre></td></tr></table></figure>

<p><code>package.json</code></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;webpack-vue&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;version&quot;</span>: <span class="string">&quot;1.0.0&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;main&quot;</span>: <span class="string">&quot;index.js&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;test&quot;</span>: <span class="string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;build&quot;</span>: <span class="string">&quot;webpack --config config/webpack.prod.js&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;dev&quot;</span>: <span class="string">&quot;webpack serve --config config/webpack.dev.js&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;keywords&quot;</span>: [],</span><br><span class="line">  <span class="attr">&quot;author&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;license&quot;</span>: <span class="string">&quot;ISC&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;dependencies&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;@vue/compiler-sfc&quot;</span>: <span class="string">&quot;^3.3.4&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;clean-webpack-plugin&quot;</span>: <span class="string">&quot;^4.0.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;css-loader&quot;</span>: <span class="string">&quot;^6.8.1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;friendly-errors-webpack-plugin&quot;</span>: <span class="string">&quot;^1.7.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;html-webpack-plugin&quot;</span>: <span class="string">&quot;^5.5.3&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;less&quot;</span>: <span class="string">&quot;^4.2.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;less-loader&quot;</span>: <span class="string">&quot;^11.1.3&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;style-loader&quot;</span>: <span class="string">&quot;^3.3.3&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;typescript&quot;</span>: <span class="string">&quot;^5.2.2&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;vue&quot;</span>: <span class="string">&quot;^3.3.4&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;vue-loader&quot;</span>: <span class="string">&quot;^17.3.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;webpack&quot;</span>: <span class="string">&quot;^5.89.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;webpack-cli&quot;</span>: <span class="string">&quot;^5.1.4&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;webpack-dev-server&quot;</span>: <span class="string">&quot;^4.15.1&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>webpack.dev.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin =  <span class="built_in">require</span>(<span class="string">&quot;html-webpack-plugin&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123;CleanWebpackPlugin&#125; = <span class="built_in">require</span>(<span class="string">&quot;clean-webpack-plugin&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123;VueLoaderPlugin&#125; = <span class="built_in">require</span>(<span class="string">&quot;vue-loader&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    mode:<span class="string">&quot;development&quot;</span>,</span><br><span class="line">    entry: <span class="string">&quot;./main.js&quot;</span>,</span><br><span class="line">    output: &#123;</span><br><span class="line">        filename: <span class="string">&quot;js/[name].[contenthash:10].js&quot;</span>,</span><br><span class="line">        path: path.resolve(__dirname, <span class="string">&quot;dist&quot;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="built_in">module</span>: &#123;</span><br><span class="line">        rules: [</span><br><span class="line">            &#123;</span><br><span class="line">                test:<span class="regexp">/\.vue$/</span>,</span><br><span class="line">                use: <span class="string">&quot;vue-loader&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.css$/</span>, <span class="comment">//解析css</span></span><br><span class="line">                use: [<span class="string">&quot;style-loader&quot;</span>, <span class="string">&quot;css-loader&quot;</span>],</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test:<span class="regexp">/\.less/</span>,</span><br><span class="line">                use: [<span class="string">&quot;style-loader&quot;</span>,<span class="string">&quot;css-loader&quot;</span>, <span class="string">&quot;less-loader&quot;</span>],</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    resolve: &#123;</span><br><span class="line">        alias: &#123;</span><br><span class="line">            <span class="string">&quot;@/&quot;</span>: path.resolve(__dirname, <span class="string">&#x27;./src&#x27;</span>) <span class="comment">// 别名</span></span><br><span class="line">        &#125;,</span><br><span class="line">        extensions: [<span class="string">&#x27;.js&#x27;</span>, <span class="string">&#x27;.json&#x27;</span>, <span class="string">&#x27;.vue&#x27;</span>, <span class="string">&#x27;.ts&#x27;</span>, <span class="string">&#x27;.tsx&#x27;</span>] <span class="comment">//识别后缀</span></span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> CleanWebpackPlugin(),</span><br><span class="line">        <span class="keyword">new</span> VueLoaderPlugin(),</span><br><span class="line">       <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">           template: <span class="string">&quot;./index.html&quot;</span>,</span><br><span class="line">       &#125;),</span><br><span class="line">    ],</span><br><span class="line">    devServer: &#123;</span><br><span class="line">        port: <span class="number">8088</span>,</span><br><span class="line">        open: <span class="literal">true</span>,</span><br><span class="line">        host: <span class="string">&quot;localhost&quot;</span>,</span><br><span class="line">        historyApiFallback: <span class="literal">true</span>, <span class="comment">// 解决vue-router刷新404问题</span></span><br><span class="line">        proxy: &#123;</span><br><span class="line">            <span class="string">&quot;/api&quot;</span>: &#123;</span><br><span class="line">                changeOrigin: <span class="literal">true</span>,</span><br><span class="line">                pathRewrite: &#123;</span><br><span class="line">                    <span class="string">&quot;^/api&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>webpack.prod.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin =  <span class="built_in">require</span>(<span class="string">&quot;html-webpack-plugin&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123;CleanWebpackPlugin&#125; = <span class="built_in">require</span>(<span class="string">&quot;clean-webpack-plugin&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123;VueLoaderPlugin&#125; = <span class="built_in">require</span>(<span class="string">&quot;vue-loader&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    mode:<span class="string">&quot;production&quot;</span>,</span><br><span class="line">    entry: <span class="string">&quot;./main.js&quot;</span>,</span><br><span class="line">    output: &#123;</span><br><span class="line">        filename: <span class="string">&quot;js/[name].[contenthash:10].js&quot;</span>,</span><br><span class="line">        path: path.resolve(__dirname, <span class="string">&quot;../dist&quot;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="built_in">module</span>: &#123;</span><br><span class="line">        rules: [</span><br><span class="line">            &#123;</span><br><span class="line">                test:<span class="regexp">/\.vue$/</span>,</span><br><span class="line">                use: <span class="string">&quot;vue-loader&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.css$/</span>, <span class="comment">//解析css</span></span><br><span class="line">                use: [<span class="string">&quot;style-loader&quot;</span>, <span class="string">&quot;css-loader&quot;</span>],</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test:<span class="regexp">/\.less/</span>,</span><br><span class="line">                use: [<span class="string">&quot;style-loader&quot;</span>,<span class="string">&quot;css-loader&quot;</span>, <span class="string">&quot;less-loader&quot;</span>],</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    resolve: &#123;</span><br><span class="line">        alias: &#123;</span><br><span class="line">            <span class="string">&quot;@&quot;</span>: path.resolve(__dirname, <span class="string">&#x27;./src&#x27;</span>) <span class="comment">// 别名</span></span><br><span class="line">        &#125;,</span><br><span class="line">        extensions: [<span class="string">&#x27;.js&#x27;</span>, <span class="string">&#x27;.json&#x27;</span>, <span class="string">&#x27;.vue&#x27;</span>, <span class="string">&#x27;.ts&#x27;</span>, <span class="string">&#x27;.tsx&#x27;</span>] <span class="comment">//识别后缀</span></span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> CleanWebpackPlugin(),</span><br><span class="line">        <span class="keyword">new</span> VueLoaderPlugin(),</span><br><span class="line">       <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">           template: <span class="string">&quot;./index.html&quot;</span>,</span><br><span class="line">       &#125;),</span><br><span class="line">    ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Vite性能优化"><a href="#Vite性能优化" class="headerlink" title="Vite性能优化"></a>Vite性能优化</h2><h3 id="打包优化"><a href="#打包优化" class="headerlink" title="打包优化"></a>打包优化</h3><p><code>vite.config.js</code> 添加 build 配置项</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; fileURLToPath, URL &#125; <span class="keyword">from</span> <span class="string">&#x27;node:url&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; defineConfig,loadEnv &#125; <span class="keyword">from</span> <span class="string">&#x27;vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> vue <span class="keyword">from</span> <span class="string">&#x27;@vitejs/plugin-vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> vueJsx <span class="keyword">from</span> <span class="string">&#x27;@vitejs/plugin-vue-jsx&#x27;</span></span><br><span class="line"><span class="keyword">import</span> AutoImport <span class="keyword">from</span> <span class="string">&#x27;unplugin-auto-import/vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Components <span class="keyword">from</span> <span class="string">&#x27;unplugin-vue-components/vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; ElementPlusResolver &#125; <span class="keyword">from</span> <span class="string">&#x27;unplugin-vue-components/resolvers&#x27;</span></span><br><span class="line"><span class="keyword">import</span> unocss <span class="keyword">from</span> <span class="string">&#x27;unocss/vite&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> &#123;VITE_API&#125; = loadEnv(process.env.NODE_ENV,process.cwd())</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(VITE_API)</span><br><span class="line"></span><br><span class="line"><span class="comment">// https://vitejs.dev/config/</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> defineConfig(&#123;</span><br><span class="line">  <span class="built_in">module</span>:<span class="string">&quot;es2022&quot;</span>,</span><br><span class="line">  plugins: [</span><br><span class="line">    vue(),</span><br><span class="line">    vueJsx(),</span><br><span class="line">    AutoImport(&#123;</span><br><span class="line">      resolvers: [ElementPlusResolver()],</span><br><span class="line">      imports: [<span class="string">&#x27;vue&#x27;</span>, <span class="string">&#x27;vue-router&#x27;</span>],</span><br><span class="line">      dts: <span class="string">&#x27;src/auto-imports.d.ts&#x27;</span></span><br><span class="line">    &#125;),</span><br><span class="line">    Components(&#123;</span><br><span class="line">      resolvers: [ElementPlusResolver()],</span><br><span class="line">    &#125;),</span><br><span class="line">    unocss(),</span><br><span class="line">  ],</span><br><span class="line">  resolve: &#123;</span><br><span class="line">    alias: &#123;</span><br><span class="line">      <span class="string">&#x27;@&#x27;</span>: fileURLToPath(<span class="keyword">new</span> URL(<span class="string">&#x27;./src&#x27;</span>, <span class="keyword">import</span>.meta.url))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  css: &#123;</span><br><span class="line">    preprocessorOptions: &#123;</span><br><span class="line">      scss: &#123;</span><br><span class="line">        additionalData: <span class="string">&quot;@import &#x27;./src/layout_v2/css/bem.scss&#x27;;&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  build:&#123;</span><br><span class="line">    minify:<span class="string">&quot;esbuild&quot;</span>, <span class="comment">// esbuild打包速度最快，terser 打包体积最小</span></span><br><span class="line">    cssCodeSplit:<span class="literal">true</span>,<span class="comment">// 拆分CSS文件</span></span><br><span class="line">    chunkSizeWarningLimit:<span class="number">2000</span>, <span class="comment">// 单文件超过2000kb警告</span></span><br><span class="line">    assetsInlineLimit:<span class="number">1024</span>*<span class="number">10</span>, <span class="comment">// 静态资源文件低于10KB时自动转Base64</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="Pinia"><a href="#Pinia" class="headerlink" title="Pinia"></a>Pinia</h2><h3 id="安装-3"><a href="#安装-3" class="headerlink" title="安装"></a>安装</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install pinia</span><br></pre></td></tr></table></figure>

<p>在 main.ts 中引入</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createApp&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;createPinia&#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> app = createApp(App)</span><br><span class="line">app.use(createPinia())</span><br><span class="line"></span><br><span class="line">app.mount(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="基本使用-1"><a href="#基本使用-1" class="headerlink" title="基本使用"></a>基本使用</h3><p><code>userInfoStore.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;defineStore&#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useUserInfoStore = defineStore(<span class="string">&#x27;userInfo&#x27;</span>, &#123;</span><br><span class="line">  state: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      name: <span class="string">&quot;李斯特&quot;</span>,</span><br><span class="line">      age: <span class="number">18</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  getters: &#123;</span><br><span class="line">    <span class="function"><span class="title">userMsg</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">this</span>.name + <span class="string">&#x27;---&#x27;</span> + <span class="built_in">this</span>.age</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  actions: &#123;</span><br><span class="line">    <span class="function"><span class="title">setName</span>(<span class="params">newName</span>)</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="built_in">this</span>.name)</span><br><span class="line">      <span class="built_in">this</span>.name = newName</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>actions 中的函数也是支持异步的，this 指向指向的是 state 中返回的对象地址，所以可以通过this来获取到 state 中的属性值</p>
<p>vue文件中使用方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">      &lt;li&gt;&#123;&#123; userInfoStore.name &#125;&#125;&lt;&#x2F;li&gt;</span><br><span class="line">      &lt;li&gt;&#123;&#123; userInfoStore.age &#125;&#125;&lt;&#x2F;li&gt;</span><br><span class="line">      &lt;li&gt;&#123;&#123; userInfoStore.userMsg &#125;&#125;&lt;&#x2F;li&gt;</span><br><span class="line">    &lt;&#x2F;ul&gt;</span><br><span class="line">    &lt;el-button type&#x3D;&quot;primary&quot; @click&#x3D;&quot;change&quot;&gt;change&lt;&#x2F;el-button&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123;useUserInfoStore&#125; from &quot;@&#x2F;stores&#x2F;userInfoStore&quot;;</span><br><span class="line"></span><br><span class="line">const userInfoStore &#x3D; useUserInfoStore()</span><br><span class="line"></span><br><span class="line">const change &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">  userInfoStore.setName(&quot;张三丰&quot;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="Pinia的一些API"><a href="#Pinia的一些API" class="headerlink" title="Pinia的一些API"></a>Pinia的一些API</h3><ul>
<li>$reset 重置数据</li>
<li>$subscribe 监听数据变化</li>
<li>$onAction 监听 action 数据变化</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useUserInfoStore&#125; <span class="keyword">from</span> <span class="string">&quot;@/stores/userInfoStore&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> userInfoStore = useUserInfoStore()</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> change = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  userInfoStore.setName(<span class="string">&quot;张三丰&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// $reset 重置数据</span></span><br><span class="line"><span class="keyword">const</span> reset = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  userInfoStore.$reset()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// $subscribe 监听数据变化</span></span><br><span class="line">userInfoStore.$subscribe(<span class="function">(<span class="params">mutation, state</span>) =&gt;</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(mutation, state)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// $onAction 监听 action 数据变化</span></span><br><span class="line">userInfoStore.$onAction(<span class="function">(<span class="params">action, state</span>) =&gt;</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(action, state)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="Pinia持久化缓存"><a href="#Pinia持久化缓存" class="headerlink" title="Pinia持久化缓存"></a>Pinia持久化缓存</h3><p>安装</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install pinia-plugin-persistedstate</span><br></pre></td></tr></table></figure>

<p>配置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createApp&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;createPinia&#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> PiniaPluginPersistedstate <span class="keyword">from</span> <span class="string">&quot;pinia-plugin-persistedstate&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> app = createApp(App)</span><br><span class="line"><span class="comment">// 配置Pinia并设置持久化缓存</span></span><br><span class="line"><span class="keyword">const</span> Pinia = createPinia()</span><br><span class="line">Pinia.use(PiniaPluginPersistedstate)</span><br><span class="line"></span><br><span class="line">app.use(Pinia)</span><br><span class="line">app.mount(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>然后在需要设置持久化缓存的pinia文件中开启persist配置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;defineStore&#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useUserInfoStore = defineStore(<span class="string">&#x27;userInfo&#x27;</span>, &#123;</span><br><span class="line">  state: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      name: <span class="string">&quot;李斯特&quot;</span>,</span><br><span class="line">      age: <span class="number">18</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  getters: &#123;</span><br><span class="line">    <span class="function"><span class="title">userMsg</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">this</span>.name + <span class="string">&#x27;---&#x27;</span> + <span class="built_in">this</span>.age</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  actions: &#123;</span><br><span class="line">    <span class="function"><span class="title">setName</span>(<span class="params">newName</span>)</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="built_in">this</span>.name)</span><br><span class="line">      <span class="built_in">this</span>.name = newName</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 开启数据持久化</span></span><br><span class="line">  persist: <span class="literal">true</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>效果展示</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/pinia.gif"></p>
<p>它原理是将pinia数据保存到 localStorage 缓存中，刷新页面后优先从缓存中读取，如果缓存中没有则再从代码中读取</p>
<h2 id="Echarts展示地图"><a href="#Echarts展示地图" class="headerlink" title="Echarts展示地图"></a>Echarts展示地图</h2><h3 id="效果图"><a href="#效果图" class="headerlink" title="效果图"></a>效果图</h3><p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20231019201753090.png" alt="image-20231019201753090"></p>
<h3 id="安装-4"><a href="#安装-4" class="headerlink" title="安装"></a>安装</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install echarts</span><br></pre></td></tr></table></figure>

<p>默认安装的是 5.x 版本</p>
<p>在这个版本中的引入方式必须是下面这种方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> echarts <span class="keyword">from</span> <span class="string">&#x27;echarts&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h3><p>首先要下载好地图数据 <code>china.js</code></p>
<p>下载地址：<a target="_blank" rel="noopener" href="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/china.js%EF%BC%8C%E4%B8%8B%E8%BD%BD%E5%88%B0%E6%9C%AC%E5%9C%B0%E4%BD%BF%E7%94%A8%E5%8D%B3%E5%8F%AF">https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/china.js，下载到本地使用即可</a></p>
<p>地图实现源码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&#39;h-full flex justify-center items-center&#39;&gt;</span><br><span class="line">    &lt;div id&#x3D;&#39;mapDom&#39; class&#x3D;&#39;h-full w-full&#39;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; onMounted &#125; from &#39;vue&#39;</span><br><span class="line">import * as echarts from &#39;echarts&#39;</span><br><span class="line">import &#39;..&#x2F;assets&#x2F;china&#39;</span><br><span class="line">import &#123; getCityPositionByName &#125; from &#39;@&#x2F;assets&#x2F;cityPostion&#39;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 模拟10条数据</span><br><span class="line">let mockData &#x3D; [</span><br><span class="line">  &#123; name: &#39;北京&#39;, value: 500 &#125;,</span><br><span class="line">  &#123; name: &#39;天津&#39;, value: 200 &#125;,</span><br><span class="line">  &#123; name: &#39;河南&#39;, value: 300 &#125;,</span><br><span class="line">  &#123; name: &#39;广西&#39;, value: 300 &#125;,</span><br><span class="line">  &#123; name: &#39;广东&#39;, value: 300 &#125;,</span><br><span class="line">  &#123; name: &#39;河北&#39;, value: 300 &#125;,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">onMounted(() &#x3D;&gt; &#123;</span><br><span class="line">  let data &#x3D; mockData.map(i &#x3D;&gt; &#123;</span><br><span class="line">    let cityPosition &#x3D; getCityPositionByName(i.name).value</span><br><span class="line">    return &#123;</span><br><span class="line">      name: i.name,</span><br><span class="line">      value: cityPosition.concat(i.value),</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  let initMap &#x3D; echarts.init(document.querySelector(&#39;#mapDom&#39;))</span><br><span class="line">  initMap.setOption(&#123;</span><br><span class="line">    backgroundColor: &#39;transparent&#39;, &#x2F;&#x2F; 设置背景色透明</span><br><span class="line">    &#x2F;&#x2F; 必须设置</span><br><span class="line">    tooltip: &#123;</span><br><span class="line">      show: false,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#x2F;&#x2F; 地图阴影配置</span><br><span class="line">    geo: &#123;</span><br><span class="line">      map: &#39;china&#39;,</span><br><span class="line">      &#x2F;&#x2F; 这里必须定义，不然后面series里面不生效</span><br><span class="line">      tooltip: &#123;</span><br><span class="line">        show: false,</span><br><span class="line">      &#125;,</span><br><span class="line">      label: &#123;</span><br><span class="line">        show: false,</span><br><span class="line">      &#125;,</span><br><span class="line">      zoom: 1.03,</span><br><span class="line">      silent: true, &#x2F;&#x2F; 不响应鼠标时间</span><br><span class="line">      show: true,</span><br><span class="line">      roam: false, &#x2F;&#x2F; 地图缩放和平移</span><br><span class="line">      aspectScale: 0.75, &#x2F;&#x2F; scale 地图的长宽比</span><br><span class="line">      itemStyle: &#123;</span><br><span class="line">        borderColor: &#39;#0FA3F0&#39;,</span><br><span class="line">        borderWidth: 1,</span><br><span class="line">        areaColor: &#39;#070f71&#39;,</span><br><span class="line">        shadowColor: &#39;rgba(1,34,73,0.48)&#39;,</span><br><span class="line">        shadowBlur: 10,</span><br><span class="line">        shadowOffsetX: -10,</span><br><span class="line">        shadowOffsetY: 10,</span><br><span class="line">      &#125;,</span><br><span class="line">      select: &#123;</span><br><span class="line">        disabled: true,</span><br><span class="line">      &#125;,</span><br><span class="line">      emphasis: &#123;</span><br><span class="line">        disabled: true,</span><br><span class="line">        areaColor: &#39;#00F1FF&#39;,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#x2F;&#x2F; 地图区域的多边形 图形样式 阴影效果</span><br><span class="line">      &#x2F;&#x2F; z值小的图形会被z值大的图形覆盖</span><br><span class="line">      top: &#39;10%&#39;,</span><br><span class="line">      left: &#39;center&#39;,</span><br><span class="line">      &#x2F;&#x2F; 去除南海诸岛阴影 series map里面没有此属性</span><br><span class="line">      regions: [&#123;</span><br><span class="line">        name: &#39;南海诸岛&#39;,</span><br><span class="line">        selected: false,</span><br><span class="line">        emphasis: &#123;</span><br><span class="line">          disabled: true,</span><br><span class="line">        &#125;,</span><br><span class="line">        itemStyle: &#123;</span><br><span class="line">          areaColor: &#39;#00000000&#39;,</span><br><span class="line">          borderColor: &#39;#00000000&#39;,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;],</span><br><span class="line">      z: 1,</span><br><span class="line">    &#125;,</span><br><span class="line">    series: [</span><br><span class="line">      &#x2F;&#x2F; 地图配置</span><br><span class="line">      &#123;</span><br><span class="line">        type: &#39;map&#39;,</span><br><span class="line">        map: &#39;china&#39;,</span><br><span class="line">        zoom: 1,</span><br><span class="line">        tooltip: &#123;</span><br><span class="line">          show: false,</span><br><span class="line">        &#125;,</span><br><span class="line">        label: &#123;</span><br><span class="line">          show: true, &#x2F;&#x2F; 显示省份名称</span><br><span class="line">          color: &#39;#ffffff&#39;,</span><br><span class="line">          align: &#39;center&#39;,</span><br><span class="line">        &#125;,</span><br><span class="line">        top: &#39;10%&#39;,</span><br><span class="line">        left: &#39;center&#39;,</span><br><span class="line">        aspectScale: 0.75,</span><br><span class="line">        roam: false, &#x2F;&#x2F; 地图缩放和平移</span><br><span class="line">        itemStyle: &#123;</span><br><span class="line">          borderColor: &#39;#3ad6ff&#39;, &#x2F;&#x2F; 省分界线颜色  阴影效果的</span><br><span class="line">          borderWidth: 1,</span><br><span class="line">          areaColor: &#39;#17348b&#39;,</span><br><span class="line">          opacity: 1,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#x2F;&#x2F; 去除选中状态</span><br><span class="line">        select: &#123;</span><br><span class="line">          disabled: true,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#x2F;&#x2F; 控制鼠标悬浮上去的效果</span><br><span class="line">        emphasis: &#123; &#x2F;&#x2F; 聚焦后颜色</span><br><span class="line">          disabled: false, &#x2F;&#x2F; 开启高亮</span><br><span class="line">          label: &#123;</span><br><span class="line">            align: &#39;center&#39;,</span><br><span class="line">            color: &#39;#ffffff&#39;,</span><br><span class="line">          &#125;,</span><br><span class="line">          itemStyle: &#123;</span><br><span class="line">            color: &#39;#ffffff&#39;,</span><br><span class="line">            areaColor: &#39;#0075f4&#39;,&#x2F;&#x2F; 阴影效果 鼠标移动上去的颜色</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">        z: 2,</span><br><span class="line">        data: data,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        type: &#39;scatter&#39;,</span><br><span class="line">        coordinateSystem: &#39;geo&#39;,</span><br><span class="line">        symbol: &#39;pin&#39;,</span><br><span class="line">        symbolSize: [50, 50],</span><br><span class="line">        label: &#123;</span><br><span class="line">          show: true,</span><br><span class="line">          color: &#39;#fff&#39;,</span><br><span class="line">          formatter(value) &#123;</span><br><span class="line">            return value.data.value[2]</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">        itemStyle: &#123;</span><br><span class="line">          color: &#39;#e30707&#39;, &#x2F;&#x2F;标志颜色</span><br><span class="line">        &#125;,</span><br><span class="line">        z: 2,</span><br><span class="line">        data: data,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p><code>cityPostion.js</code> 文件代码，这个文件主要是通过省份名称获取经纬度</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> positionArr = [</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;北京&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;116.3979471&#x27;</span>, <span class="string">&#x27;39.9081726&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;上海&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;121.4692688&#x27;</span>, <span class="string">&#x27;31.2381763&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;天津&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;117.2523808&#x27;</span>, <span class="string">&#x27;39.1038561&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;重庆&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;106.548425&#x27;</span>, <span class="string">&#x27;29.5549144&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;河北&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;114.4897766&#x27;</span>, <span class="string">&#x27;38.0451279&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;山西&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;112.5223053&#x27;</span>, <span class="string">&#x27;37.8357424&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;辽宁&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;123.4116821&#x27;</span>, <span class="string">&#x27;41.7966156&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;吉林&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;125.3154297&#x27;</span>, <span class="string">&#x27;43.8925629&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;黑龙江&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;126.6433411&#x27;</span>, <span class="string">&#x27;45.7414932&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;浙江&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;120.1592484&#x27;</span>, <span class="string">&#x27;30.265995&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;福建&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;119.2978134&#x27;</span>, <span class="string">&#x27;26.0785904&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;山东&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;117.0056&#x27;</span>, <span class="string">&#x27;36.6670723&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;河南&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;113.6500473&#x27;</span>, <span class="string">&#x27;34.7570343&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;湖北&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;114.2919388&#x27;</span>, <span class="string">&#x27;30.5675144&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;湖南&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;112.9812698&#x27;</span>, <span class="string">&#x27;28.2008247&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;广东&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;113.2614288&#x27;</span>, <span class="string">&#x27;23.1189117&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;海南&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;110.3465118&#x27;</span>, <span class="string">&#x27;20.0317936&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;四川&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;104.0817566&#x27;</span>, <span class="string">&#x27;30.6610565&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;贵州&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;106.7113724&#x27;</span>, <span class="string">&#x27;26.5768738&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;云南&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;102.704567&#x27;</span>, <span class="string">&#x27;25.0438442&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;江西&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;115.8999176&#x27;</span>, <span class="string">&#x27;28.6759911&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;陕西&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;108.949028&#x27;</span>, <span class="string">&#x27;34.2616844&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;青海&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;101.7874527&#x27;</span>, <span class="string">&#x27;36.6094475&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;甘肃&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;103.7500534&#x27;</span>, <span class="string">&#x27;36.0680389&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;广西&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;108.3117676&#x27;</span>, <span class="string">&#x27;22.8065434&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;新疆&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;87.6061172&#x27;</span>, <span class="string">&#x27;43.7909393&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;内蒙古&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;111.6632996&#x27;</span>, <span class="string">&#x27;40.8209419&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;西藏&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;91.1320496&#x27;</span>, <span class="string">&#x27;29.657589&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;宁夏&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;106.2719421&#x27;</span>, <span class="string">&#x27;38.4680099&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;台湾&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;120.9581316&#x27;</span>, <span class="string">&#x27;23.8516062&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;香港&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;114.139452&#x27;</span>, <span class="string">&#x27;22.391577&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;澳门&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;113.5678411&#x27;</span>, <span class="string">&#x27;22.167654&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;安徽&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;117.2757034&#x27;</span>, <span class="string">&#x27;31.8632545&#x27;</span>] &#125;,</span><br><span class="line">  &#123; <span class="attr">name</span>: <span class="string">&#x27;江苏&#x27;</span>, <span class="attr">value</span>: [<span class="string">&#x27;118.7727814&#x27;</span>, <span class="string">&#x27;32.0476151&#x27;</span>] &#125;,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getCityPositionByName</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> positionArr.find(<span class="function"><span class="params">item</span> =&gt;</span> item.name === name)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Vue-Router"><a href="#Vue-Router" class="headerlink" title="Vue-Router"></a>Vue-Router</h2><h3 id="安装-5"><a href="#安装-5" class="headerlink" title="安装"></a>安装</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install vue-router</span><br></pre></td></tr></table></figure>

<p>安装完成后检查一下安装的版本是否是 4.x 版本，确保在 vue3 中可以使用</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20231022094941965.png" alt="image-20231022094941965"></p>
<h3 id="定义路由和404"><a href="#定义路由和404" class="headerlink" title="定义路由和404"></a>定义路由和404</h3><p>新建 <code>router/index.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createRouter,createWebHashHistory&#125; <span class="keyword">from</span> <span class="string">&quot;vue-router&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = createRouter(&#123;</span><br><span class="line">    <span class="comment">// 定义路由模式：哈希模式</span></span><br><span class="line">    history:createWebHashHistory(),</span><br><span class="line">    routes:[</span><br><span class="line">        &#123;</span><br><span class="line">            path:<span class="string">&quot;/&quot;</span>,</span><br><span class="line">            component:<span class="function">()=&gt;</span><span class="keyword">import</span>(<span class="string">&quot;../views/home.vue&quot;</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            path:<span class="string">&quot;/about&quot;</span>,</span><br><span class="line">            component:<span class="function">()=&gt;</span><span class="keyword">import</span>(<span class="string">&quot;../views/about.vue&quot;</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// 匹配404页面，当所有路径都匹配不到时，就跳转到404</span></span><br><span class="line">        &#123;</span><br><span class="line">            path: <span class="string">&quot;/:pathMatch(.*)&quot;</span>,</span><br><span class="line">            component: <span class="function">()=&gt;</span><span class="keyword">import</span>(<span class="string">&quot;../views/404.vue&quot;</span>),</span><br><span class="line">        &#125;,</span><br><span class="line">    ]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出路由</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure>

<p>注册路由</p>
<p><code>main.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&quot;./router&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = createApp(App)</span><br><span class="line"></span><br><span class="line">app.use(router)</span><br><span class="line"></span><br><span class="line">app.mount(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>定义路由出口</p>
<p><code>App.vue</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;router-view&#x2F;&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20231022100705985.png" alt="image-20231022100705985"></p>
<h3 id="路由跳转"><a href="#路由跳转" class="headerlink" title="路由跳转"></a>路由跳转</h3><p>方式一：router-link</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;router-link class&#x3D;&quot;mr-10&quot; to&#x3D;&quot;&#x2F;&quot;&gt;home&lt;&#x2F;router-link&gt;</span><br><span class="line">&lt;router-link to&#x3D;&quot;&#x2F;about&quot;&gt;about&lt;&#x2F;router-link&gt;</span><br></pre></td></tr></table></figure>

<p>router-link是vue-router内置的组件，通过to属性定义要跳转的地址，属性值要和路由中的 path 相对应</p>
<p>方式二：通过js的方式跳转</p>
<p>定义两个按钮，点击按钮实现跳转</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;button class&#x3D;&quot;mr-10&quot; @click&#x3D;&quot;toPath(&#39;&#x2F;&#39;)&quot;&gt;home&lt;&#x2F;button&gt;</span><br><span class="line">&lt;button @click&#x3D;&quot;toPath(&#39;&#x2F;about&#39;)&quot;&gt;about&lt;&#x2F;button&gt;</span><br></pre></td></tr></table></figure>

<p>js方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useRouter&#125; <span class="keyword">from</span> <span class="string">&quot;vue-router&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = useRouter()</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> toPath = <span class="function">(<span class="params">url</span>) =&gt;</span> &#123;</span><br><span class="line">  router.push(&#123;</span><br><span class="line">    path:url</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="控制路由返回与前进"><a href="#控制路由返回与前进" class="headerlink" title="控制路由返回与前进"></a>控制路由返回与前进</h3><p>定义两个按钮分别实现返回和前进</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;button class&#x3D;&quot;mr-10&quot; @click&#x3D;&quot;back()&quot;&gt;返回&lt;&#x2F;button&gt;</span><br><span class="line">&lt;button class&#x3D;&quot;mr-10&quot; @click&#x3D;&quot;advance()&quot;&gt;前进&lt;&#x2F;button&gt;</span><br></pre></td></tr></table></figure>

<p>实现两个方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> back = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 方式一</span></span><br><span class="line">  <span class="comment">// router.go(-1)</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 方式二</span></span><br><span class="line">  router.back()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> advance = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  router.go(<span class="number">1</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="replace"><a href="#replace" class="headerlink" title="replace"></a>replace</h3><p>默认通过 push 的方式跳转会留下历史记录。如果不想留下历史记录，可以通过 replace 这种方法跳转。</p>
<p>例如在登录成功后就可以使用 replace 来跳转</p>
<p>在 router-link 标签上添加 replace 属性</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">replace</span> <span class="attr">class</span>=<span class="string">&quot;mr-10&quot;</span> <span class="attr">to</span>=<span class="string">&quot;/&quot;</span>&gt;</span>home<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">replace</span> <span class="attr">class</span>=<span class="string">&quot;mr-10&quot;</span> <span class="attr">to</span>=<span class="string">&quot;/about&quot;</span>&gt;</span>about<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>或者通过 router.replace</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> toPath = <span class="function">(<span class="params">url</span>) =&gt;</span> &#123;</span><br><span class="line">  router.replace(&#123;</span><br><span class="line">    path:url</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这种跳转方式不会留下历史记录</p>
<h3 id="路由传参"><a href="#路由传参" class="headerlink" title="路由传参"></a>路由传参</h3><p>通过添加 query 参数来实现传参</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> toPath = <span class="function">(<span class="params">url</span>) =&gt;</span> &#123;</span><br><span class="line">  router.push(&#123;</span><br><span class="line">    path:url,</span><br><span class="line">    query:&#123;</span><br><span class="line">      id:<span class="number">1</span>,</span><br><span class="line">      name:<span class="string">&quot;李四&quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过如下方法接收路由参数</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  我是详情页，接收到的路由参数是：&#123;&#123;route.query&#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123;useRoute&#125; <span class="keyword">from</span> <span class="string">&quot;vue-router&quot;</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> route = useRoute()</span></span><br><span class="line"></span><br><span class="line"><span class="javascript"><span class="built_in">console</span>.log(route.query)</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20231022102319527.png" alt="image-20231022102319527"></p>
<p>接收到到的是一个对象</p>
<h3 id="动态URL"><a href="#动态URL" class="headerlink" title="动态URL"></a>动态URL</h3><p>我们也可以将参数作为页面URL的一部分</p>
<p>首先定义路由</p>
<blockquote>
<p>注意：</p>
<p>这里要多定义一个参数：name，动态路由跳转时，需要通过 name 来跳转</p>
<p>使用 /dyDetail/:xxx/:xxx 这种方式定义动态参数名称</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    path:<span class="string">&quot;/dyDetail/:id/:name&quot;</span>,</span><br><span class="line">    name:<span class="string">&quot;DyDetail&quot;</span>,</span><br><span class="line">    component:<span class="function">()=&gt;</span><span class="keyword">import</span>(<span class="string">&quot;../views/dyDetail.vue&quot;</span>)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>添加跳转方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> toDyDetail = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  router.push(&#123;</span><br><span class="line">    <span class="comment">// 这里使用name来跳转，name名称也要和路由中定义的name一致</span></span><br><span class="line">    name:<span class="string">&quot;DyDetail&quot;</span>,</span><br><span class="line">    <span class="comment">// 这里传递的属性名必须和路由中定义的参数名一致</span></span><br><span class="line">    params:&#123;</span><br><span class="line">      id:<span class="string">&quot;1&quot;</span>,</span><br><span class="line">      name:<span class="string">&quot;张三&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>获取动态路由参数方法，通过 route.params 方法获取</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>id：&#123;&#123;route.params.id&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>name：&#123;&#123;route.params.name&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123;useRoute&#125; <span class="keyword">from</span> <span class="string">&quot;vue-router&quot;</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> route = useRoute()</span></span><br><span class="line"></span><br><span class="line"><span class="javascript"><span class="built_in">console</span>.log(route.params)</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20231022103152777.png" alt="image-20231022103152777"></p>
<p>这里观察地址栏中的显示方式，直接将参数获取url的一部分来显示</p>
<h3 id="路由嵌套"><a href="#路由嵌套" class="headerlink" title="路由嵌套"></a>路由嵌套</h3><p>定义路由</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    path:<span class="string">&quot;/system&quot;</span>,</span><br><span class="line">    component:<span class="function">()=&gt;</span><span class="keyword">import</span>(<span class="string">&quot;../views/system/index.vue&quot;</span>),</span><br><span class="line">    children:[</span><br><span class="line">        &#123;</span><br><span class="line">            path:<span class="string">&quot;menu&quot;</span>,</span><br><span class="line">            component:<span class="function">()=&gt;</span><span class="keyword">import</span>(<span class="string">&quot;../views/system/menu.vue&quot;</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            path:<span class="string">&quot;role&quot;</span>,</span><br><span class="line">            component:<span class="function">()=&gt;</span><span class="keyword">import</span>(<span class="string">&quot;../views/system/role.vue&quot;</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>system/index.vue</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;parent&quot;&gt;</span><br><span class="line">    &lt;button @click&#x3D;&quot;toPath(&#39;menu&#39;)&quot;&gt;菜单管理&lt;&#x2F;button&gt;</span><br><span class="line">    &lt;button @click&#x3D;&quot;toPath(&#39;role&#39;)&quot;&gt;角色管理&lt;&#x2F;button&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">  &lt;router-view&#x2F;&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123;useRouter&#125; from &quot;vue-router&quot;;</span><br><span class="line"></span><br><span class="line">const router &#x3D; useRouter()</span><br><span class="line">const toPath &#x3D; (url) &#x3D;&gt; &#123;</span><br><span class="line">  router.push(&#123;</span><br><span class="line">    path:&#96;&#x2F;system&#x2F;$&#123;url&#125;&#96;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.parent&#123;</span><br><span class="line">  height: 45px;</span><br><span class="line">  background-color: pink;</span><br><span class="line">  display: flex;</span><br><span class="line">  gap: 15px;</span><br><span class="line">  align-items: center;</span><br><span class="line">  justify-content: center;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<p>跳转到子路由时，需要加上父路由地址</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20231022104829861.png" alt="image-20231022104829861"></p>
<h3 id="重定向"><a href="#重定向" class="headerlink" title="重定向"></a>重定向</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    path:<span class="string">&quot;/system&quot;</span>,</span><br><span class="line">    <span class="comment">// 重定向到第一个子菜单</span></span><br><span class="line">    redirect:<span class="string">&quot;/system/menu&quot;</span>,</span><br><span class="line">    component:<span class="function">()=&gt;</span><span class="keyword">import</span>(<span class="string">&quot;../views/system/index.vue&quot;</span>),</span><br><span class="line">    children:[</span><br><span class="line">        &#123;</span><br><span class="line">            path:<span class="string">&quot;menu&quot;</span>,</span><br><span class="line">            component:<span class="function">()=&gt;</span><span class="keyword">import</span>(<span class="string">&quot;../views/system/menu.vue&quot;</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            path:<span class="string">&quot;role&quot;</span>,</span><br><span class="line">            component:<span class="function">()=&gt;</span><span class="keyword">import</span>(<span class="string">&quot;../views/system/role.vue&quot;</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="路由守卫"><a href="#路由守卫" class="headerlink" title="路由守卫"></a>路由守卫</h3><p>全局前置路由守卫</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 全局前置路由守卫</span></span><br><span class="line">router.beforeResolve(<span class="function">(<span class="params">to,<span class="keyword">from</span>,next</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(to) <span class="comment">// 去哪个页面</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">from</span>) <span class="comment">// 从哪个页面来</span></span><br><span class="line">    next() <span class="comment">// 下一步，必须要写，否则无法跳转</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>全局后置路由守卫</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 全局后置路由守卫</span></span><br><span class="line">router.afterEach(<span class="function">(<span class="params">to,<span class="keyword">from</span></span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(to) <span class="comment">// 去哪个页面</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">from</span>) <span class="comment">// 从哪个页面来</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>局部路由守卫</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    path:<span class="string">&quot;menu&quot;</span>,</span><br><span class="line">    component:<span class="function">()=&gt;</span><span class="keyword">import</span>(<span class="string">&quot;../views/system/menu.vue&quot;</span>),</span><br><span class="line">    <span class="comment">// 局部前置路由守卫</span></span><br><span class="line">    beforeEnter:(<span class="function">(<span class="params">to,<span class="keyword">from</span>,next</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(to,<span class="string">&#x27;局部前置路由守卫&#x27;</span>)</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">from</span>,<span class="string">&#x27;局部前置路由守卫&#x27;</span>)</span><br><span class="line">        next()</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="滚动行为"><a href="#滚动行为" class="headerlink" title="滚动行为"></a>滚动行为</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createRouter,createWebHashHistory&#125; <span class="keyword">from</span> <span class="string">&quot;vue-router&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = createRouter(&#123;</span><br><span class="line">    <span class="comment">// 定义路由模式：哈希模式</span></span><br><span class="line">    history:createWebHashHistory(),</span><br><span class="line">    <span class="comment">// 滚动模式</span></span><br><span class="line">    scrollBehavior:<span class="function">(<span class="params">to,<span class="keyword">from</span>,savedPosition</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(savedPosition)&#123;</span><br><span class="line">            <span class="comment">// 如果有滚动的位置，则重新回到之前滚动的位置</span></span><br><span class="line">            <span class="keyword">return</span> savedPosition</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">// 否则页面滚动到顶部</span></span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="attr">x</span>:<span class="number">0</span>,<span class="attr">y</span>:<span class="number">0</span>&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    routes:[</span><br><span class="line">        &#123;</span><br><span class="line">            path:<span class="string">&quot;/&quot;</span>,</span><br><span class="line">            component:<span class="function">()=&gt;</span><span class="keyword">import</span>(<span class="string">&quot;../views/home.vue&quot;</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            path:<span class="string">&quot;/about&quot;</span>,</span><br><span class="line">            component:<span class="function">()=&gt;</span><span class="keyword">import</span>(<span class="string">&quot;../views/about.vue&quot;</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            path:<span class="string">&quot;/detail&quot;</span>,</span><br><span class="line">            component:<span class="function">()=&gt;</span><span class="keyword">import</span>(<span class="string">&quot;../views/detail.vue&quot;</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">    ]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出路由</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure>

<h3 id="动态路由"><a href="#动态路由" class="headerlink" title="动态路由"></a>动态路由</h3><p>在后台管理系统中常见的场景，根据不同的角色，显示不同的菜单</p>
<p>编写方法，根据不同的账号名，返回不同的菜单</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getDynamicRouting</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="comment">// root角色登录</span></span><br><span class="line">        <span class="keyword">if</span>(name === <span class="string">&quot;admin&quot;</span>)&#123;</span><br><span class="line">            resolve([</span><br><span class="line">                &#123;</span><br><span class="line">                    path:<span class="string">&quot;/about&quot;</span>,</span><br><span class="line">                    component:<span class="string">&quot;about.vue&quot;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    path:<span class="string">&quot;/detail&quot;</span>,</span><br><span class="line">                    component:<span class="string">&quot;detail.vue&quot;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    path:<span class="string">&quot;/system&quot;</span>,</span><br><span class="line">                    redirect:<span class="string">&quot;/system/menu&quot;</span>,</span><br><span class="line">                    component:<span class="string">&quot;system/index.vue&quot;</span>,</span><br><span class="line">                    children:[</span><br><span class="line">                        &#123;</span><br><span class="line">                            path:<span class="string">&quot;menu&quot;</span>,</span><br><span class="line">                            component:<span class="string">&quot;system/menu.vue&quot;</span>,</span><br><span class="line">                        &#125;,</span><br><span class="line">                        &#123;</span><br><span class="line">                            path:<span class="string">&quot;role&quot;</span>,</span><br><span class="line">                            component:<span class="string">&quot;system/role.vue&quot;</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                    ],</span><br><span class="line">                &#125;,</span><br><span class="line">            ])</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 普通人员登录</span></span><br><span class="line">        <span class="keyword">if</span>(name === <span class="string">&quot;tome&quot;</span>)&#123;</span><br><span class="line">            resolve([</span><br><span class="line">                &#123;</span><br><span class="line">                    path:<span class="string">&quot;/about&quot;</span>,</span><br><span class="line">                    component:<span class="string">&quot;about.vue&quot;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    path:<span class="string">&quot;/detail&quot;</span>,</span><br><span class="line">                    component:<span class="string">&quot;detail.vue&quot;</span></span><br><span class="line">                &#125;,</span><br><span class="line">            ])</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>login.vue</code></p>
<p>登录成功后根据返回的路由信息，添加路由</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入账号&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;name&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入密码&quot;</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;pwd&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;login&quot;</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123;ref&#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&quot;../router&quot;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123;getDynamicRouting&#125; <span class="keyword">from</span> <span class="string">&quot;../../mock/mockRouter.js&quot;</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="javascript"><span class="keyword">let</span> name = ref(<span class="string">&quot;&quot;</span>)</span></span><br><span class="line"><span class="javascript"><span class="keyword">let</span> pwd = ref(<span class="string">&quot;&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> login = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">  getDynamicRouting(name.value).then(<span class="function"><span class="params">routers</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="javascript">     <span class="keyword">let</span> dyRouter = setDyRouter(routers)</span></span><br><span class="line"><span class="javascript">     <span class="comment">// 只需要添加一级路由信息即可</span></span></span><br><span class="line"><span class="javascript">     dyRouter.forEach(<span class="function"><span class="params">rootRouter</span>=&gt;</span>&#123;</span></span><br><span class="line">       router.addRoute(rootRouter)</span><br><span class="line">     &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> setDyRouter = <span class="function">(<span class="params">routers,parentPath</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">  routers.forEach(<span class="function"><span class="params">item</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="javascript">    item.component = <span class="keyword">import</span>(<span class="string">`../views/<span class="subst">$&#123;item.component&#125;</span>`</span>)</span></span><br><span class="line"><span class="javascript">    <span class="keyword">if</span>(!item.path.startsWith(<span class="string">&quot;/&quot;</span>))&#123;</span></span><br><span class="line"><span class="javascript">      item.path = <span class="string">`<span class="subst">$&#123;parentPath&#125;</span>/<span class="subst">$&#123;item.path&#125;</span>`</span></span></span><br><span class="line">    &#125;</span><br><span class="line">    if(item.children)&#123;</span><br><span class="line">      setDyRouter(item.children,item.path)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="javascript">  <span class="keyword">return</span> routers</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>测试</p>
<p>首先用admin登录，然后点击菜单管理可以正常返回</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20231022203258691.png" alt="image-20231022203258691"></p>
<p>然后刷新页面，使用tome登录，然后点击菜单管理发现是404</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20231022203424279.png" alt="image-20231022203424279"></p>
<p>上面的例子只是简单的实现了一个动态路由，实际开发中，我们会根据接口返回的路由数据渲染不同的菜单来显示</p>
<h2 id="MarkDown语法高亮"><a href="#MarkDown语法高亮" class="headerlink" title="MarkDown语法高亮"></a>MarkDown语法高亮</h2><h3 id="安装-6"><a href="#安装-6" class="headerlink" title="安装"></a>安装</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install marked highlight.js --save</span><br><span class="line">or</span><br><span class="line">pnpm add marked highlight.js --save</span><br></pre></td></tr></table></figure>

<h3 id="注册"><a href="#注册" class="headerlink" title="注册"></a>注册</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./assets/main.css&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; createPinia &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;./router&#x27;</span></span><br><span class="line"><span class="keyword">import</span> highlight <span class="keyword">from</span> <span class="string">&#x27;highlight.js&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;highlight.js/styles/atom-one-dark.css&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = createApp(App)</span><br><span class="line"></span><br><span class="line">app.use(createPinia())</span><br><span class="line">app.use(router)</span><br><span class="line"></span><br><span class="line">app.directive(<span class="string">&quot;highlight&quot;</span>,<span class="function"><span class="keyword">function</span>(<span class="params">el</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">let</span> blocks = el.querySelectorAll(<span class="string">&#x27;pre code&#x27;</span>);</span><br><span class="line">  blocks.forEach(<span class="function">(<span class="params">block</span>)=&gt;</span>&#123;</span><br><span class="line">    highlight.highlightBlock(block);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.mount(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="使用-2"><a href="#使用-2" class="headerlink" title="使用"></a>使用</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-highlight</span> <span class="attr">v-html</span>=<span class="string">&#x27;content&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; marked &#125; <span class="keyword">from</span> <span class="string">&#x27;marked&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> content = ref(<span class="string">&quot;&quot;</span>)</span></span><br><span class="line"><span class="javascript"><span class="comment">// 需要使用marked方法吧语法转成html页面</span></span></span><br><span class="line">content = marked(content)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h3><p><img src= "/img/loading.gif" data-lazy-src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/picgo/image-20231028152820833.png" alt="image-20231028152820833"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">SZX</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://songzx0106.github.io/Vue/2023100801/">https://songzx0106.github.io/Vue/2023100801/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://SongZX0106.github.io" target="_blank">SZX的开发笔记</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Vue/">Vue</a></div><div class="post_share"><div class="social-share" data-image="/images/ys07.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/js/share.min.css" media="print" onload="this.media='all'"><script src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/images/wechat.png" target="_blank"><img class="post-qr-code-img" data-lazy-src="/images/wechat.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/images/alipay.jpg" target="_blank"><img class="post-qr-code-img" data-lazy-src="/images/alipay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/Vue/2023100802/"><img class="prev-cover" data-lazy-src="/images/ys06.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">讯飞星火大模型V3.0 WebApi使用</div></div></a></div><div class="next-post pull-right"><a href="/Echarts/231020/"><img class="next-cover" data-lazy-src="/images/ys20.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Vue3 + Echarts(5.x) 实现中国地图</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/Vue/20221209160521/" title="ElementUI实现跨页多选表格"><img class="cover" data-lazy-src="/images/ys03.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-09</div><div class="title">ElementUI实现跨页多选表格</div></div></a></div><div><a href="/Vue/20230608/" title="实现网站自动监听更新"><img class="cover" data-lazy-src="/images/ys11.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-08</div><div class="title">实现网站自动监听更新</div></div></a></div><div><a href="/Vue/20230915/" title="实现瀑布流布局"><img class="cover" data-lazy-src="/images/ys10.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-09-15</div><div class="title">实现瀑布流布局</div></div></a></div><div><a href="/Vue/20230823/" title="Vue自定义好用的指令"><img class="cover" data-lazy-src="/images/ys13.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-23</div><div class="title">Vue自定义好用的指令</div></div></a></div><div><a href="/Vue/20230925/" title="封装v-resize并发布到NPM"><img class="cover" data-lazy-src="/images/ys16.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-09-25</div><div class="title">封装v-resize并发布到NPM</div></div></a></div><div><a href="/Vue/202309251756/" title="自定义插件之全局Loading"><img class="cover" data-lazy-src="/images/ys16.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-09-25</div><div class="title">自定义插件之全局Loading</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" data-lazy-src="/images/favicon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">SZX</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">150</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">25</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">36</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://gitee.com/szxio"><i class="iconfont icon-gitee-fill-round"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">welcome to my blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96Vue3%E9%A1%B9%E7%9B%AE"><span class="toc-number">1.</span> <span class="toc-text">初始化Vue3项目</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F%E4%B8%80"><span class="toc-number">1.1.</span> <span class="toc-text">方式一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F%E4%BA%8C"><span class="toc-number">1.2.</span> <span class="toc-text">方式二</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90%E8%B7%AF%E7%94%B1"><span class="toc-number">2.</span> <span class="toc-text">自动生成路由</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ref%E5%85%A8%E5%AE%B6%E6%A1%B6"><span class="toc-number">3.</span> <span class="toc-text">Ref全家桶</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ref"><span class="toc-number">3.1.</span> <span class="toc-text">ref</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#isRef"><span class="toc-number">3.2.</span> <span class="toc-text">isRef</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shallowRef"><span class="toc-number">3.3.</span> <span class="toc-text">shallowRef</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#triggerRef"><span class="toc-number">3.4.</span> <span class="toc-text">triggerRef</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#customRef"><span class="toc-number">3.5.</span> <span class="toc-text">customRef</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reactive%E5%85%A8%E5%AE%B6%E6%A1%B6"><span class="toc-number">4.</span> <span class="toc-text">Reactive全家桶</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Reactive"><span class="toc-number">4.1.</span> <span class="toc-text">Reactive</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Readonly"><span class="toc-number">4.2.</span> <span class="toc-text">Readonly</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shallowReactive"><span class="toc-number">4.3.</span> <span class="toc-text">shallowReactive</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#to%E7%B3%BB%E5%88%97%E5%85%A8%E5%AE%B6%E6%A1%B6"><span class="toc-number">5.</span> <span class="toc-text">to系列全家桶</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#toRef"><span class="toc-number">5.1.</span> <span class="toc-text">toRef</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#toRefs"><span class="toc-number">5.2.</span> <span class="toc-text">toRefs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#toRaw"><span class="toc-number">5.3.</span> <span class="toc-text">toRaw</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vue3%E5%93%8D%E5%BA%94%E5%BC%8F%E6%BA%90%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-number">6.</span> <span class="toc-text">Vue3响应式源码实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84"><span class="toc-number">6.1.</span> <span class="toc-text">初始化项目结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#reactive-ts"><span class="toc-number">6.2.</span> <span class="toc-text">reactive.ts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#effect-ts"><span class="toc-number">6.3.</span> <span class="toc-text">effect.ts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95"><span class="toc-number">6.4.</span> <span class="toc-text">测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#computed%E7%9A%84%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8"><span class="toc-number">7.</span> <span class="toc-text">computed的简单使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#computed%E6%BA%90%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-number">8.</span> <span class="toc-text">computed源码实现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#watch%E7%9B%91%E5%90%AC%E5%99%A8"><span class="toc-number">9.</span> <span class="toc-text">watch监听器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%91%E5%90%AC%E5%8D%95%E5%B1%9E%E6%80%A7%E5%80%BC"><span class="toc-number">9.1.</span> <span class="toc-text">监听单属性值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8C%E6%97%B6%E7%9B%91%E5%90%AC%E5%A4%9A%E4%B8%AA%E5%B1%9E%E6%80%A7"><span class="toc-number">9.2.</span> <span class="toc-text">同时监听多个属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%B1%E5%BA%A6%E7%9B%91%E5%90%AC"><span class="toc-number">9.3.</span> <span class="toc-text">深度监听</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%91%E5%90%AC%E5%AF%B9%E8%B1%A1%E4%B8%AD%E7%9A%84%E6%9F%90%E4%B8%80%E4%B8%AA%E5%B1%9E%E6%80%A7"><span class="toc-number">9.4.</span> <span class="toc-text">监听对象中的某一个属性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#watchEffect"><span class="toc-number">10.</span> <span class="toc-text">watchEffect</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">10.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8"><span class="toc-number">10.2.</span> <span class="toc-text">使用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BEM%E6%9E%B6%E6%9E%84%E5%92%8CLayout%E5%B8%83%E5%B1%80"><span class="toc-number">11.</span> <span class="toc-text">BEM架构和Layout布局</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%88%B6%E5%AD%90%E7%BB%84%E4%BB%B6%E4%BC%A0%E5%80%BC"><span class="toc-number">12.</span> <span class="toc-text">父子组件传值</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8"><span class="toc-number">12.1.</span> <span class="toc-text">简单使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E7%80%91%E5%B8%83%E6%B5%81%E5%B8%83%E5%B1%80"><span class="toc-number">12.2.</span> <span class="toc-text">实现瀑布流布局</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E9%80%92%E5%BD%92"><span class="toc-number">13.</span> <span class="toc-text">组件递归</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E7%BB%84%E4%BB%B6"><span class="toc-number">14.</span> <span class="toc-text">动态组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%92%E6%A7%BD"><span class="toc-number">15.</span> <span class="toc-text">插槽</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%82%E6%AD%A5%E7%BB%84%E4%BB%B6"><span class="toc-number">16.</span> <span class="toc-text">异步组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E9%AA%A8%E6%9E%B6%E5%B1%8F%E7%BB%84%E4%BB%B6"><span class="toc-number">16.1.</span> <span class="toc-text">添加骨架屏组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E6%96%B0%E9%97%BB%E7%BB%84%E4%BB%B6"><span class="toc-number">16.2.</span> <span class="toc-text">添加新闻组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%BC%82%E6%AD%A5%E7%BB%84%E4%BB%B6"><span class="toc-number">16.3.</span> <span class="toc-text">使用异步组件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TelePore%E4%BC%A0%E9%80%81%E7%BB%84%E4%BB%B6"><span class="toc-number">17.</span> <span class="toc-text">TelePore传送组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%80%E4%B8%AA%E5%BC%B9%E6%A1%86%E7%BB%84%E4%BB%B6"><span class="toc-number">17.1.</span> <span class="toc-text">自定义一个弹框组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8TelePore"><span class="toc-number">17.2.</span> <span class="toc-text">使用TelePore</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#KeepAlive"><span class="toc-number">18.</span> <span class="toc-text">KeepAlive</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%BB%98%E8%AE%A4%E4%BD%BF%E7%94%A8"><span class="toc-number">18.1.</span> <span class="toc-text">默认使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#includes"><span class="toc-number">18.2.</span> <span class="toc-text">includes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exclude"><span class="toc-number">18.3.</span> <span class="toc-text">exclude</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#max"><span class="toc-number">18.4.</span> <span class="toc-text">max</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#keep-alive%E7%9A%84%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0"><span class="toc-number">18.5.</span> <span class="toc-text">keep-alive的钩子函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#transition"><span class="toc-number">19.</span> <span class="toc-text">transition</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="toc-number">19.1.</span> <span class="toc-text">基本用法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E5%90%88animate"><span class="toc-number">19.2.</span> <span class="toc-text">结合animate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#transtion%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">19.3.</span> <span class="toc-text">transtion生命周期</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E5%90%88gsap"><span class="toc-number">19.4.</span> <span class="toc-text">结合gsap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#appear%E5%B1%9E%E6%80%A7"><span class="toc-number">19.5.</span> <span class="toc-text">appear属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#transition-group"><span class="toc-number">19.6.</span> <span class="toc-text">transition-group</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%82%AB%E9%85%B7%E7%9A%84%E5%8A%A8%E7%94%BB%E6%95%88%E6%9E%9C"><span class="toc-number">19.7.</span> <span class="toc-text">实现一个炫酷的动画效果</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8gsap%E5%AE%9E%E7%8E%B0%E6%95%B0%E5%AD%97%E6%BB%9A%E5%8A%A8"><span class="toc-number">19.8.</span> <span class="toc-text">使用gsap实现数字滚动</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5provide%E5%92%8Cinject"><span class="toc-number">20.</span> <span class="toc-text">依赖注入provide和inject</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%84%E5%BC%9F%E4%BC%A0%E5%8F%82"><span class="toc-number">21.</span> <span class="toc-text">兄弟传参</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Mitt"><span class="toc-number">21.1.</span> <span class="toc-text">Mitt</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B1%80%E9%83%A8%E4%BD%BF%E7%94%A8"><span class="toc-number">21.1.1.</span> <span class="toc-text">局部使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E4%BD%BF%E7%94%A8"><span class="toc-number">21.1.2.</span> <span class="toc-text">全局使用</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%8B%E5%86%99Bus"><span class="toc-number">21.2.</span> <span class="toc-text">手写Bus</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jsx%E6%8F%92%E4%BB%B6"><span class="toc-number">22.</span> <span class="toc-text">jsx插件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E5%BC%95%E5%85%A5%E6%8F%92%E4%BB%B6"><span class="toc-number">23.</span> <span class="toc-text">自动引入插件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#v-model%E5%9C%A8%E7%BB%84%E4%BB%B6%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">24.</span> <span class="toc-text">v-model在组件中的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">24.1.</span> <span class="toc-text">基本使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%91%E5%AE%9A%E5%A4%9A%E4%B8%AAv-model"><span class="toc-number">24.2.</span> <span class="toc-text">绑定多个v-model</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4"><span class="toc-number">25.</span> <span class="toc-text">自定义指令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4%E7%9A%84%E5%A3%B0%E6%98%8E%E5%91%A8%E6%9C%9F"><span class="toc-number">25.1.</span> <span class="toc-text">自定义指令的声明周期</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4%E7%9A%84%E7%AE%80%E5%86%99%E6%96%B9%E5%BC%8F"><span class="toc-number">25.2.</span> <span class="toc-text">自定义指令的简写方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%BC%A0%E6%A0%87%E6%8B%96%E5%8A%A8%E5%85%83%E7%B4%A0%E6%A1%88%E4%BE%8B"><span class="toc-number">25.3.</span> <span class="toc-text">鼠标拖动元素案例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E7%89%87%E6%87%92%E5%8A%A0%E8%BD%BD%E6%A1%88%E4%BE%8B"><span class="toc-number">25.4.</span> <span class="toc-text">图片懒加载案例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89Hook"><span class="toc-number">26.</span> <span class="toc-text">自定义Hook</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A5%BD%E7%94%A8%E7%9A%84%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93"><span class="toc-number">26.1.</span> <span class="toc-text">好用的第三方库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E7%89%87%E8%BD%ACbase64"><span class="toc-number">26.2.</span> <span class="toc-text">图片转base64</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89Vite%E5%BA%93%E5%B9%B6%E5%8F%91%E5%B8%83%E5%88%B0NPM"><span class="toc-number">27.</span> <span class="toc-text">自定义Vite库并发布到NPM</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%81%E8%A3%85useResize"><span class="toc-number">27.1.</span> <span class="toc-text">封装useResize</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B0%E5%BB%BA%E9%A1%B9%E7%9B%AE"><span class="toc-number">27.1.1.</span> <span class="toc-text">新建项目</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%93%E5%8C%85"><span class="toc-number">27.1.2.</span> <span class="toc-text">打包</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%99%BB%E5%BD%95npm"><span class="toc-number">27.1.3.</span> <span class="toc-text">登录npm</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%91%E5%B8%83"><span class="toc-number">27.1.4.</span> <span class="toc-text">发布</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%87%AA%E5%B7%B1%E7%9A%84%E5%BA%93"><span class="toc-number">27.2.</span> <span class="toc-text">使用自己的库</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-number">27.2.1.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F%E4%B8%80"><span class="toc-number">27.2.2.</span> <span class="toc-text">使用方式一</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F%E4%BA%8C"><span class="toc-number">27.2.3.</span> <span class="toc-text">使用方式二</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E5%92%8C%E6%96%B9%E6%B3%95"><span class="toc-number">28.</span> <span class="toc-text">定义全局变量和方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8F%92%E4%BB%B6%E4%B9%8B%E5%85%A8%E5%B1%80Loading"><span class="toc-number">29.</span> <span class="toc-text">自定义插件之全局Loading</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ElementPlus%E7%9A%84%E9%BB%98%E8%AE%A4%E5%85%A8%E5%B1%80Loading"><span class="toc-number">29.1.</span> <span class="toc-text">ElementPlus的默认全局Loading</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%87%E4%BB%A4%E7%9A%84%E6%96%B9%E5%BC%8F%E4%BD%BF%E7%94%A8"><span class="toc-number">29.1.1.</span> <span class="toc-text">指令的方式使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E5%BC%8F%E8%B0%83%E7%94%A8"><span class="toc-number">29.1.2.</span> <span class="toc-text">函数式调用</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%85%A8%E5%B1%80Loading"><span class="toc-number">29.2.</span> <span class="toc-text">自定义全局Loading</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0MyLoading-vue"><span class="toc-number">29.2.1.</span> <span class="toc-text">添加MyLoading.vue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0MyLoading-ts"><span class="toc-number">29.2.2.</span> <span class="toc-text">添加MyLoading.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8main-ts%E4%B8%AD%E6%8C%82%E8%BD%BD"><span class="toc-number">29.2.3.</span> <span class="toc-text">在main.ts中挂载</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%E4%B8%80%EF%BC%9A%E5%87%BD%E6%95%B0%E5%BC%8F%E4%BD%BF%E7%94%A8"><span class="toc-number">29.2.4.</span> <span class="toc-text">使用方法一：函数式使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%E4%BA%8C%EF%BC%9A%E6%8C%87%E4%BB%A4%E5%BC%8F%E4%BD%BF%E7%94%A8"><span class="toc-number">29.2.5.</span> <span class="toc-text">使用方法二：指令式使用</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#use%E5%87%BD%E6%95%B0%E6%BA%90%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-number">29.3.</span> <span class="toc-text">use函数源码实现</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CSS%E9%80%89%E6%8B%A9%E5%99%A8"><span class="toc-number">30.</span> <span class="toc-text">CSS选择器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#deep"><span class="toc-number">30.1.</span> <span class="toc-text">:deep</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#slotted"><span class="toc-number">30.2.</span> <span class="toc-text">:slotted</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#global"><span class="toc-number">30.3.</span> <span class="toc-text">:global</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#css%E4%B8%AD%E4%BD%BF%E7%94%A8v-bind"><span class="toc-number">30.4.</span> <span class="toc-text">css中使用v-bind</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vue3%E9%9B%86%E6%88%90Tailwind-CSS"><span class="toc-number">31.</span> <span class="toc-text">Vue3集成Tailwind CSS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-1"><span class="toc-number">31.1.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8"><span class="toc-number">31.2.</span> <span class="toc-text">基础使用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nextTick"><span class="toc-number">32.</span> <span class="toc-text">nextTick</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vue3%E5%BC%80%E5%8F%91%E5%AE%89%E5%8D%93%E5%92%8CIOS"><span class="toc-number">33.</span> <span class="toc-text">Vue3开发安卓和IOS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7"><span class="toc-number">33.1.</span> <span class="toc-text">安装安卓开发工具</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ionic%E5%AE%89%E8%A3%85"><span class="toc-number">33.2.</span> <span class="toc-text">ionic安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E9%A1%B9%E7%9B%AE"><span class="toc-number">33.3.</span> <span class="toc-text">初始化项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%93%E5%8C%85%E5%92%8C%E6%9E%84%E5%BB%BA"><span class="toc-number">33.4.</span> <span class="toc-text">打包和构建</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#H5%E9%80%82%E9%85%8D"><span class="toc-number">34.</span> <span class="toc-text">H5适配</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0meat%E4%BF%A1%E6%81%AF"><span class="toc-number">34.1.</span> <span class="toc-text">添加meat信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%85%E9%99%A4%E9%BB%98%E8%AE%A4%E6%A0%B7%E5%BC%8F"><span class="toc-number">34.2.</span> <span class="toc-text">清除默认样式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A3%E6%9D%AF%E5%B8%83%E5%B1%80"><span class="toc-number">34.3.</span> <span class="toc-text">圣杯布局</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E5%86%99postCSS%E6%8F%92%E4%BB%B6"><span class="toc-number">34.4.</span> <span class="toc-text">编写postCSS插件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%8F%92%E4%BB%B6"><span class="toc-number">34.5.</span> <span class="toc-text">使用插件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%88%E6%9E%9C%E5%B1%95%E7%A4%BA"><span class="toc-number">34.6.</span> <span class="toc-text">效果展示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E6%8E%A7%E5%88%B6%E5%AD%97%E4%BD%93%E5%A4%A7%E5%B0%8F"><span class="toc-number">34.7.</span> <span class="toc-text">全局控制字体大小</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#unoCss%E5%8E%9F%E5%AD%90%E5%8C%96"><span class="toc-number">35.</span> <span class="toc-text">unoCss原子化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFcss%E5%8E%9F%E5%AD%90%E5%8C%96%EF%BC%9F"><span class="toc-number">35.1.</span> <span class="toc-text">什么是css原子化？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-2"><span class="toc-number">35.2.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-1"><span class="toc-number">35.3.</span> <span class="toc-text">使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E9%85%8D%E7%BD%AE%E7%B1%BB%E5%90%8D"><span class="toc-number">35.4.</span> <span class="toc-text">动态配置类名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E9%A2%84%E8%AE%BE"><span class="toc-number">35.5.</span> <span class="toc-text">使用预设</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9B%BE%E6%A0%87"><span class="toc-number">35.6.</span> <span class="toc-text">使用图标</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vue%E7%BC%96%E8%AF%91%E5%AE%8F"><span class="toc-number">36.</span> <span class="toc-text">Vue编译宏</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vue%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="toc-number">37.</span> <span class="toc-text">Vue环境变量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Webpack%E4%BB%8E0%E5%88%B01%E6%9E%84%E5%BB%BAVue3%E5%B7%A5%E7%A8%8B"><span class="toc-number">38.</span> <span class="toc-text">Webpack从0到1构建Vue3工程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vite%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96"><span class="toc-number">39.</span> <span class="toc-text">Vite性能优化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%93%E5%8C%85%E4%BC%98%E5%8C%96"><span class="toc-number">39.1.</span> <span class="toc-text">打包优化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pinia"><span class="toc-number">40.</span> <span class="toc-text">Pinia</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-3"><span class="toc-number">40.1.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8-1"><span class="toc-number">40.2.</span> <span class="toc-text">基本使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pinia%E7%9A%84%E4%B8%80%E4%BA%9BAPI"><span class="toc-number">40.3.</span> <span class="toc-text">Pinia的一些API</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pinia%E6%8C%81%E4%B9%85%E5%8C%96%E7%BC%93%E5%AD%98"><span class="toc-number">40.4.</span> <span class="toc-text">Pinia持久化缓存</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Echarts%E5%B1%95%E7%A4%BA%E5%9C%B0%E5%9B%BE"><span class="toc-number">41.</span> <span class="toc-text">Echarts展示地图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%88%E6%9E%9C%E5%9B%BE"><span class="toc-number">41.1.</span> <span class="toc-text">效果图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-4"><span class="toc-number">41.2.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%90%E7%A0%81"><span class="toc-number">41.3.</span> <span class="toc-text">源码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vue-Router"><span class="toc-number">42.</span> <span class="toc-text">Vue-Router</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-5"><span class="toc-number">42.1.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E8%B7%AF%E7%94%B1%E5%92%8C404"><span class="toc-number">42.2.</span> <span class="toc-text">定义路由和404</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E8%B7%B3%E8%BD%AC"><span class="toc-number">42.3.</span> <span class="toc-text">路由跳转</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E8%B7%AF%E7%94%B1%E8%BF%94%E5%9B%9E%E4%B8%8E%E5%89%8D%E8%BF%9B"><span class="toc-number">42.4.</span> <span class="toc-text">控制路由返回与前进</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#replace"><span class="toc-number">42.5.</span> <span class="toc-text">replace</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E4%BC%A0%E5%8F%82"><span class="toc-number">42.6.</span> <span class="toc-text">路由传参</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E6%80%81URL"><span class="toc-number">42.7.</span> <span class="toc-text">动态URL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E5%B5%8C%E5%A5%97"><span class="toc-number">42.8.</span> <span class="toc-text">路由嵌套</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E5%AE%9A%E5%90%91"><span class="toc-number">42.9.</span> <span class="toc-text">重定向</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E5%AE%88%E5%8D%AB"><span class="toc-number">42.10.</span> <span class="toc-text">路由守卫</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BB%9A%E5%8A%A8%E8%A1%8C%E4%B8%BA"><span class="toc-number">42.11.</span> <span class="toc-text">滚动行为</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1"><span class="toc-number">42.12.</span> <span class="toc-text">动态路由</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MarkDown%E8%AF%AD%E6%B3%95%E9%AB%98%E4%BA%AE"><span class="toc-number">43.</span> <span class="toc-text">MarkDown语法高亮</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-6"><span class="toc-number">43.1.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E5%86%8C"><span class="toc-number">43.2.</span> <span class="toc-text">注册</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-2"><span class="toc-number">43.3.</span> <span class="toc-text">使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%88%E6%9E%9C"><span class="toc-number">43.4.</span> <span class="toc-text">效果</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/Vue/%E4%B8%80%E4%B8%AA%E4%BC%98%E9%9B%85%E7%9A%84%E8%BD%AE%E5%BE%AA%E4%BB%A3%E7%A0%81/" title="一个优雅的轮循代码"><img data-lazy-src="/images/ys07.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="一个优雅的轮循代码"/></a><div class="content"><a class="title" href="/Vue/%E4%B8%80%E4%B8%AA%E4%BC%98%E9%9B%85%E7%9A%84%E8%BD%AE%E5%BE%AA%E4%BB%A3%E7%A0%81/" title="一个优雅的轮循代码">一个优雅的轮循代码</a><time datetime="2024-09-22T16:00:00.000Z" title="发表于 2024-09-23 00:00:00">2024-09-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/JavaScript/pm2_linux_nginx/" title="pm2 + linux + nginx"><img data-lazy-src="/images/ys19.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="pm2 + linux + nginx"/></a><div class="content"><a class="title" href="/JavaScript/pm2_linux_nginx/" title="pm2 + linux + nginx">pm2 + linux + nginx</a><time datetime="2024-09-07T16:00:00.000Z" title="发表于 2024-09-08 00:00:00">2024-09-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/JavaScript/scss%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E9%80%9A%E7%94%A8%E5%AA%92%E4%BD%93%E6%9F%A5%E8%AF%A2/" title="巧用scss实现一个通用的媒介查询代码"><img data-lazy-src="/images/ys11.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="巧用scss实现一个通用的媒介查询代码"/></a><div class="content"><a class="title" href="/JavaScript/scss%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E9%80%9A%E7%94%A8%E5%AA%92%E4%BD%93%E6%9F%A5%E8%AF%A2/" title="巧用scss实现一个通用的媒介查询代码">巧用scss实现一个通用的媒介查询代码</a><time datetime="2024-08-30T16:00:00.000Z" title="发表于 2024-08-31 00:00:00">2024-08-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/JavaScript/Axios%E5%8F%96%E6%B6%88%E8%AF%B7%E6%B1%82/" title="Axios取消请求，以及全局取消请求封装"><img data-lazy-src="/images/ys16.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Axios取消请求，以及全局取消请求封装"/></a><div class="content"><a class="title" href="/JavaScript/Axios%E5%8F%96%E6%B6%88%E8%AF%B7%E6%B1%82/" title="Axios取消请求，以及全局取消请求封装">Axios取消请求，以及全局取消请求封装</a><time datetime="2024-08-11T16:00:00.000Z" title="发表于 2024-08-12 00:00:00">2024-08-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Java/springboot/usercenter/" title="React + SpringBoot 开发用户中心管理系统"><img data-lazy-src="/images/ys16.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="React + SpringBoot 开发用户中心管理系统"/></a><div class="content"><a class="title" href="/Java/springboot/usercenter/" title="React + SpringBoot 开发用户中心管理系统">React + SpringBoot 开发用户中心管理系统</a><time datetime="2024-06-02T02:19:37.000Z" title="发表于 2024-06-02 10:19:37">2024-06-02</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/images/ys07.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By SZX</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">少年辛苦终身事，莫向光阴惰寸功。<a target="_blank" rel="noopener" href="https://gitee.com/szxio">My Gitee</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/js/instantpage.min.js" type="module"></script><script src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/js/lazyload.iife.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/js/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'iJzt0X9OdhFCcdn4N0dJ86fY-gzGzoHsz',
      appKey: '8vtaRafgQSvU5ntYgszJfRW5',
      placeholder: '留下你的精彩评论',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
      requiredFields: ["nick,mail"],
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/js/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/js/canvas-fluttering-ribbon.min.js"></script><script src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/js/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://szx-bucket1.oss-cn-hangzhou.aliyuncs.com/js/click-show-text.min.js" data-mobile="true" data-text="富强,民主,文明,和谐,自由,平等,公正,法制,爱国,敬业,诚信,友善" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>